import{c as gr,g as Nv,a as de,e as yr,b as Fv,w as vl,r as _l,f as ic,t as ta,d as Dv,I as yi,A as jv,U as $v,N as se,h as Lv,i as Go,j as Mv,_ as zv,P as qv,V as vh,k as Uv,D as Hv,C as kv,Z as _h,$ as Kv,l as Vv,m as Qs,q as Bv,n as ml,o as jr,y as Gv,p as Wv,X as sn,s as jt,u as tr,v as gi,x as cr,z as Jv,B as an,E as wl,F as Yv,G as Zv,H as Xv,J as bl,K as Qv,L as El,Y as Il,M as cn,O as Wo,Q as Ys,R as un,S as e1,T as Zs,W as t1,a0 as r1,a1 as i1,a2 as n1,a3 as s1,a4 as To,a5 as mh,a6 as a1,a7 as o1,a8 as c1,a9 as wh,aa as u1,ab as h1,ac as l1,ad as f1,ae as p1,af as d1,ag as g1,ah as Xs,ai as y1,aj as Ro,ak as v1,al as _1}from"./index.846ecf1a.js";import{s as nc,i as bh,c as m1,a as w1,b as xl,f as sc,p as b1,J as _i,d as ac,e as oc,g as cc,h as di,j as ri,k as uc,l as Sl,H as $i}from"./http.ee75e605.js";var ra={},hc={exports:{}};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */(function(h){var i,r,s,a,f,w,E,x,N,U,X,Q,ee,V,Z,oe,ge,ye,fe,he,le,L,K;(function(F){var ue=typeof gr=="object"?gr:typeof self=="object"?self:typeof this=="object"?this:{};F(l(ue,l(h.exports)));function l(v,_){return v!==ue&&(typeof Object.create=="function"?Object.defineProperty(v,"__esModule",{value:!0}):v.__esModule=!0),function(S,y){return v[S]=_?_(S,y):y}}})(function(F){var ue=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(l,v){l.__proto__=v}||function(l,v){for(var _ in v)v.hasOwnProperty(_)&&(l[_]=v[_])};i=function(l,v){ue(l,v);function _(){this.constructor=l}l.prototype=v===null?Object.create(v):(_.prototype=v.prototype,new _)},r=Object.assign||function(l){for(var v,_=1,S=arguments.length;_<S;_++){v=arguments[_];for(var y in v)Object.prototype.hasOwnProperty.call(v,y)&&(l[y]=v[y])}return l},s=function(l,v){var _={};for(var S in l)Object.prototype.hasOwnProperty.call(l,S)&&v.indexOf(S)<0&&(_[S]=l[S]);if(l!=null&&typeof Object.getOwnPropertySymbols=="function")for(var y=0,S=Object.getOwnPropertySymbols(l);y<S.length;y++)v.indexOf(S[y])<0&&Object.prototype.propertyIsEnumerable.call(l,S[y])&&(_[S[y]]=l[S[y]]);return _},a=function(l,v,_,S){var y=arguments.length,g=y<3?v:S===null?S=Object.getOwnPropertyDescriptor(v,_):S,j;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")g=Reflect.decorate(l,v,_,S);else for(var W=l.length-1;W>=0;W--)(j=l[W])&&(g=(y<3?j(g):y>3?j(v,_,g):j(v,_))||g);return y>3&&g&&Object.defineProperty(v,_,g),g},f=function(l,v){return function(_,S){v(_,S,l)}},w=function(l,v){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(l,v)},E=function(l,v,_,S){function y(g){return g instanceof _?g:new _(function(j){j(g)})}return new(_||(_=Promise))(function(g,j){function W($){try{O(S.next($))}catch(Y){j(Y)}}function J($){try{O(S.throw($))}catch(Y){j(Y)}}function O($){$.done?g($.value):y($.value).then(W,J)}O((S=S.apply(l,v||[])).next())})},x=function(l,v){var _={label:0,sent:function(){if(g[0]&1)throw g[1];return g[1]},trys:[],ops:[]},S,y,g,j;return j={next:W(0),throw:W(1),return:W(2)},typeof Symbol=="function"&&(j[Symbol.iterator]=function(){return this}),j;function W(O){return function($){return J([O,$])}}function J(O){if(S)throw new TypeError("Generator is already executing.");for(;_;)try{if(S=1,y&&(g=O[0]&2?y.return:O[0]?y.throw||((g=y.return)&&g.call(y),0):y.next)&&!(g=g.call(y,O[1])).done)return g;switch(y=0,g&&(O=[O[0]&2,g.value]),O[0]){case 0:case 1:g=O;break;case 4:return _.label++,{value:O[1],done:!1};case 5:_.label++,y=O[1],O=[0];continue;case 7:O=_.ops.pop(),_.trys.pop();continue;default:if(g=_.trys,!(g=g.length>0&&g[g.length-1])&&(O[0]===6||O[0]===2)){_=0;continue}if(O[0]===3&&(!g||O[1]>g[0]&&O[1]<g[3])){_.label=O[1];break}if(O[0]===6&&_.label<g[1]){_.label=g[1],g=O;break}if(g&&_.label<g[2]){_.label=g[2],_.ops.push(O);break}g[2]&&_.ops.pop(),_.trys.pop();continue}O=v.call(l,_)}catch($){O=[6,$],y=0}finally{S=g=0}if(O[0]&5)throw O[1];return{value:O[0]?O[1]:void 0,done:!0}}},K=function(l,v,_,S){S===void 0&&(S=_),l[S]=v[_]},N=function(l,v){for(var _ in l)_!=="default"&&!v.hasOwnProperty(_)&&(v[_]=l[_])},U=function(l){var v=typeof Symbol=="function"&&Symbol.iterator,_=v&&l[v],S=0;if(_)return _.call(l);if(l&&typeof l.length=="number")return{next:function(){return l&&S>=l.length&&(l=void 0),{value:l&&l[S++],done:!l}}};throw new TypeError(v?"Object is not iterable.":"Symbol.iterator is not defined.")},X=function(l,v){var _=typeof Symbol=="function"&&l[Symbol.iterator];if(!_)return l;var S=_.call(l),y,g=[],j;try{for(;(v===void 0||v-- >0)&&!(y=S.next()).done;)g.push(y.value)}catch(W){j={error:W}}finally{try{y&&!y.done&&(_=S.return)&&_.call(S)}finally{if(j)throw j.error}}return g},Q=function(){for(var l=[],v=0;v<arguments.length;v++)l=l.concat(X(arguments[v]));return l},ee=function(){for(var l=0,v=0,_=arguments.length;v<_;v++)l+=arguments[v].length;for(var S=Array(l),y=0,v=0;v<_;v++)for(var g=arguments[v],j=0,W=g.length;j<W;j++,y++)S[y]=g[j];return S},V=function(l){return this instanceof V?(this.v=l,this):new V(l)},Z=function(l,v,_){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var S=_.apply(l,v||[]),y,g=[];return y={},j("next"),j("throw"),j("return"),y[Symbol.asyncIterator]=function(){return this},y;function j(re){S[re]&&(y[re]=function(me){return new Promise(function(ut,be){g.push([re,me,ut,be])>1||W(re,me)})})}function W(re,me){try{J(S[re](me))}catch(ut){Y(g[0][3],ut)}}function J(re){re.value instanceof V?Promise.resolve(re.value.v).then(O,$):Y(g[0][2],re)}function O(re){W("next",re)}function $(re){W("throw",re)}function Y(re,me){re(me),g.shift(),g.length&&W(g[0][0],g[0][1])}},oe=function(l){var v,_;return v={},S("next"),S("throw",function(y){throw y}),S("return"),v[Symbol.iterator]=function(){return this},v;function S(y,g){v[y]=l[y]?function(j){return(_=!_)?{value:V(l[y](j)),done:y==="return"}:g?g(j):j}:g}},ge=function(l){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var v=l[Symbol.asyncIterator],_;return v?v.call(l):(l=typeof U=="function"?U(l):l[Symbol.iterator](),_={},S("next"),S("throw"),S("return"),_[Symbol.asyncIterator]=function(){return this},_);function S(g){_[g]=l[g]&&function(j){return new Promise(function(W,J){j=l[g](j),y(W,J,j.done,j.value)})}}function y(g,j,W,J){Promise.resolve(J).then(function(O){g({value:O,done:W})},j)}},ye=function(l,v){return Object.defineProperty?Object.defineProperty(l,"raw",{value:v}):l.raw=v,l},fe=function(l){if(l&&l.__esModule)return l;var v={};if(l!=null)for(var _ in l)Object.hasOwnProperty.call(l,_)&&(v[_]=l[_]);return v.default=l,v},he=function(l){return l&&l.__esModule?l:{default:l}},le=function(l,v){if(!v.has(l))throw new TypeError("attempted to get private field on non-instance");return v.get(l)},L=function(l,v,_){if(!v.has(l))throw new TypeError("attempted to set private field on non-instance");return v.set(l,_),_},F("__extends",i),F("__assign",r),F("__rest",s),F("__decorate",a),F("__param",f),F("__metadata",w),F("__awaiter",E),F("__generator",x),F("__exportStar",N),F("__createBinding",K),F("__values",U),F("__read",X),F("__spread",Q),F("__spreadArrays",ee),F("__await",V),F("__asyncGenerator",Z),F("__asyncDelegator",oe),F("__asyncValues",ge),F("__makeTemplateObject",ye),F("__importStar",fe),F("__importDefault",he),F("__classPrivateFieldGet",le),F("__classPrivateFieldSet",L)})})(hc);var qn={};Object.defineProperty(qn,"__esModule",{value:!0});function E1(h){if(typeof h!="string")throw new Error(`Cannot safe json parse value of type ${typeof h}`);try{return JSON.parse(h)}catch{return h}}qn.safeJsonParse=E1;function I1(h){return typeof h=="string"?h:JSON.stringify(h,(i,r)=>typeof r>"u"?null:r)}qn.safeJsonStringify=I1;var Tn={exports:{}},Eh;function x1(){return Eh||(Eh=1,function(){let h;function i(){}h=i,h.prototype.getItem=function(r){return this.hasOwnProperty(r)?String(this[r]):null},h.prototype.setItem=function(r,s){this[r]=String(s)},h.prototype.removeItem=function(r){delete this[r]},h.prototype.clear=function(){const r=this;Object.keys(r).forEach(function(s){r[s]=void 0,delete r[s]})},h.prototype.key=function(r){return r=r||0,Object.keys(this)[r]},h.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof gr<"u"&&gr.localStorage?Tn.exports=gr.localStorage:typeof window<"u"&&window.localStorage?Tn.exports=window.localStorage:Tn.exports=new i}()),Tn.exports}var No={},Rn={},Ih;function S1(){if(Ih)return Rn;Ih=1,Object.defineProperty(Rn,"__esModule",{value:!0}),Rn.IKeyValueStorage=void 0;class h{}return Rn.IKeyValueStorage=h,Rn}var Nn={},xh;function P1(){if(xh)return Nn;xh=1,Object.defineProperty(Nn,"__esModule",{value:!0}),Nn.parseEntry=void 0;const h=qn;function i(r){var s;return[r[0],h.safeJsonParse((s=r[1])!==null&&s!==void 0?s:"")]}return Nn.parseEntry=i,Nn}var Sh;function O1(){return Sh||(Sh=1,function(h){Object.defineProperty(h,"__esModule",{value:!0});const i=hc.exports;i.__exportStar(S1(),h),i.__exportStar(P1(),h)}(No)),No}Object.defineProperty(ra,"__esModule",{value:!0});ra.KeyValueStorage=void 0;const on=hc.exports,Ph=qn,C1=on.__importDefault(x1()),A1=O1();class Pl{constructor(){this.localStorage=C1.default}getKeys(){return on.__awaiter(this,void 0,void 0,function*(){return Object.keys(this.localStorage)})}getEntries(){return on.__awaiter(this,void 0,void 0,function*(){return Object.entries(this.localStorage).map(A1.parseEntry)})}getItem(i){return on.__awaiter(this,void 0,void 0,function*(){const r=this.localStorage.getItem(i);if(r!==null)return Ph.safeJsonParse(r)})}setItem(i,r){return on.__awaiter(this,void 0,void 0,function*(){this.localStorage.setItem(i,Ph.safeJsonStringify(r))})}removeItem(i){return on.__awaiter(this,void 0,void 0,function*(){this.localStorage.removeItem(i)})}}ra.KeyValueStorage=Pl;var T1=ra.default=Pl,hn={},Un={exports:{}};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */(function(h){var i,r,s,a,f,w,E,x,N,U,X,Q,ee,V,Z,oe,ge,ye,fe,he,le,L,K;(function(F){var ue=typeof gr=="object"?gr:typeof self=="object"?self:typeof this=="object"?this:{};F(l(ue,l(h.exports)));function l(v,_){return v!==ue&&(typeof Object.create=="function"?Object.defineProperty(v,"__esModule",{value:!0}):v.__esModule=!0),function(S,y){return v[S]=_?_(S,y):y}}})(function(F){var ue=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(l,v){l.__proto__=v}||function(l,v){for(var _ in v)v.hasOwnProperty(_)&&(l[_]=v[_])};i=function(l,v){ue(l,v);function _(){this.constructor=l}l.prototype=v===null?Object.create(v):(_.prototype=v.prototype,new _)},r=Object.assign||function(l){for(var v,_=1,S=arguments.length;_<S;_++){v=arguments[_];for(var y in v)Object.prototype.hasOwnProperty.call(v,y)&&(l[y]=v[y])}return l},s=function(l,v){var _={};for(var S in l)Object.prototype.hasOwnProperty.call(l,S)&&v.indexOf(S)<0&&(_[S]=l[S]);if(l!=null&&typeof Object.getOwnPropertySymbols=="function")for(var y=0,S=Object.getOwnPropertySymbols(l);y<S.length;y++)v.indexOf(S[y])<0&&Object.prototype.propertyIsEnumerable.call(l,S[y])&&(_[S[y]]=l[S[y]]);return _},a=function(l,v,_,S){var y=arguments.length,g=y<3?v:S===null?S=Object.getOwnPropertyDescriptor(v,_):S,j;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")g=Reflect.decorate(l,v,_,S);else for(var W=l.length-1;W>=0;W--)(j=l[W])&&(g=(y<3?j(g):y>3?j(v,_,g):j(v,_))||g);return y>3&&g&&Object.defineProperty(v,_,g),g},f=function(l,v){return function(_,S){v(_,S,l)}},w=function(l,v){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(l,v)},E=function(l,v,_,S){function y(g){return g instanceof _?g:new _(function(j){j(g)})}return new(_||(_=Promise))(function(g,j){function W($){try{O(S.next($))}catch(Y){j(Y)}}function J($){try{O(S.throw($))}catch(Y){j(Y)}}function O($){$.done?g($.value):y($.value).then(W,J)}O((S=S.apply(l,v||[])).next())})},x=function(l,v){var _={label:0,sent:function(){if(g[0]&1)throw g[1];return g[1]},trys:[],ops:[]},S,y,g,j;return j={next:W(0),throw:W(1),return:W(2)},typeof Symbol=="function"&&(j[Symbol.iterator]=function(){return this}),j;function W(O){return function($){return J([O,$])}}function J(O){if(S)throw new TypeError("Generator is already executing.");for(;_;)try{if(S=1,y&&(g=O[0]&2?y.return:O[0]?y.throw||((g=y.return)&&g.call(y),0):y.next)&&!(g=g.call(y,O[1])).done)return g;switch(y=0,g&&(O=[O[0]&2,g.value]),O[0]){case 0:case 1:g=O;break;case 4:return _.label++,{value:O[1],done:!1};case 5:_.label++,y=O[1],O=[0];continue;case 7:O=_.ops.pop(),_.trys.pop();continue;default:if(g=_.trys,!(g=g.length>0&&g[g.length-1])&&(O[0]===6||O[0]===2)){_=0;continue}if(O[0]===3&&(!g||O[1]>g[0]&&O[1]<g[3])){_.label=O[1];break}if(O[0]===6&&_.label<g[1]){_.label=g[1],g=O;break}if(g&&_.label<g[2]){_.label=g[2],_.ops.push(O);break}g[2]&&_.ops.pop(),_.trys.pop();continue}O=v.call(l,_)}catch($){O=[6,$],y=0}finally{S=g=0}if(O[0]&5)throw O[1];return{value:O[0]?O[1]:void 0,done:!0}}},K=function(l,v,_,S){S===void 0&&(S=_),l[S]=v[_]},N=function(l,v){for(var _ in l)_!=="default"&&!v.hasOwnProperty(_)&&(v[_]=l[_])},U=function(l){var v=typeof Symbol=="function"&&Symbol.iterator,_=v&&l[v],S=0;if(_)return _.call(l);if(l&&typeof l.length=="number")return{next:function(){return l&&S>=l.length&&(l=void 0),{value:l&&l[S++],done:!l}}};throw new TypeError(v?"Object is not iterable.":"Symbol.iterator is not defined.")},X=function(l,v){var _=typeof Symbol=="function"&&l[Symbol.iterator];if(!_)return l;var S=_.call(l),y,g=[],j;try{for(;(v===void 0||v-- >0)&&!(y=S.next()).done;)g.push(y.value)}catch(W){j={error:W}}finally{try{y&&!y.done&&(_=S.return)&&_.call(S)}finally{if(j)throw j.error}}return g},Q=function(){for(var l=[],v=0;v<arguments.length;v++)l=l.concat(X(arguments[v]));return l},ee=function(){for(var l=0,v=0,_=arguments.length;v<_;v++)l+=arguments[v].length;for(var S=Array(l),y=0,v=0;v<_;v++)for(var g=arguments[v],j=0,W=g.length;j<W;j++,y++)S[y]=g[j];return S},V=function(l){return this instanceof V?(this.v=l,this):new V(l)},Z=function(l,v,_){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var S=_.apply(l,v||[]),y,g=[];return y={},j("next"),j("throw"),j("return"),y[Symbol.asyncIterator]=function(){return this},y;function j(re){S[re]&&(y[re]=function(me){return new Promise(function(ut,be){g.push([re,me,ut,be])>1||W(re,me)})})}function W(re,me){try{J(S[re](me))}catch(ut){Y(g[0][3],ut)}}function J(re){re.value instanceof V?Promise.resolve(re.value.v).then(O,$):Y(g[0][2],re)}function O(re){W("next",re)}function $(re){W("throw",re)}function Y(re,me){re(me),g.shift(),g.length&&W(g[0][0],g[0][1])}},oe=function(l){var v,_;return v={},S("next"),S("throw",function(y){throw y}),S("return"),v[Symbol.iterator]=function(){return this},v;function S(y,g){v[y]=l[y]?function(j){return(_=!_)?{value:V(l[y](j)),done:y==="return"}:g?g(j):j}:g}},ge=function(l){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var v=l[Symbol.asyncIterator],_;return v?v.call(l):(l=typeof U=="function"?U(l):l[Symbol.iterator](),_={},S("next"),S("throw"),S("return"),_[Symbol.asyncIterator]=function(){return this},_);function S(g){_[g]=l[g]&&function(j){return new Promise(function(W,J){j=l[g](j),y(W,J,j.done,j.value)})}}function y(g,j,W,J){Promise.resolve(J).then(function(O){g({value:O,done:W})},j)}},ye=function(l,v){return Object.defineProperty?Object.defineProperty(l,"raw",{value:v}):l.raw=v,l},fe=function(l){if(l&&l.__esModule)return l;var v={};if(l!=null)for(var _ in l)Object.hasOwnProperty.call(l,_)&&(v[_]=l[_]);return v.default=l,v},he=function(l){return l&&l.__esModule?l:{default:l}},le=function(l,v){if(!v.has(l))throw new TypeError("attempted to get private field on non-instance");return v.get(l)},L=function(l,v,_){if(!v.has(l))throw new TypeError("attempted to set private field on non-instance");return v.set(l,_),_},F("__extends",i),F("__assign",r),F("__rest",s),F("__decorate",a),F("__param",f),F("__metadata",w),F("__awaiter",E),F("__generator",x),F("__exportStar",N),F("__createBinding",K),F("__values",U),F("__read",X),F("__spread",Q),F("__spreadArrays",ee),F("__await",V),F("__asyncGenerator",Z),F("__asyncDelegator",oe),F("__asyncValues",ge),F("__makeTemplateObject",ye),F("__importStar",fe),F("__importDefault",he),F("__classPrivateFieldGet",le),F("__classPrivateFieldSet",L)})})(Un);var Fn={},Fo={},Dn={};class Li{}const R1=Object.freeze(Object.defineProperty({__proto__:null,IEvents:Li},Symbol.toStringTag,{value:"Module"})),N1=Nv(R1);var Oh;function F1(){if(Oh)return Dn;Oh=1,Object.defineProperty(Dn,"__esModule",{value:!0}),Dn.IHeartBeat=void 0;const h=N1;class i extends h.IEvents{constructor(s){super()}}return Dn.IHeartBeat=i,Dn}var Ch;function Ol(){return Ch||(Ch=1,function(h){Object.defineProperty(h,"__esModule",{value:!0}),Un.exports.__exportStar(F1(),h)}(Fo)),Fo}var Do={},Di={},Ah;function D1(){if(Ah)return Di;Ah=1,Object.defineProperty(Di,"__esModule",{value:!0}),Di.HEARTBEAT_EVENTS=Di.HEARTBEAT_INTERVAL=void 0;const h=de;return Di.HEARTBEAT_INTERVAL=h.FIVE_SECONDS,Di.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},Di}var Th;function Cl(){return Th||(Th=1,function(h){Object.defineProperty(h,"__esModule",{value:!0}),Un.exports.__exportStar(D1(),h)}(Do)),Do}var Rh;function j1(){if(Rh)return Fn;Rh=1,Object.defineProperty(Fn,"__esModule",{value:!0}),Fn.HeartBeat=void 0;const h=Un.exports,i=yr.exports,r=de,s=Ol(),a=Cl();class f extends s.IHeartBeat{constructor(E){super(E),this.events=new i.EventEmitter,this.interval=a.HEARTBEAT_INTERVAL,this.interval=E?.interval||a.HEARTBEAT_INTERVAL}static init(E){return h.__awaiter(this,void 0,void 0,function*(){const x=new f(E);return yield x.init(),x})}init(){return h.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(E,x){this.events.on(E,x)}once(E,x){this.events.once(E,x)}off(E,x){this.events.off(E,x)}removeListener(E,x){this.events.removeListener(E,x)}initialize(){return h.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),r.toMiliseconds(this.interval))})}pulse(){this.events.emit(a.HEARTBEAT_EVENTS.pulse)}}return Fn.HeartBeat=f,Fn}(function(h){Object.defineProperty(h,"__esModule",{value:!0});const i=Un.exports;i.__exportStar(j1(),h),i.__exportStar(Ol(),h),i.__exportStar(Cl(),h)})(hn);var De={},Al={exports:{}};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */(function(h){var i,r,s,a,f,w,E,x,N,U,X,Q,ee,V,Z,oe,ge,ye,fe,he,le,L,K;(function(F){var ue=typeof gr=="object"?gr:typeof self=="object"?self:typeof this=="object"?this:{};F(l(ue,l(h.exports)));function l(v,_){return v!==ue&&(typeof Object.create=="function"?Object.defineProperty(v,"__esModule",{value:!0}):v.__esModule=!0),function(S,y){return v[S]=_?_(S,y):y}}})(function(F){var ue=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(l,v){l.__proto__=v}||function(l,v){for(var _ in v)v.hasOwnProperty(_)&&(l[_]=v[_])};i=function(l,v){ue(l,v);function _(){this.constructor=l}l.prototype=v===null?Object.create(v):(_.prototype=v.prototype,new _)},r=Object.assign||function(l){for(var v,_=1,S=arguments.length;_<S;_++){v=arguments[_];for(var y in v)Object.prototype.hasOwnProperty.call(v,y)&&(l[y]=v[y])}return l},s=function(l,v){var _={};for(var S in l)Object.prototype.hasOwnProperty.call(l,S)&&v.indexOf(S)<0&&(_[S]=l[S]);if(l!=null&&typeof Object.getOwnPropertySymbols=="function")for(var y=0,S=Object.getOwnPropertySymbols(l);y<S.length;y++)v.indexOf(S[y])<0&&Object.prototype.propertyIsEnumerable.call(l,S[y])&&(_[S[y]]=l[S[y]]);return _},a=function(l,v,_,S){var y=arguments.length,g=y<3?v:S===null?S=Object.getOwnPropertyDescriptor(v,_):S,j;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")g=Reflect.decorate(l,v,_,S);else for(var W=l.length-1;W>=0;W--)(j=l[W])&&(g=(y<3?j(g):y>3?j(v,_,g):j(v,_))||g);return y>3&&g&&Object.defineProperty(v,_,g),g},f=function(l,v){return function(_,S){v(_,S,l)}},w=function(l,v){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(l,v)},E=function(l,v,_,S){function y(g){return g instanceof _?g:new _(function(j){j(g)})}return new(_||(_=Promise))(function(g,j){function W($){try{O(S.next($))}catch(Y){j(Y)}}function J($){try{O(S.throw($))}catch(Y){j(Y)}}function O($){$.done?g($.value):y($.value).then(W,J)}O((S=S.apply(l,v||[])).next())})},x=function(l,v){var _={label:0,sent:function(){if(g[0]&1)throw g[1];return g[1]},trys:[],ops:[]},S,y,g,j;return j={next:W(0),throw:W(1),return:W(2)},typeof Symbol=="function"&&(j[Symbol.iterator]=function(){return this}),j;function W(O){return function($){return J([O,$])}}function J(O){if(S)throw new TypeError("Generator is already executing.");for(;_;)try{if(S=1,y&&(g=O[0]&2?y.return:O[0]?y.throw||((g=y.return)&&g.call(y),0):y.next)&&!(g=g.call(y,O[1])).done)return g;switch(y=0,g&&(O=[O[0]&2,g.value]),O[0]){case 0:case 1:g=O;break;case 4:return _.label++,{value:O[1],done:!1};case 5:_.label++,y=O[1],O=[0];continue;case 7:O=_.ops.pop(),_.trys.pop();continue;default:if(g=_.trys,!(g=g.length>0&&g[g.length-1])&&(O[0]===6||O[0]===2)){_=0;continue}if(O[0]===3&&(!g||O[1]>g[0]&&O[1]<g[3])){_.label=O[1];break}if(O[0]===6&&_.label<g[1]){_.label=g[1],g=O;break}if(g&&_.label<g[2]){_.label=g[2],_.ops.push(O);break}g[2]&&_.ops.pop(),_.trys.pop();continue}O=v.call(l,_)}catch($){O=[6,$],y=0}finally{S=g=0}if(O[0]&5)throw O[1];return{value:O[0]?O[1]:void 0,done:!0}}},K=function(l,v,_,S){S===void 0&&(S=_),l[S]=v[_]},N=function(l,v){for(var _ in l)_!=="default"&&!v.hasOwnProperty(_)&&(v[_]=l[_])},U=function(l){var v=typeof Symbol=="function"&&Symbol.iterator,_=v&&l[v],S=0;if(_)return _.call(l);if(l&&typeof l.length=="number")return{next:function(){return l&&S>=l.length&&(l=void 0),{value:l&&l[S++],done:!l}}};throw new TypeError(v?"Object is not iterable.":"Symbol.iterator is not defined.")},X=function(l,v){var _=typeof Symbol=="function"&&l[Symbol.iterator];if(!_)return l;var S=_.call(l),y,g=[],j;try{for(;(v===void 0||v-- >0)&&!(y=S.next()).done;)g.push(y.value)}catch(W){j={error:W}}finally{try{y&&!y.done&&(_=S.return)&&_.call(S)}finally{if(j)throw j.error}}return g},Q=function(){for(var l=[],v=0;v<arguments.length;v++)l=l.concat(X(arguments[v]));return l},ee=function(){for(var l=0,v=0,_=arguments.length;v<_;v++)l+=arguments[v].length;for(var S=Array(l),y=0,v=0;v<_;v++)for(var g=arguments[v],j=0,W=g.length;j<W;j++,y++)S[y]=g[j];return S},V=function(l){return this instanceof V?(this.v=l,this):new V(l)},Z=function(l,v,_){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var S=_.apply(l,v||[]),y,g=[];return y={},j("next"),j("throw"),j("return"),y[Symbol.asyncIterator]=function(){return this},y;function j(re){S[re]&&(y[re]=function(me){return new Promise(function(ut,be){g.push([re,me,ut,be])>1||W(re,me)})})}function W(re,me){try{J(S[re](me))}catch(ut){Y(g[0][3],ut)}}function J(re){re.value instanceof V?Promise.resolve(re.value.v).then(O,$):Y(g[0][2],re)}function O(re){W("next",re)}function $(re){W("throw",re)}function Y(re,me){re(me),g.shift(),g.length&&W(g[0][0],g[0][1])}},oe=function(l){var v,_;return v={},S("next"),S("throw",function(y){throw y}),S("return"),v[Symbol.iterator]=function(){return this},v;function S(y,g){v[y]=l[y]?function(j){return(_=!_)?{value:V(l[y](j)),done:y==="return"}:g?g(j):j}:g}},ge=function(l){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var v=l[Symbol.asyncIterator],_;return v?v.call(l):(l=typeof U=="function"?U(l):l[Symbol.iterator](),_={},S("next"),S("throw"),S("return"),_[Symbol.asyncIterator]=function(){return this},_);function S(g){_[g]=l[g]&&function(j){return new Promise(function(W,J){j=l[g](j),y(W,J,j.done,j.value)})}}function y(g,j,W,J){Promise.resolve(J).then(function(O){g({value:O,done:W})},j)}},ye=function(l,v){return Object.defineProperty?Object.defineProperty(l,"raw",{value:v}):l.raw=v,l},fe=function(l){if(l&&l.__esModule)return l;var v={};if(l!=null)for(var _ in l)Object.hasOwnProperty.call(l,_)&&(v[_]=l[_]);return v.default=l,v},he=function(l){return l&&l.__esModule?l:{default:l}},le=function(l,v){if(!v.has(l))throw new TypeError("attempted to get private field on non-instance");return v.get(l)},L=function(l,v,_){if(!v.has(l))throw new TypeError("attempted to set private field on non-instance");return v.set(l,_),_},F("__extends",i),F("__assign",r),F("__rest",s),F("__decorate",a),F("__param",f),F("__metadata",w),F("__awaiter",E),F("__generator",x),F("__exportStar",N),F("__createBinding",K),F("__values",U),F("__read",X),F("__spread",Q),F("__spreadArrays",ee),F("__await",V),F("__asyncGenerator",Z),F("__asyncDelegator",oe),F("__asyncValues",ge),F("__makeTemplateObject",ye),F("__importStar",fe),F("__importDefault",he),F("__classPrivateFieldGet",le),F("__classPrivateFieldSet",L)})})(Al);var jo,Nh;function $1(){if(Nh)return jo;Nh=1;function h(r){try{return JSON.stringify(r)}catch{return'"[Circular]"'}}jo=i;function i(r,s,a){var f=a&&a.stringify||h,w=1;if(typeof r=="object"&&r!==null){var E=s.length+w;if(E===1)return r;var x=new Array(E);x[0]=f(r);for(var N=1;N<E;N++)x[N]=f(s[N]);return x.join(" ")}if(typeof r!="string")return r;var U=s.length;if(U===0)return r;for(var X="",Q=1-w,ee=-1,V=r&&r.length||0,Z=0;Z<V;){if(r.charCodeAt(Z)===37&&Z+1<V){switch(ee=ee>-1?ee:0,r.charCodeAt(Z+1)){case 100:case 102:if(Q>=U||s[Q]==null)break;ee<Z&&(X+=r.slice(ee,Z)),X+=Number(s[Q]),ee=Z+2,Z++;break;case 105:if(Q>=U||s[Q]==null)break;ee<Z&&(X+=r.slice(ee,Z)),X+=Math.floor(Number(s[Q])),ee=Z+2,Z++;break;case 79:case 111:case 106:if(Q>=U||s[Q]===void 0)break;ee<Z&&(X+=r.slice(ee,Z));var oe=typeof s[Q];if(oe==="string"){X+="'"+s[Q]+"'",ee=Z+2,Z++;break}if(oe==="function"){X+=s[Q].name||"<anonymous>",ee=Z+2,Z++;break}X+=f(s[Q]),ee=Z+2,Z++;break;case 115:if(Q>=U)break;ee<Z&&(X+=r.slice(ee,Z)),X+=String(s[Q]),ee=Z+2,Z++;break;case 37:ee<Z&&(X+=r.slice(ee,Z)),X+="%",ee=Z+2,Z++,Q--;break}++Q}++Z}return ee===-1?r:(ee<V&&(X+=r.slice(ee)),X)}return jo}var $o,Fh;function L1(){if(Fh)return $o;Fh=1;const h=$1();$o=a;const i=le().console||{},r={mapHttpRequest:V,mapHttpResponse:V,wrapRequestSerializer:Z,wrapResponseSerializer:Z,wrapErrorSerializer:Z,req:V,res:V,err:Q};function s(L,K){return Array.isArray(L)?L.filter(function(ue){return ue!=="!stdSerializers.err"}):L===!0?Object.keys(K):!1}function a(L){L=L||{},L.browser=L.browser||{};const K=L.browser.transmit;if(K&&typeof K.send!="function")throw Error("pino: transmit option must have a send function");const F=L.browser.write||i;L.browser.write&&(L.browser.asObject=!0);const ue=L.serializers||{},l=s(L.browser.serialize,ue);let v=L.browser.serialize;Array.isArray(L.browser.serialize)&&L.browser.serialize.indexOf("!stdSerializers.err")>-1&&(v=!1);const _=["error","fatal","warn","info","debug","trace"];typeof F=="function"&&(F.error=F.fatal=F.warn=F.info=F.debug=F.trace=F),L.enabled===!1&&(L.level="silent");const S=L.level||"info",y=Object.create(F);y.log||(y.log=oe),Object.defineProperty(y,"levelVal",{get:j}),Object.defineProperty(y,"level",{get:W,set:J});const g={transmit:K,serialize:l,asObject:L.browser.asObject,levels:_,timestamp:ee(L)};y.levels=a.levels,y.level=S,y.setMaxListeners=y.getMaxListeners=y.emit=y.addListener=y.on=y.prependListener=y.once=y.prependOnceListener=y.removeListener=y.removeAllListeners=y.listeners=y.listenerCount=y.eventNames=y.write=y.flush=oe,y.serializers=ue,y._serialize=l,y._stdErrSerialize=v,y.child=O,K&&(y._logEvent=X());function j(){return this.level==="silent"?1/0:this.levels.values[this.level]}function W(){return this._level}function J($){if($!=="silent"&&!this.levels.values[$])throw Error("unknown level "+$);this._level=$,f(g,y,"error","log"),f(g,y,"fatal","error"),f(g,y,"warn","error"),f(g,y,"info","log"),f(g,y,"debug","log"),f(g,y,"trace","log")}function O($,Y){if(!$)throw new Error("missing bindings for child Pino");Y=Y||{},l&&$.serializers&&(Y.serializers=$.serializers);const re=Y.serializers;if(l&&re){var me=Object.assign({},ue,re),ut=L.browser.serialize===!0?Object.keys(me):l;delete $.serializers,x([$],ut,me,this._stdErrSerialize)}function be(St){this._childLevel=(St._childLevel|0)+1,this.error=N(St,$,"error"),this.fatal=N(St,$,"fatal"),this.warn=N(St,$,"warn"),this.info=N(St,$,"info"),this.debug=N(St,$,"debug"),this.trace=N(St,$,"trace"),me&&(this.serializers=me,this._serialize=ut),K&&(this._logEvent=X([].concat(St._logEvent.bindings,$)))}return be.prototype=this,new be(this)}return y}a.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},a.stdSerializers=r,a.stdTimeFunctions=Object.assign({},{nullTime:ge,epochTime:ye,unixTime:fe,isoTime:he});function f(L,K,F,ue){const l=Object.getPrototypeOf(K);K[F]=K.levelVal>K.levels.values[F]?oe:l[F]?l[F]:i[F]||i[ue]||oe,w(L,K,F)}function w(L,K,F){!L.transmit&&K[F]===oe||(K[F]=function(ue){return function(){const v=L.timestamp(),_=new Array(arguments.length),S=Object.getPrototypeOf&&Object.getPrototypeOf(this)===i?i:this;for(var y=0;y<_.length;y++)_[y]=arguments[y];if(L.serialize&&!L.asObject&&x(_,this._serialize,this.serializers,this._stdErrSerialize),L.asObject?ue.call(S,E(this,F,_,v)):ue.apply(S,_),L.transmit){const g=L.transmit.level||K.level,j=a.levels.values[g],W=a.levels.values[F];if(W<j)return;U(this,{ts:v,methodLevel:F,methodValue:W,transmitLevel:g,transmitValue:a.levels.values[L.transmit.level||K.level],send:L.transmit.send,val:K.levelVal},_)}}}(K[F]))}function E(L,K,F,ue){L._serialize&&x(F,L._serialize,L.serializers,L._stdErrSerialize);const l=F.slice();let v=l[0];const _={};ue&&(_.time=ue),_.level=a.levels.values[K];let S=(L._childLevel|0)+1;if(S<1&&(S=1),v!==null&&typeof v=="object"){for(;S--&&typeof l[0]=="object";)Object.assign(_,l.shift());v=l.length?h(l.shift(),l):void 0}else typeof v=="string"&&(v=h(l.shift(),l));return v!==void 0&&(_.msg=v),_}function x(L,K,F,ue){for(const l in L)if(ue&&L[l]instanceof Error)L[l]=a.stdSerializers.err(L[l]);else if(typeof L[l]=="object"&&!Array.isArray(L[l]))for(const v in L[l])K&&K.indexOf(v)>-1&&v in F&&(L[l][v]=F[v](L[l][v]))}function N(L,K,F){return function(){const ue=new Array(1+arguments.length);ue[0]=K;for(var l=1;l<ue.length;l++)ue[l]=arguments[l-1];return L[F].apply(this,ue)}}function U(L,K,F){const ue=K.send,l=K.ts,v=K.methodLevel,_=K.methodValue,S=K.val,y=L._logEvent.bindings;x(F,L._serialize||Object.keys(L.serializers),L.serializers,L._stdErrSerialize===void 0?!0:L._stdErrSerialize),L._logEvent.ts=l,L._logEvent.messages=F.filter(function(g){return y.indexOf(g)===-1}),L._logEvent.level.label=v,L._logEvent.level.value=_,ue(v,L._logEvent,S),L._logEvent=X(y)}function X(L){return{ts:0,messages:[],bindings:L||[],level:{label:"",value:0}}}function Q(L){const K={type:L.constructor.name,msg:L.message,stack:L.stack};for(const F in L)K[F]===void 0&&(K[F]=L[F]);return K}function ee(L){return typeof L.timestamp=="function"?L.timestamp:L.timestamp===!1?ge:ye}function V(){return{}}function Z(L){return L}function oe(){}function ge(){return!1}function ye(){return Date.now()}function fe(){return Math.round(Date.now()/1e3)}function he(){return new Date(Date.now()).toISOString()}function le(){function L(K){return typeof K<"u"&&K}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return L(self)||L(window)||L(this)||{}}}return $o}var ji={},Dh;function Tl(){return Dh||(Dh=1,Object.defineProperty(ji,"__esModule",{value:!0}),ji.PINO_CUSTOM_CONTEXT_KEY=ji.PINO_LOGGER_DEFAULTS=void 0,ji.PINO_LOGGER_DEFAULTS={level:"info"},ji.PINO_CUSTOM_CONTEXT_KEY="custom_context"),ji}var er={},jh;function M1(){if(jh)return er;jh=1,Object.defineProperty(er,"__esModule",{value:!0}),er.generateChildLogger=er.formatChildLoggerContext=er.getLoggerContext=er.setBrowserLoggerContext=er.getBrowserLoggerContext=er.getDefaultLoggerOptions=void 0;const h=Tl();function i(E){return Object.assign(Object.assign({},E),{level:E?.level||h.PINO_LOGGER_DEFAULTS.level})}er.getDefaultLoggerOptions=i;function r(E,x=h.PINO_CUSTOM_CONTEXT_KEY){return E[x]||""}er.getBrowserLoggerContext=r;function s(E,x,N=h.PINO_CUSTOM_CONTEXT_KEY){return E[N]=x,E}er.setBrowserLoggerContext=s;function a(E,x=h.PINO_CUSTOM_CONTEXT_KEY){let N="";return typeof E.bindings>"u"?N=r(E,x):N=E.bindings().context||"",N}er.getLoggerContext=a;function f(E,x,N=h.PINO_CUSTOM_CONTEXT_KEY){const U=a(E,N);return U.trim()?`${U}/${x}`:x}er.formatChildLoggerContext=f;function w(E,x,N=h.PINO_CUSTOM_CONTEXT_KEY){const U=f(E,x,N),X=E.child({context:U});return s(X,U,N)}return er.generateChildLogger=w,er}(function(h){Object.defineProperty(h,"__esModule",{value:!0}),h.pino=void 0;const i=Al.exports,r=i.__importDefault(L1());Object.defineProperty(h,"pino",{enumerable:!0,get:function(){return r.default}}),i.__exportStar(Tl(),h),i.__exportStar(M1(),h)})(De);class z1 extends Li{constructor(i){super(),this.opts=i,this.protocol="wc",this.version=2}}class q1 extends Li{constructor(i,r){super(),this.core=i,this.logger=r,this.records=new Map}}class U1{constructor(i,r){this.logger=i,this.core=r}}class H1 extends Li{constructor(i,r){super(),this.relayer=i,this.logger=r}}class k1 extends Li{constructor(i){super()}}class K1{constructor(i,r,s,a){this.core=i,this.logger=r,this.name=s}}class V1 extends Li{constructor(i,r){super(),this.relayer=i,this.logger=r}}class B1 extends Li{constructor(i,r){super(),this.core=i,this.logger=r}}class G1{constructor(i,r){this.projectId=i,this.logger=r}}class W1{constructor(i){this.opts=i,this.protocol="wc",this.version=2}}class J1{constructor(i){this.client=i}}var lc={},Rl={};(function(h){Object.defineProperty(h,"__esModule",{value:!0});var i=Fv,r=vl;h.DIGEST_LENGTH=64,h.BLOCK_SIZE=128;var s=function(){function E(){this.digestLength=h.DIGEST_LENGTH,this.blockSize=h.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return E.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},E.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},E.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._tempHi),r.wipe(this._tempLo),this.reset()},E.prototype.update=function(x,N){if(N===void 0&&(N=x.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var U=0;if(this._bytesHashed+=N,this._bufferLength>0){for(;this._bufferLength<h.BLOCK_SIZE&&N>0;)this._buffer[this._bufferLength++]=x[U++],N--;this._bufferLength===this.blockSize&&(f(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(N>=this.blockSize&&(U=f(this._tempHi,this._tempLo,this._stateHi,this._stateLo,x,U,N),N%=this.blockSize);N>0;)this._buffer[this._bufferLength++]=x[U++],N--;return this},E.prototype.finish=function(x){if(!this._finished){var N=this._bytesHashed,U=this._bufferLength,X=N/536870912|0,Q=N<<3,ee=N%128<112?128:256;this._buffer[U]=128;for(var V=U+1;V<ee-8;V++)this._buffer[V]=0;i.writeUint32BE(X,this._buffer,ee-8),i.writeUint32BE(Q,this._buffer,ee-4),f(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,ee),this._finished=!0}for(var V=0;V<this.digestLength/8;V++)i.writeUint32BE(this._stateHi[V],x,V*8),i.writeUint32BE(this._stateLo[V],x,V*8+4);return this},E.prototype.digest=function(){var x=new Uint8Array(this.digestLength);return this.finish(x),x},E.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},E.prototype.restoreState=function(x){return this._stateHi.set(x.stateHi),this._stateLo.set(x.stateLo),this._bufferLength=x.bufferLength,x.buffer&&this._buffer.set(x.buffer),this._bytesHashed=x.bytesHashed,this._finished=!1,this},E.prototype.cleanSavedState=function(x){r.wipe(x.stateHi),r.wipe(x.stateLo),x.buffer&&r.wipe(x.buffer),x.bufferLength=0,x.bytesHashed=0},E}();h.SHA512=s;var a=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function f(E,x,N,U,X,Q,ee){for(var V=N[0],Z=N[1],oe=N[2],ge=N[3],ye=N[4],fe=N[5],he=N[6],le=N[7],L=U[0],K=U[1],F=U[2],ue=U[3],l=U[4],v=U[5],_=U[6],S=U[7],y,g,j,W,J,O,$,Y;ee>=128;){for(var re=0;re<16;re++){var me=8*re+Q;E[re]=i.readUint32BE(X,me),x[re]=i.readUint32BE(X,me+4)}for(var re=0;re<80;re++){var ut=V,be=Z,St=oe,z=ge,M=ye,R=fe,c=he,P=le,ae=L,we=K,Pe=F,je=ue,Le=l,Te=v,Pt=_,mt=S;if(y=le,g=S,J=g&65535,O=g>>>16,$=y&65535,Y=y>>>16,y=(ye>>>14|l<<32-14)^(ye>>>18|l<<32-18)^(l>>>41-32|ye<<32-(41-32)),g=(l>>>14|ye<<32-14)^(l>>>18|ye<<32-18)^(ye>>>41-32|l<<32-(41-32)),J+=g&65535,O+=g>>>16,$+=y&65535,Y+=y>>>16,y=ye&fe^~ye&he,g=l&v^~l&_,J+=g&65535,O+=g>>>16,$+=y&65535,Y+=y>>>16,y=a[re*2],g=a[re*2+1],J+=g&65535,O+=g>>>16,$+=y&65535,Y+=y>>>16,y=E[re%16],g=x[re%16],J+=g&65535,O+=g>>>16,$+=y&65535,Y+=y>>>16,O+=J>>>16,$+=O>>>16,Y+=$>>>16,j=$&65535|Y<<16,W=J&65535|O<<16,y=j,g=W,J=g&65535,O=g>>>16,$=y&65535,Y=y>>>16,y=(V>>>28|L<<32-28)^(L>>>34-32|V<<32-(34-32))^(L>>>39-32|V<<32-(39-32)),g=(L>>>28|V<<32-28)^(V>>>34-32|L<<32-(34-32))^(V>>>39-32|L<<32-(39-32)),J+=g&65535,O+=g>>>16,$+=y&65535,Y+=y>>>16,y=V&Z^V&oe^Z&oe,g=L&K^L&F^K&F,J+=g&65535,O+=g>>>16,$+=y&65535,Y+=y>>>16,O+=J>>>16,$+=O>>>16,Y+=$>>>16,P=$&65535|Y<<16,mt=J&65535|O<<16,y=z,g=je,J=g&65535,O=g>>>16,$=y&65535,Y=y>>>16,y=j,g=W,J+=g&65535,O+=g>>>16,$+=y&65535,Y+=y>>>16,O+=J>>>16,$+=O>>>16,Y+=$>>>16,z=$&65535|Y<<16,je=J&65535|O<<16,Z=ut,oe=be,ge=St,ye=z,fe=M,he=R,le=c,V=P,K=ae,F=we,ue=Pe,l=je,v=Le,_=Te,S=Pt,L=mt,re%16===15)for(var me=0;me<16;me++)y=E[me],g=x[me],J=g&65535,O=g>>>16,$=y&65535,Y=y>>>16,y=E[(me+9)%16],g=x[(me+9)%16],J+=g&65535,O+=g>>>16,$+=y&65535,Y+=y>>>16,j=E[(me+1)%16],W=x[(me+1)%16],y=(j>>>1|W<<32-1)^(j>>>8|W<<32-8)^j>>>7,g=(W>>>1|j<<32-1)^(W>>>8|j<<32-8)^(W>>>7|j<<32-7),J+=g&65535,O+=g>>>16,$+=y&65535,Y+=y>>>16,j=E[(me+14)%16],W=x[(me+14)%16],y=(j>>>19|W<<32-19)^(W>>>61-32|j<<32-(61-32))^j>>>6,g=(W>>>19|j<<32-19)^(j>>>61-32|W<<32-(61-32))^(W>>>6|j<<32-6),J+=g&65535,O+=g>>>16,$+=y&65535,Y+=y>>>16,O+=J>>>16,$+=O>>>16,Y+=$>>>16,E[me]=$&65535|Y<<16,x[me]=J&65535|O<<16}y=V,g=L,J=g&65535,O=g>>>16,$=y&65535,Y=y>>>16,y=N[0],g=U[0],J+=g&65535,O+=g>>>16,$+=y&65535,Y+=y>>>16,O+=J>>>16,$+=O>>>16,Y+=$>>>16,N[0]=V=$&65535|Y<<16,U[0]=L=J&65535|O<<16,y=Z,g=K,J=g&65535,O=g>>>16,$=y&65535,Y=y>>>16,y=N[1],g=U[1],J+=g&65535,O+=g>>>16,$+=y&65535,Y+=y>>>16,O+=J>>>16,$+=O>>>16,Y+=$>>>16,N[1]=Z=$&65535|Y<<16,U[1]=K=J&65535|O<<16,y=oe,g=F,J=g&65535,O=g>>>16,$=y&65535,Y=y>>>16,y=N[2],g=U[2],J+=g&65535,O+=g>>>16,$+=y&65535,Y+=y>>>16,O+=J>>>16,$+=O>>>16,Y+=$>>>16,N[2]=oe=$&65535|Y<<16,U[2]=F=J&65535|O<<16,y=ge,g=ue,J=g&65535,O=g>>>16,$=y&65535,Y=y>>>16,y=N[3],g=U[3],J+=g&65535,O+=g>>>16,$+=y&65535,Y+=y>>>16,O+=J>>>16,$+=O>>>16,Y+=$>>>16,N[3]=ge=$&65535|Y<<16,U[3]=ue=J&65535|O<<16,y=ye,g=l,J=g&65535,O=g>>>16,$=y&65535,Y=y>>>16,y=N[4],g=U[4],J+=g&65535,O+=g>>>16,$+=y&65535,Y+=y>>>16,O+=J>>>16,$+=O>>>16,Y+=$>>>16,N[4]=ye=$&65535|Y<<16,U[4]=l=J&65535|O<<16,y=fe,g=v,J=g&65535,O=g>>>16,$=y&65535,Y=y>>>16,y=N[5],g=U[5],J+=g&65535,O+=g>>>16,$+=y&65535,Y+=y>>>16,O+=J>>>16,$+=O>>>16,Y+=$>>>16,N[5]=fe=$&65535|Y<<16,U[5]=v=J&65535|O<<16,y=he,g=_,J=g&65535,O=g>>>16,$=y&65535,Y=y>>>16,y=N[6],g=U[6],J+=g&65535,O+=g>>>16,$+=y&65535,Y+=y>>>16,O+=J>>>16,$+=O>>>16,Y+=$>>>16,N[6]=he=$&65535|Y<<16,U[6]=_=J&65535|O<<16,y=le,g=S,J=g&65535,O=g>>>16,$=y&65535,Y=y>>>16,y=N[7],g=U[7],J+=g&65535,O+=g>>>16,$+=y&65535,Y+=y>>>16,O+=J>>>16,$+=O>>>16,Y+=$>>>16,N[7]=le=$&65535|Y<<16,U[7]=S=J&65535|O<<16,Q+=128,ee-=128}return Q}function w(E){var x=new s;x.update(E);var N=x.digest();return x.clean(),N}h.hash=w})(Rl);(function(h){Object.defineProperty(h,"__esModule",{value:!0}),h.convertSecretKeyToX25519=h.convertPublicKeyToX25519=h.verify=h.sign=h.extractPublicKeyFromSecretKey=h.generateKeyPair=h.generateKeyPairFromSeed=h.SEED_LENGTH=h.SECRET_KEY_LENGTH=h.PUBLIC_KEY_LENGTH=h.SIGNATURE_LENGTH=void 0;const i=_l,r=Rl,s=vl;h.SIGNATURE_LENGTH=64,h.PUBLIC_KEY_LENGTH=32,h.SECRET_KEY_LENGTH=64,h.SEED_LENGTH=32;function a(z){const M=new Float64Array(16);if(z)for(let R=0;R<z.length;R++)M[R]=z[R];return M}const f=new Uint8Array(32);f[0]=9;const w=a(),E=a([1]),x=a([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),N=a([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),U=a([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),X=a([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),Q=a([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function ee(z,M){for(let R=0;R<16;R++)z[R]=M[R]|0}function V(z){let M=1;for(let R=0;R<16;R++){let c=z[R]+M+65535;M=Math.floor(c/65536),z[R]=c-M*65536}z[0]+=M-1+37*(M-1)}function Z(z,M,R){const c=~(R-1);for(let P=0;P<16;P++){const ae=c&(z[P]^M[P]);z[P]^=ae,M[P]^=ae}}function oe(z,M){const R=a(),c=a();for(let P=0;P<16;P++)c[P]=M[P];V(c),V(c),V(c);for(let P=0;P<2;P++){R[0]=c[0]-65517;for(let we=1;we<15;we++)R[we]=c[we]-65535-(R[we-1]>>16&1),R[we-1]&=65535;R[15]=c[15]-32767-(R[14]>>16&1);const ae=R[15]>>16&1;R[14]&=65535,Z(c,R,1-ae)}for(let P=0;P<16;P++)z[2*P]=c[P]&255,z[2*P+1]=c[P]>>8}function ge(z,M){let R=0;for(let c=0;c<32;c++)R|=z[c]^M[c];return(1&R-1>>>8)-1}function ye(z,M){const R=new Uint8Array(32),c=new Uint8Array(32);return oe(R,z),oe(c,M),ge(R,c)}function fe(z){const M=new Uint8Array(32);return oe(M,z),M[0]&1}function he(z,M){for(let R=0;R<16;R++)z[R]=M[2*R]+(M[2*R+1]<<8);z[15]&=32767}function le(z,M,R){for(let c=0;c<16;c++)z[c]=M[c]+R[c]}function L(z,M,R){for(let c=0;c<16;c++)z[c]=M[c]-R[c]}function K(z,M,R){let c,P,ae=0,we=0,Pe=0,je=0,Le=0,Te=0,Pt=0,mt=0,st=0,ze=0,Ze=0,Xe=0,at=0,ke=0,Qe=0,$e=0,Ve=0,ht=0,Ue=0,Ot=0,$t=0,Ht=0,kt=0,zt=0,Wt=0,rr=0,$r=0,Jt=0,Kr=0,ii=0,wi=0,lt=R[0],rt=R[1],ft=R[2],pt=R[3],ot=R[4],it=R[5],Ct=R[6],At=R[7],dt=R[8],Tt=R[9],gt=R[10],wt=R[11],yt=R[12],Ye=R[13],Rt=R[14],Nt=R[15];c=M[0],ae+=c*lt,we+=c*rt,Pe+=c*ft,je+=c*pt,Le+=c*ot,Te+=c*it,Pt+=c*Ct,mt+=c*At,st+=c*dt,ze+=c*Tt,Ze+=c*gt,Xe+=c*wt,at+=c*yt,ke+=c*Ye,Qe+=c*Rt,$e+=c*Nt,c=M[1],we+=c*lt,Pe+=c*rt,je+=c*ft,Le+=c*pt,Te+=c*ot,Pt+=c*it,mt+=c*Ct,st+=c*At,ze+=c*dt,Ze+=c*Tt,Xe+=c*gt,at+=c*wt,ke+=c*yt,Qe+=c*Ye,$e+=c*Rt,Ve+=c*Nt,c=M[2],Pe+=c*lt,je+=c*rt,Le+=c*ft,Te+=c*pt,Pt+=c*ot,mt+=c*it,st+=c*Ct,ze+=c*At,Ze+=c*dt,Xe+=c*Tt,at+=c*gt,ke+=c*wt,Qe+=c*yt,$e+=c*Ye,Ve+=c*Rt,ht+=c*Nt,c=M[3],je+=c*lt,Le+=c*rt,Te+=c*ft,Pt+=c*pt,mt+=c*ot,st+=c*it,ze+=c*Ct,Ze+=c*At,Xe+=c*dt,at+=c*Tt,ke+=c*gt,Qe+=c*wt,$e+=c*yt,Ve+=c*Ye,ht+=c*Rt,Ue+=c*Nt,c=M[4],Le+=c*lt,Te+=c*rt,Pt+=c*ft,mt+=c*pt,st+=c*ot,ze+=c*it,Ze+=c*Ct,Xe+=c*At,at+=c*dt,ke+=c*Tt,Qe+=c*gt,$e+=c*wt,Ve+=c*yt,ht+=c*Ye,Ue+=c*Rt,Ot+=c*Nt,c=M[5],Te+=c*lt,Pt+=c*rt,mt+=c*ft,st+=c*pt,ze+=c*ot,Ze+=c*it,Xe+=c*Ct,at+=c*At,ke+=c*dt,Qe+=c*Tt,$e+=c*gt,Ve+=c*wt,ht+=c*yt,Ue+=c*Ye,Ot+=c*Rt,$t+=c*Nt,c=M[6],Pt+=c*lt,mt+=c*rt,st+=c*ft,ze+=c*pt,Ze+=c*ot,Xe+=c*it,at+=c*Ct,ke+=c*At,Qe+=c*dt,$e+=c*Tt,Ve+=c*gt,ht+=c*wt,Ue+=c*yt,Ot+=c*Ye,$t+=c*Rt,Ht+=c*Nt,c=M[7],mt+=c*lt,st+=c*rt,ze+=c*ft,Ze+=c*pt,Xe+=c*ot,at+=c*it,ke+=c*Ct,Qe+=c*At,$e+=c*dt,Ve+=c*Tt,ht+=c*gt,Ue+=c*wt,Ot+=c*yt,$t+=c*Ye,Ht+=c*Rt,kt+=c*Nt,c=M[8],st+=c*lt,ze+=c*rt,Ze+=c*ft,Xe+=c*pt,at+=c*ot,ke+=c*it,Qe+=c*Ct,$e+=c*At,Ve+=c*dt,ht+=c*Tt,Ue+=c*gt,Ot+=c*wt,$t+=c*yt,Ht+=c*Ye,kt+=c*Rt,zt+=c*Nt,c=M[9],ze+=c*lt,Ze+=c*rt,Xe+=c*ft,at+=c*pt,ke+=c*ot,Qe+=c*it,$e+=c*Ct,Ve+=c*At,ht+=c*dt,Ue+=c*Tt,Ot+=c*gt,$t+=c*wt,Ht+=c*yt,kt+=c*Ye,zt+=c*Rt,Wt+=c*Nt,c=M[10],Ze+=c*lt,Xe+=c*rt,at+=c*ft,ke+=c*pt,Qe+=c*ot,$e+=c*it,Ve+=c*Ct,ht+=c*At,Ue+=c*dt,Ot+=c*Tt,$t+=c*gt,Ht+=c*wt,kt+=c*yt,zt+=c*Ye,Wt+=c*Rt,rr+=c*Nt,c=M[11],Xe+=c*lt,at+=c*rt,ke+=c*ft,Qe+=c*pt,$e+=c*ot,Ve+=c*it,ht+=c*Ct,Ue+=c*At,Ot+=c*dt,$t+=c*Tt,Ht+=c*gt,kt+=c*wt,zt+=c*yt,Wt+=c*Ye,rr+=c*Rt,$r+=c*Nt,c=M[12],at+=c*lt,ke+=c*rt,Qe+=c*ft,$e+=c*pt,Ve+=c*ot,ht+=c*it,Ue+=c*Ct,Ot+=c*At,$t+=c*dt,Ht+=c*Tt,kt+=c*gt,zt+=c*wt,Wt+=c*yt,rr+=c*Ye,$r+=c*Rt,Jt+=c*Nt,c=M[13],ke+=c*lt,Qe+=c*rt,$e+=c*ft,Ve+=c*pt,ht+=c*ot,Ue+=c*it,Ot+=c*Ct,$t+=c*At,Ht+=c*dt,kt+=c*Tt,zt+=c*gt,Wt+=c*wt,rr+=c*yt,$r+=c*Ye,Jt+=c*Rt,Kr+=c*Nt,c=M[14],Qe+=c*lt,$e+=c*rt,Ve+=c*ft,ht+=c*pt,Ue+=c*ot,Ot+=c*it,$t+=c*Ct,Ht+=c*At,kt+=c*dt,zt+=c*Tt,Wt+=c*gt,rr+=c*wt,$r+=c*yt,Jt+=c*Ye,Kr+=c*Rt,ii+=c*Nt,c=M[15],$e+=c*lt,Ve+=c*rt,ht+=c*ft,Ue+=c*pt,Ot+=c*ot,$t+=c*it,Ht+=c*Ct,kt+=c*At,zt+=c*dt,Wt+=c*Tt,rr+=c*gt,$r+=c*wt,Jt+=c*yt,Kr+=c*Ye,ii+=c*Rt,wi+=c*Nt,ae+=38*Ve,we+=38*ht,Pe+=38*Ue,je+=38*Ot,Le+=38*$t,Te+=38*Ht,Pt+=38*kt,mt+=38*zt,st+=38*Wt,ze+=38*rr,Ze+=38*$r,Xe+=38*Jt,at+=38*Kr,ke+=38*ii,Qe+=38*wi,P=1,c=ae+P+65535,P=Math.floor(c/65536),ae=c-P*65536,c=we+P+65535,P=Math.floor(c/65536),we=c-P*65536,c=Pe+P+65535,P=Math.floor(c/65536),Pe=c-P*65536,c=je+P+65535,P=Math.floor(c/65536),je=c-P*65536,c=Le+P+65535,P=Math.floor(c/65536),Le=c-P*65536,c=Te+P+65535,P=Math.floor(c/65536),Te=c-P*65536,c=Pt+P+65535,P=Math.floor(c/65536),Pt=c-P*65536,c=mt+P+65535,P=Math.floor(c/65536),mt=c-P*65536,c=st+P+65535,P=Math.floor(c/65536),st=c-P*65536,c=ze+P+65535,P=Math.floor(c/65536),ze=c-P*65536,c=Ze+P+65535,P=Math.floor(c/65536),Ze=c-P*65536,c=Xe+P+65535,P=Math.floor(c/65536),Xe=c-P*65536,c=at+P+65535,P=Math.floor(c/65536),at=c-P*65536,c=ke+P+65535,P=Math.floor(c/65536),ke=c-P*65536,c=Qe+P+65535,P=Math.floor(c/65536),Qe=c-P*65536,c=$e+P+65535,P=Math.floor(c/65536),$e=c-P*65536,ae+=P-1+37*(P-1),P=1,c=ae+P+65535,P=Math.floor(c/65536),ae=c-P*65536,c=we+P+65535,P=Math.floor(c/65536),we=c-P*65536,c=Pe+P+65535,P=Math.floor(c/65536),Pe=c-P*65536,c=je+P+65535,P=Math.floor(c/65536),je=c-P*65536,c=Le+P+65535,P=Math.floor(c/65536),Le=c-P*65536,c=Te+P+65535,P=Math.floor(c/65536),Te=c-P*65536,c=Pt+P+65535,P=Math.floor(c/65536),Pt=c-P*65536,c=mt+P+65535,P=Math.floor(c/65536),mt=c-P*65536,c=st+P+65535,P=Math.floor(c/65536),st=c-P*65536,c=ze+P+65535,P=Math.floor(c/65536),ze=c-P*65536,c=Ze+P+65535,P=Math.floor(c/65536),Ze=c-P*65536,c=Xe+P+65535,P=Math.floor(c/65536),Xe=c-P*65536,c=at+P+65535,P=Math.floor(c/65536),at=c-P*65536,c=ke+P+65535,P=Math.floor(c/65536),ke=c-P*65536,c=Qe+P+65535,P=Math.floor(c/65536),Qe=c-P*65536,c=$e+P+65535,P=Math.floor(c/65536),$e=c-P*65536,ae+=P-1+37*(P-1),z[0]=ae,z[1]=we,z[2]=Pe,z[3]=je,z[4]=Le,z[5]=Te,z[6]=Pt,z[7]=mt,z[8]=st,z[9]=ze,z[10]=Ze,z[11]=Xe,z[12]=at,z[13]=ke,z[14]=Qe,z[15]=$e}function F(z,M){K(z,M,M)}function ue(z,M){const R=a();let c;for(c=0;c<16;c++)R[c]=M[c];for(c=253;c>=0;c--)F(R,R),c!==2&&c!==4&&K(R,R,M);for(c=0;c<16;c++)z[c]=R[c]}function l(z,M){const R=a();let c;for(c=0;c<16;c++)R[c]=M[c];for(c=250;c>=0;c--)F(R,R),c!==1&&K(R,R,M);for(c=0;c<16;c++)z[c]=R[c]}function v(z,M){const R=a(),c=a(),P=a(),ae=a(),we=a(),Pe=a(),je=a(),Le=a(),Te=a();L(R,z[1],z[0]),L(Te,M[1],M[0]),K(R,R,Te),le(c,z[0],z[1]),le(Te,M[0],M[1]),K(c,c,Te),K(P,z[3],M[3]),K(P,P,N),K(ae,z[2],M[2]),le(ae,ae,ae),L(we,c,R),L(Pe,ae,P),le(je,ae,P),le(Le,c,R),K(z[0],we,Pe),K(z[1],Le,je),K(z[2],je,Pe),K(z[3],we,Le)}function _(z,M,R){for(let c=0;c<4;c++)Z(z[c],M[c],R)}function S(z,M){const R=a(),c=a(),P=a();ue(P,M[2]),K(R,M[0],P),K(c,M[1],P),oe(z,c),z[31]^=fe(R)<<7}function y(z,M,R){ee(z[0],w),ee(z[1],E),ee(z[2],E),ee(z[3],w);for(let c=255;c>=0;--c){const P=R[c/8|0]>>(c&7)&1;_(z,M,P),v(M,z),v(z,z),_(z,M,P)}}function g(z,M){const R=[a(),a(),a(),a()];ee(R[0],U),ee(R[1],X),ee(R[2],E),K(R[3],U,X),y(z,R,M)}function j(z){if(z.length!==h.SEED_LENGTH)throw new Error(`ed25519: seed must be ${h.SEED_LENGTH} bytes`);const M=(0,r.hash)(z);M[0]&=248,M[31]&=127,M[31]|=64;const R=new Uint8Array(32),c=[a(),a(),a(),a()];g(c,M),S(R,c);const P=new Uint8Array(64);return P.set(z),P.set(R,32),{publicKey:R,secretKey:P}}h.generateKeyPairFromSeed=j;function W(z){const M=(0,i.randomBytes)(32,z),R=j(M);return(0,s.wipe)(M),R}h.generateKeyPair=W;function J(z){if(z.length!==h.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${h.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(z.subarray(32))}h.extractPublicKeyFromSecretKey=J;const O=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function $(z,M){let R,c,P,ae;for(c=63;c>=32;--c){for(R=0,P=c-32,ae=c-12;P<ae;++P)M[P]+=R-16*M[c]*O[P-(c-32)],R=Math.floor((M[P]+128)/256),M[P]-=R*256;M[P]+=R,M[c]=0}for(R=0,P=0;P<32;P++)M[P]+=R-(M[31]>>4)*O[P],R=M[P]>>8,M[P]&=255;for(P=0;P<32;P++)M[P]-=R*O[P];for(c=0;c<32;c++)M[c+1]+=M[c]>>8,z[c]=M[c]&255}function Y(z){const M=new Float64Array(64);for(let R=0;R<64;R++)M[R]=z[R];for(let R=0;R<64;R++)z[R]=0;$(z,M)}function re(z,M){const R=new Float64Array(64),c=[a(),a(),a(),a()],P=(0,r.hash)(z.subarray(0,32));P[0]&=248,P[31]&=127,P[31]|=64;const ae=new Uint8Array(64);ae.set(P.subarray(32),32);const we=new r.SHA512;we.update(ae.subarray(32)),we.update(M);const Pe=we.digest();we.clean(),Y(Pe),g(c,Pe),S(ae,c),we.reset(),we.update(ae.subarray(0,32)),we.update(z.subarray(32)),we.update(M);const je=we.digest();Y(je);for(let Le=0;Le<32;Le++)R[Le]=Pe[Le];for(let Le=0;Le<32;Le++)for(let Te=0;Te<32;Te++)R[Le+Te]+=je[Le]*P[Te];return $(ae.subarray(32),R),ae}h.sign=re;function me(z,M){const R=a(),c=a(),P=a(),ae=a(),we=a(),Pe=a(),je=a();return ee(z[2],E),he(z[1],M),F(P,z[1]),K(ae,P,x),L(P,P,z[2]),le(ae,z[2],ae),F(we,ae),F(Pe,we),K(je,Pe,we),K(R,je,P),K(R,R,ae),l(R,R),K(R,R,P),K(R,R,ae),K(R,R,ae),K(z[0],R,ae),F(c,z[0]),K(c,c,ae),ye(c,P)&&K(z[0],z[0],Q),F(c,z[0]),K(c,c,ae),ye(c,P)?-1:(fe(z[0])===M[31]>>7&&L(z[0],w,z[0]),K(z[3],z[0],z[1]),0)}function ut(z,M,R){const c=new Uint8Array(32),P=[a(),a(),a(),a()],ae=[a(),a(),a(),a()];if(R.length!==h.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${h.SIGNATURE_LENGTH} bytes`);if(me(ae,z))return!1;const we=new r.SHA512;we.update(R.subarray(0,32)),we.update(z),we.update(M);const Pe=we.digest();return Y(Pe),y(P,ae,Pe),g(ae,R.subarray(32)),v(P,ae),S(c,P),!ge(R,c)}h.verify=ut;function be(z){let M=[a(),a(),a(),a()];if(me(M,z))throw new Error("Ed25519: invalid public key");let R=a(),c=a(),P=M[1];le(R,E,P),L(c,E,P),ue(c,c),K(R,R,c);let ae=new Uint8Array(32);return oe(ae,R),ae}h.convertPublicKeyToX25519=be;function St(z){const M=(0,r.hash)(z.subarray(0,32));M[0]&=248,M[31]&=127,M[31]|=64;const R=new Uint8Array(M.subarray(0,32));return(0,s.wipe)(M),R}h.convertSecretKeyToX25519=St})(lc);const Y1="EdDSA",Z1="JWT",Nl=".",Fl="base64url",X1="utf8",Q1="utf8",e_=":",t_="did",r_="key",$h="base58btc",i_="z",n_="K36",s_=32;function ea(h){return ta(ic(nc(h),X1),Fl)}function Dl(h){const i=ic(n_,$h),r=i_+ta(Dv([i,h]),$h);return[t_,r_,r].join(e_)}function a_(h){return ta(h,Fl)}function o_(h){return ic([ea(h.header),ea(h.payload)].join(Nl),Q1)}function c_(h){return[ea(h.header),ea(h.payload),a_(h.signature)].join(Nl)}function Lh(h=_l.randomBytes(s_)){return lc.generateKeyPairFromSeed(h)}async function u_(h,i,r,s,a=de.fromMiliseconds(Date.now())){const f={alg:Y1,typ:Z1},w=Dl(s.publicKey),E=a+r,x={iss:w,sub:h,aud:i,iat:a,exp:E},N=o_({header:f,payload:x}),U=lc.sign(s.secretKey,N);return c_({header:f,payload:x,signature:U})}const h_=()=>typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:require("ws"),l_=()=>typeof window<"u",Mh=h=>h.split("?")[0],zh=10,f_=h_();class p_{constructor(i){if(this.url=i,this.events=new yr.exports.EventEmitter,this.registering=!1,!bh(i))throw new Error(`Provided URL is not compatible with WebSocket connection: ${i}`);this.url=i}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(i,r){this.events.on(i,r)}once(i,r){this.events.once(i,r)}off(i,r){this.events.off(i,r)}removeListener(i,r){this.events.removeListener(i,r)}async open(i=this.url){await this.register(i)}async close(){return new Promise((i,r)=>{if(typeof this.socket>"u"){r(new Error("Connection already closed"));return}this.socket.onclose=s=>{this.onClose(s),i()},this.socket.close()})}async send(i,r){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(nc(i))}catch(s){this.onError(i.id,s)}}register(i=this.url){if(!bh(i))throw new Error(`Provided URL is not compatible with WebSocket connection: ${i}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((s,a)=>{this.events.once("register_error",f=>{this.resetMaxListeners(),a(f)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return a(new Error("WebSocket connection is missing or invalid"));s(this.socket)})})}return this.url=i,this.registering=!0,new Promise((r,s)=>{const a=m1.isReactNative()?void 0:{rejectUnauthorized:!w1(i)},f=new f_(i,[],a);l_()?f.onerror=w=>{const E=w;s(this.emitError(E.error))}:f.on("error",w=>{s(this.emitError(w))}),f.onopen=()=>{this.onOpen(f),r(f)}})}onOpen(i){i.onmessage=r=>this.onPayload(r),i.onclose=r=>this.onClose(r),this.socket=i,this.registering=!1,this.events.emit("open")}onClose(i){this.socket=void 0,this.registering=!1,this.events.emit("close",i)}onPayload(i){if(typeof i.data>"u")return;const r=typeof i.data=="string"?xl(i.data):i.data;this.events.emit("payload",r)}onError(i,r){const s=this.parseError(r),a=s.message||s.toString(),f=sc(i,a);this.events.emit("payload",f)}parseError(i,r=this.url){return b1(i,Mh(r),"WS")}resetMaxListeners(){this.events.getMaxListeners()>zh&&this.events.setMaxListeners(zh)}emitError(i){const r=this.parseError(new Error(i?.message||`WebSocket connection failed for host: ${Mh(this.url)}`));return this.events.emit("register_error",r),r}}var Jo={exports:{}};(function(h,i){var r=200,s="__lodash_hash_undefined__",a=1,f=2,w=9007199254740991,E="[object Arguments]",x="[object Array]",N="[object AsyncFunction]",U="[object Boolean]",X="[object Date]",Q="[object Error]",ee="[object Function]",V="[object GeneratorFunction]",Z="[object Map]",oe="[object Number]",ge="[object Null]",ye="[object Object]",fe="[object Promise]",he="[object Proxy]",le="[object RegExp]",L="[object Set]",K="[object String]",F="[object Symbol]",ue="[object Undefined]",l="[object WeakMap]",v="[object ArrayBuffer]",_="[object DataView]",S="[object Float32Array]",y="[object Float64Array]",g="[object Int8Array]",j="[object Int16Array]",W="[object Int32Array]",J="[object Uint8Array]",O="[object Uint8ClampedArray]",$="[object Uint16Array]",Y="[object Uint32Array]",re=/[\\^$.*+?()[\]{}|]/g,me=/^\[object .+?Constructor\]$/,ut=/^(?:0|[1-9]\d*)$/,be={};be[S]=be[y]=be[g]=be[j]=be[W]=be[J]=be[O]=be[$]=be[Y]=!0,be[E]=be[x]=be[v]=be[U]=be[_]=be[X]=be[Q]=be[ee]=be[Z]=be[oe]=be[ye]=be[le]=be[L]=be[K]=be[l]=!1;var St=typeof gr=="object"&&gr&&gr.Object===Object&&gr,z=typeof self=="object"&&self&&self.Object===Object&&self,M=St||z||Function("return this")(),R=i&&!i.nodeType&&i,c=R&&!0&&h&&!h.nodeType&&h,P=c&&c.exports===R,ae=P&&St.process,we=function(){try{return ae&&ae.binding&&ae.binding("util")}catch{}}(),Pe=we&&we.isTypedArray;function je(m,C){for(var B=-1,ie=m==null?0:m.length,Ge=0,Ie=[];++B<ie;){var et=m[B];C(et,B,m)&&(Ie[Ge++]=et)}return Ie}function Le(m,C){for(var B=-1,ie=C.length,Ge=m.length;++B<ie;)m[Ge+B]=C[B];return m}function Te(m,C){for(var B=-1,ie=m==null?0:m.length;++B<ie;)if(C(m[B],B,m))return!0;return!1}function Pt(m,C){for(var B=-1,ie=Array(m);++B<m;)ie[B]=C(B);return ie}function mt(m){return function(C){return m(C)}}function st(m,C){return m.has(C)}function ze(m,C){return m?.[C]}function Ze(m){var C=-1,B=Array(m.size);return m.forEach(function(ie,Ge){B[++C]=[Ge,ie]}),B}function Xe(m,C){return function(B){return m(C(B))}}function at(m){var C=-1,B=Array(m.size);return m.forEach(function(ie){B[++C]=ie}),B}var ke=Array.prototype,Qe=Function.prototype,$e=Object.prototype,Ve=M["__core-js_shared__"],ht=Qe.toString,Ue=$e.hasOwnProperty,Ot=function(){var m=/[^.]+$/.exec(Ve&&Ve.keys&&Ve.keys.IE_PROTO||"");return m?"Symbol(src)_1."+m:""}(),$t=$e.toString,Ht=RegExp("^"+ht.call(Ue).replace(re,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),kt=P?M.Buffer:void 0,zt=M.Symbol,Wt=M.Uint8Array,rr=$e.propertyIsEnumerable,$r=ke.splice,Jt=zt?zt.toStringTag:void 0,Kr=Object.getOwnPropertySymbols,ii=kt?kt.isBuffer:void 0,wi=Xe(Object.keys,Object),lt=ur(M,"DataView"),rt=ur(M,"Map"),ft=ur(M,"Promise"),pt=ur(M,"Set"),ot=ur(M,"WeakMap"),it=ur(Object,"create"),Ct=Br(lt),At=Br(rt),dt=Br(ft),Tt=Br(pt),gt=Br(ot),wt=zt?zt.prototype:void 0,yt=wt?wt.valueOf:void 0;function Ye(m){var C=-1,B=m==null?0:m.length;for(this.clear();++C<B;){var ie=m[C];this.set(ie[0],ie[1])}}function Rt(){this.__data__=it?it(null):{},this.size=0}function Nt(m){var C=this.has(m)&&delete this.__data__[m];return this.size-=C?1:0,C}function sa(m){var C=this.__data__;if(it){var B=C[m];return B===s?void 0:B}return Ue.call(C,m)?C[m]:void 0}function aa(m){var C=this.__data__;return it?C[m]!==void 0:Ue.call(C,m)}function oa(m,C){var B=this.__data__;return this.size+=this.has(m)?0:1,B[m]=it&&C===void 0?s:C,this}Ye.prototype.clear=Rt,Ye.prototype.delete=Nt,Ye.prototype.get=sa,Ye.prototype.has=aa,Ye.prototype.set=oa;function vr(m){var C=-1,B=m==null?0:m.length;for(this.clear();++C<B;){var ie=m[C];this.set(ie[0],ie[1])}}function ca(){this.__data__=[],this.size=0}function ua(m){var C=this.__data__,B=bi(C,m);if(B<0)return!1;var ie=C.length-1;return B==ie?C.pop():$r.call(C,B,1),--this.size,!0}function ha(m){var C=this.__data__,B=bi(C,m);return B<0?void 0:C[B][1]}function la(m){return bi(this.__data__,m)>-1}function fa(m,C){var B=this.__data__,ie=bi(B,m);return ie<0?(++this.size,B.push([m,C])):B[ie][1]=C,this}vr.prototype.clear=ca,vr.prototype.delete=ua,vr.prototype.get=ha,vr.prototype.has=la,vr.prototype.set=fa;function Vr(m){var C=-1,B=m==null?0:m.length;for(this.clear();++C<B;){var ie=m[C];this.set(ie[0],ie[1])}}function Mi(){this.size=0,this.__data__={hash:new Ye,map:new(rt||vr),string:new Ye}}function pa(m){var C=ni(this,m).delete(m);return this.size-=C?1:0,C}function zi(m){return ni(this,m).get(m)}function da(m){return ni(this,m).has(m)}function ga(m,C){var B=ni(this,m),ie=B.size;return B.set(m,C),this.size+=B.size==ie?0:1,this}Vr.prototype.clear=Mi,Vr.prototype.delete=pa,Vr.prototype.get=zi,Vr.prototype.has=da,Vr.prototype.set=ga;function qi(m){var C=-1,B=m==null?0:m.length;for(this.__data__=new Vr;++C<B;)this.add(m[C])}function kn(m){return this.__data__.set(m,s),this}function Kn(m){return this.__data__.has(m)}qi.prototype.add=qi.prototype.push=kn,qi.prototype.has=Kn;function Ar(m){var C=this.__data__=new vr(m);this.size=C.size}function ya(){this.__data__=new vr,this.size=0}function va(m){var C=this.__data__,B=C.delete(m);return this.size=C.size,B}function _a(m){return this.__data__.get(m)}function ma(m){return this.__data__.has(m)}function Vn(m,C){var B=this.__data__;if(B instanceof vr){var ie=B.__data__;if(!rt||ie.length<r-1)return ie.push([m,C]),this.size=++B.size,this;B=this.__data__=new Vr(ie)}return B.set(m,C),this.size=B.size,this}Ar.prototype.clear=ya,Ar.prototype.delete=va,Ar.prototype.get=_a,Ar.prototype.has=ma,Ar.prototype.set=Vn;function Bn(m,C){var B=ki(m),ie=!B&&ns(m),Ge=!B&&!ie&&pn(m),Ie=!B&&!ie&&!Ge&&os(m),et=B||ie||Ge||Ie,Ft=et?Pt(m.length,String):[],Ne=Ft.length;for(var We in m)(C||Ue.call(m,We))&&!(et&&(We=="length"||Ge&&(We=="offset"||We=="parent")||Ie&&(We=="buffer"||We=="byteLength"||We=="byteOffset")||Qn(We,Ne)))&&Ft.push(We);return Ft}function bi(m,C){for(var B=m.length;B--;)if(is(m[B][0],C))return B;return-1}function ln(m,C,B){var ie=C(m);return ki(m)?ie:Le(ie,B(m))}function Ei(m){return m==null?m===void 0?ue:ge:Jt&&Jt in Object(m)?Zn(m):Ea(m)}function fn(m){return xi(m)&&Ei(m)==E}function Ii(m,C,B,ie,Ge){return m===C?!0:m==null||C==null||!xi(m)&&!xi(C)?m!==m&&C!==C:Gn(m,C,B,ie,Ii,Ge)}function Gn(m,C,B,ie,Ge,Ie){var et=ki(m),Ft=ki(C),Ne=et?x:Lr(m),We=Ft?x:Lr(C);Ne=Ne==E?ye:Ne,We=We==E?ye:We;var bt=Ne==ye,ir=We==ye,Dt=Ne==We;if(Dt&&pn(m)){if(!pn(C))return!1;et=!0,bt=!1}if(Dt&&!bt)return Ie||(Ie=new Ar),et||os(m)?Ui(m,C,B,ie,Ge,Ie):ba(m,C,Ne,B,ie,Ge,Ie);if(!(B&a)){var tt=bt&&Ue.call(m,"__wrapped__"),Yt=ir&&Ue.call(C,"__wrapped__");if(tt||Yt){var Tr=tt?m.value():m,_r=Yt?C.value():C;return Ie||(Ie=new Ar),Ge(Tr,_r,B,ie,Ie)}}return Dt?(Ie||(Ie=new Ar),Yn(m,C,B,ie,Ge,Ie)):!1}function wa(m){if(!as(m)||ts(m))return!1;var C=Ki(m)?Ht:me;return C.test(Br(m))}function Wn(m){return xi(m)&&ss(m.length)&&!!be[Ei(m)]}function Jn(m){if(!rs(m))return wi(m);var C=[];for(var B in Object(m))Ue.call(m,B)&&B!="constructor"&&C.push(B);return C}function Ui(m,C,B,ie,Ge,Ie){var et=B&a,Ft=m.length,Ne=C.length;if(Ft!=Ne&&!(et&&Ne>Ft))return!1;var We=Ie.get(m);if(We&&Ie.get(C))return We==C;var bt=-1,ir=!0,Dt=B&f?new qi:void 0;for(Ie.set(m,C),Ie.set(C,m);++bt<Ft;){var tt=m[bt],Yt=C[bt];if(ie)var Tr=et?ie(Yt,tt,bt,C,m,Ie):ie(tt,Yt,bt,m,C,Ie);if(Tr!==void 0){if(Tr)continue;ir=!1;break}if(Dt){if(!Te(C,function(_r,Mr){if(!st(Dt,Mr)&&(tt===_r||Ge(tt,_r,B,ie,Ie)))return Dt.push(Mr)})){ir=!1;break}}else if(!(tt===Yt||Ge(tt,Yt,B,ie,Ie))){ir=!1;break}}return Ie.delete(m),Ie.delete(C),ir}function ba(m,C,B,ie,Ge,Ie,et){switch(B){case _:if(m.byteLength!=C.byteLength||m.byteOffset!=C.byteOffset)return!1;m=m.buffer,C=C.buffer;case v:return!(m.byteLength!=C.byteLength||!Ie(new Wt(m),new Wt(C)));case U:case X:case oe:return is(+m,+C);case Q:return m.name==C.name&&m.message==C.message;case le:case K:return m==C+"";case Z:var Ft=Ze;case L:var Ne=ie&a;if(Ft||(Ft=at),m.size!=C.size&&!Ne)return!1;var We=et.get(m);if(We)return We==C;ie|=f,et.set(m,C);var bt=Ui(Ft(m),Ft(C),ie,Ge,Ie,et);return et.delete(m),bt;case F:if(yt)return yt.call(m)==yt.call(C)}return!1}function Yn(m,C,B,ie,Ge,Ie){var et=B&a,Ft=Hi(m),Ne=Ft.length,We=Hi(C),bt=We.length;if(Ne!=bt&&!et)return!1;for(var ir=Ne;ir--;){var Dt=Ft[ir];if(!(et?Dt in C:Ue.call(C,Dt)))return!1}var tt=Ie.get(m);if(tt&&Ie.get(C))return tt==C;var Yt=!0;Ie.set(m,C),Ie.set(C,m);for(var Tr=et;++ir<Ne;){Dt=Ft[ir];var _r=m[Dt],Mr=C[Dt];if(ie)var dn=et?ie(Mr,_r,Dt,C,m,Ie):ie(_r,Mr,Dt,m,C,Ie);if(!(dn===void 0?_r===Mr||Ge(_r,Mr,B,ie,Ie):dn)){Yt=!1;break}Tr||(Tr=Dt=="constructor")}if(Yt&&!Tr){var Si=m.constructor,qt=C.constructor;Si!=qt&&"constructor"in m&&"constructor"in C&&!(typeof Si=="function"&&Si instanceof Si&&typeof qt=="function"&&qt instanceof qt)&&(Yt=!1)}return Ie.delete(m),Ie.delete(C),Yt}function Hi(m){return ln(m,Sa,Xn)}function ni(m,C){var B=m.__data__;return es(C)?B[typeof C=="string"?"string":"hash"]:B.map}function ur(m,C){var B=ze(m,C);return wa(B)?B:void 0}function Zn(m){var C=Ue.call(m,Jt),B=m[Jt];try{m[Jt]=void 0;var ie=!0}catch{}var Ge=$t.call(m);return ie&&(C?m[Jt]=B:delete m[Jt]),Ge}var Xn=Kr?function(m){return m==null?[]:(m=Object(m),je(Kr(m),function(C){return rr.call(m,C)}))}:Be,Lr=Ei;(lt&&Lr(new lt(new ArrayBuffer(1)))!=_||rt&&Lr(new rt)!=Z||ft&&Lr(ft.resolve())!=fe||pt&&Lr(new pt)!=L||ot&&Lr(new ot)!=l)&&(Lr=function(m){var C=Ei(m),B=C==ye?m.constructor:void 0,ie=B?Br(B):"";if(ie)switch(ie){case Ct:return _;case At:return Z;case dt:return fe;case Tt:return L;case gt:return l}return C});function Qn(m,C){return C=C??w,!!C&&(typeof m=="number"||ut.test(m))&&m>-1&&m%1==0&&m<C}function es(m){var C=typeof m;return C=="string"||C=="number"||C=="symbol"||C=="boolean"?m!=="__proto__":m===null}function ts(m){return!!Ot&&Ot in m}function rs(m){var C=m&&m.constructor,B=typeof C=="function"&&C.prototype||$e;return m===B}function Ea(m){return $t.call(m)}function Br(m){if(m!=null){try{return ht.call(m)}catch{}try{return m+""}catch{}}return""}function is(m,C){return m===C||m!==m&&C!==C}var ns=fn(function(){return arguments}())?fn:function(m){return xi(m)&&Ue.call(m,"callee")&&!rr.call(m,"callee")},ki=Array.isArray;function Ia(m){return m!=null&&ss(m.length)&&!Ki(m)}var pn=ii||Ke;function xa(m,C){return Ii(m,C)}function Ki(m){if(!as(m))return!1;var C=Ei(m);return C==ee||C==V||C==N||C==he}function ss(m){return typeof m=="number"&&m>-1&&m%1==0&&m<=w}function as(m){var C=typeof m;return m!=null&&(C=="object"||C=="function")}function xi(m){return m!=null&&typeof m=="object"}var os=Pe?mt(Pe):Wn;function Sa(m){return Ia(m)?Bn(m):Jn(m)}function Be(){return[]}function Ke(){return!1}h.exports=xa})(Jo,Jo.exports);const d_=Jo.exports;function g_(h,i){if(h.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),s=0;s<r.length;s++)r[s]=255;for(var a=0;a<h.length;a++){var f=h.charAt(a),w=f.charCodeAt(0);if(r[w]!==255)throw new TypeError(f+" is ambiguous");r[w]=a}var E=h.length,x=h.charAt(0),N=Math.log(E)/Math.log(256),U=Math.log(256)/Math.log(E);function X(V){if(V instanceof Uint8Array||(ArrayBuffer.isView(V)?V=new Uint8Array(V.buffer,V.byteOffset,V.byteLength):Array.isArray(V)&&(V=Uint8Array.from(V))),!(V instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(V.length===0)return"";for(var Z=0,oe=0,ge=0,ye=V.length;ge!==ye&&V[ge]===0;)ge++,Z++;for(var fe=(ye-ge)*U+1>>>0,he=new Uint8Array(fe);ge!==ye;){for(var le=V[ge],L=0,K=fe-1;(le!==0||L<oe)&&K!==-1;K--,L++)le+=256*he[K]>>>0,he[K]=le%E>>>0,le=le/E>>>0;if(le!==0)throw new Error("Non-zero carry");oe=L,ge++}for(var F=fe-oe;F!==fe&&he[F]===0;)F++;for(var ue=x.repeat(Z);F<fe;++F)ue+=h.charAt(he[F]);return ue}function Q(V){if(typeof V!="string")throw new TypeError("Expected String");if(V.length===0)return new Uint8Array;var Z=0;if(V[Z]!==" "){for(var oe=0,ge=0;V[Z]===x;)oe++,Z++;for(var ye=(V.length-Z)*N+1>>>0,fe=new Uint8Array(ye);V[Z];){var he=r[V.charCodeAt(Z)];if(he===255)return;for(var le=0,L=ye-1;(he!==0||le<ge)&&L!==-1;L--,le++)he+=E*fe[L]>>>0,fe[L]=he%256>>>0,he=he/256>>>0;if(he!==0)throw new Error("Non-zero carry");ge=le,Z++}if(V[Z]!==" "){for(var K=ye-ge;K!==ye&&fe[K]===0;)K++;for(var F=new Uint8Array(oe+(ye-K)),ue=oe;K!==ye;)F[ue++]=fe[K++];return F}}}function ee(V){var Z=Q(V);if(Z)return Z;throw new Error(`Non-${i} character`)}return{encode:X,decodeUnsafe:Q,decode:ee}}var y_=g_,v_=y_;const jl=h=>{if(h instanceof Uint8Array&&h.constructor.name==="Uint8Array")return h;if(h instanceof ArrayBuffer)return new Uint8Array(h);if(ArrayBuffer.isView(h))return new Uint8Array(h.buffer,h.byteOffset,h.byteLength);throw new Error("Unknown type, must be binary type")},__=h=>new TextEncoder().encode(h),m_=h=>new TextDecoder().decode(h);class w_{constructor(i,r,s){this.name=i,this.prefix=r,this.baseEncode=s}encode(i){if(i instanceof Uint8Array)return`${this.prefix}${this.baseEncode(i)}`;throw Error("Unknown type, must be binary type")}}class b_{constructor(i,r,s){if(this.name=i,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=s}decode(i){if(typeof i=="string"){if(i.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(i)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(i.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(i){return $l(this,i)}}class E_{constructor(i){this.decoders=i}or(i){return $l(this,i)}decode(i){const r=i[0],s=this.decoders[r];if(s)return s.decode(i);throw RangeError(`Unable to decode multibase string ${JSON.stringify(i)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const $l=(h,i)=>new E_({...h.decoders||{[h.prefix]:h},...i.decoders||{[i.prefix]:i}});class I_{constructor(i,r,s,a){this.name=i,this.prefix=r,this.baseEncode=s,this.baseDecode=a,this.encoder=new w_(i,r,s),this.decoder=new b_(i,r,a)}encode(i){return this.encoder.encode(i)}decode(i){return this.decoder.decode(i)}}const ia=({name:h,prefix:i,encode:r,decode:s})=>new I_(h,i,r,s),Hn=({prefix:h,name:i,alphabet:r})=>{const{encode:s,decode:a}=v_(r,i);return ia({prefix:h,name:i,encode:s,decode:f=>jl(a(f))})},x_=(h,i,r,s)=>{const a={};for(let U=0;U<i.length;++U)a[i[U]]=U;let f=h.length;for(;h[f-1]==="=";)--f;const w=new Uint8Array(f*r/8|0);let E=0,x=0,N=0;for(let U=0;U<f;++U){const X=a[h[U]];if(X===void 0)throw new SyntaxError(`Non-${s} character`);x=x<<r|X,E+=r,E>=8&&(E-=8,w[N++]=255&x>>E)}if(E>=r||255&x<<8-E)throw new SyntaxError("Unexpected end of data");return w},S_=(h,i,r)=>{const s=i[i.length-1]==="=",a=(1<<r)-1;let f="",w=0,E=0;for(let x=0;x<h.length;++x)for(E=E<<8|h[x],w+=8;w>r;)w-=r,f+=i[a&E>>w];if(w&&(f+=i[a&E<<r-w]),s)for(;f.length*r&7;)f+="=";return f},Vt=({name:h,prefix:i,bitsPerChar:r,alphabet:s})=>ia({prefix:i,name:h,encode(a){return S_(a,s,r)},decode(a){return x_(a,s,r,h)}}),P_=ia({prefix:"\0",name:"identity",encode:h=>m_(h),decode:h=>__(h)});var O_=Object.freeze({__proto__:null,identity:P_});const C_=Vt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var A_=Object.freeze({__proto__:null,base2:C_});const T_=Vt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var R_=Object.freeze({__proto__:null,base8:T_});const N_=Hn({prefix:"9",name:"base10",alphabet:"0123456789"});var F_=Object.freeze({__proto__:null,base10:N_});const D_=Vt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),j_=Vt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var $_=Object.freeze({__proto__:null,base16:D_,base16upper:j_});const L_=Vt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),M_=Vt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),z_=Vt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),q_=Vt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),U_=Vt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),H_=Vt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),k_=Vt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),K_=Vt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),V_=Vt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var B_=Object.freeze({__proto__:null,base32:L_,base32upper:M_,base32pad:z_,base32padupper:q_,base32hex:U_,base32hexupper:H_,base32hexpad:k_,base32hexpadupper:K_,base32z:V_});const G_=Hn({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),W_=Hn({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var J_=Object.freeze({__proto__:null,base36:G_,base36upper:W_});const Y_=Hn({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Z_=Hn({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var X_=Object.freeze({__proto__:null,base58btc:Y_,base58flickr:Z_});const Q_=Vt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),em=Vt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),tm=Vt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),rm=Vt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var im=Object.freeze({__proto__:null,base64:Q_,base64pad:em,base64url:tm,base64urlpad:rm});const Ll=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),nm=Ll.reduce((h,i,r)=>(h[r]=i,h),[]),sm=Ll.reduce((h,i,r)=>(h[i.codePointAt(0)]=r,h),[]);function am(h){return h.reduce((i,r)=>(i+=nm[r],i),"")}function om(h){const i=[];for(const r of h){const s=sm[r.codePointAt(0)];if(s===void 0)throw new Error(`Non-base256emoji character: ${r}`);i.push(s)}return new Uint8Array(i)}const cm=ia({prefix:"\u{1F680}",name:"base256emoji",encode:am,decode:om});var um=Object.freeze({__proto__:null,base256emoji:cm}),hm=Ml,qh=128,lm=127,fm=~lm,pm=Math.pow(2,31);function Ml(h,i,r){i=i||[],r=r||0;for(var s=r;h>=pm;)i[r++]=h&255|qh,h/=128;for(;h&fm;)i[r++]=h&255|qh,h>>>=7;return i[r]=h|0,Ml.bytes=r-s+1,i}var dm=Yo,gm=128,Uh=127;function Yo(h,s){var r=0,s=s||0,a=0,f=s,w,E=h.length;do{if(f>=E)throw Yo.bytes=0,new RangeError("Could not decode varint");w=h[f++],r+=a<28?(w&Uh)<<a:(w&Uh)*Math.pow(2,a),a+=7}while(w>=gm);return Yo.bytes=f-s,r}var ym=Math.pow(2,7),vm=Math.pow(2,14),_m=Math.pow(2,21),mm=Math.pow(2,28),wm=Math.pow(2,35),bm=Math.pow(2,42),Em=Math.pow(2,49),Im=Math.pow(2,56),xm=Math.pow(2,63),Sm=function(h){return h<ym?1:h<vm?2:h<_m?3:h<mm?4:h<wm?5:h<bm?6:h<Em?7:h<Im?8:h<xm?9:10},Pm={encode:hm,decode:dm,encodingLength:Sm},zl=Pm;const Hh=(h,i,r=0)=>(zl.encode(h,i,r),i),kh=h=>zl.encodingLength(h),Zo=(h,i)=>{const r=i.byteLength,s=kh(h),a=s+kh(r),f=new Uint8Array(a+r);return Hh(h,f,0),Hh(r,f,s),f.set(i,a),new Om(h,r,i,f)};class Om{constructor(i,r,s,a){this.code=i,this.size=r,this.digest=s,this.bytes=a}}const ql=({name:h,code:i,encode:r})=>new Cm(h,i,r);class Cm{constructor(i,r,s){this.name=i,this.code=r,this.encode=s}digest(i){if(i instanceof Uint8Array){const r=this.encode(i);return r instanceof Uint8Array?Zo(this.code,r):r.then(s=>Zo(this.code,s))}else throw Error("Unknown type, must be binary type")}}const Ul=h=>async i=>new Uint8Array(await crypto.subtle.digest(h,i)),Am=ql({name:"sha2-256",code:18,encode:Ul("SHA-256")}),Tm=ql({name:"sha2-512",code:19,encode:Ul("SHA-512")});var Rm=Object.freeze({__proto__:null,sha256:Am,sha512:Tm});const Hl=0,Nm="identity",kl=jl,Fm=h=>Zo(Hl,kl(h)),Dm={code:Hl,name:Nm,encode:kl,digest:Fm};var jm=Object.freeze({__proto__:null,identity:Dm});new TextEncoder,new TextDecoder;const Kh={...O_,...A_,...R_,...F_,...$_,...B_,...J_,...X_,...im,...um};({...Rm,...jm});function Kl(h){return globalThis.Buffer!=null?new Uint8Array(h.buffer,h.byteOffset,h.byteLength):h}function $m(h=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Kl(globalThis.Buffer.allocUnsafe(h)):new Uint8Array(h)}function Vl(h,i,r,s){return{name:h,prefix:i,encoder:{name:h,prefix:i,encode:r},decoder:{decode:s}}}const Vh=Vl("utf8","u",h=>"u"+new TextDecoder("utf8").decode(h),h=>new TextEncoder().encode(h.substring(1))),Lo=Vl("ascii","a",h=>{let i="a";for(let r=0;r<h.length;r++)i+=String.fromCharCode(h[r]);return i},h=>{h=h.substring(1);const i=$m(h.length);for(let r=0;r<h.length;r++)i[r]=h.charCodeAt(r);return i}),Lm={utf8:Vh,"utf-8":Vh,hex:Kh.base16,latin1:Lo,ascii:Lo,binary:Lo,...Kh};function Mm(h,i="utf8"){const r=Lm[i];if(!r)throw new Error(`Unsupported encoding "${i}"`);return(i==="utf8"||i==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Kl(globalThis.Buffer.from(h,"utf-8")):r.decoder.decode(`${r.prefix}${h}`)}const Bl="wc",zm=2,fc="core",vi=`${Bl}@2:${fc}:`,qm={name:fc,logger:"error"},Um={database:":memory:"},Hm="crypto",Bh="client_ed25519_seed",km=de.ONE_DAY,Km="keychain",Vm="0.3",Bm="messages",Gm="0.3",Wm=de.SIX_HOURS,Jm="publisher",Gl="irn",Ym="error",Wl="wss://relay.walletconnect.com",Gh="wss://relay.walletconnect.org",Zm="relayer",_t={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},Xm="_subscription",jn={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},Qm=de.ONE_SECOND/2,ew="2.8.6",tw=1e4,rw="0.3",iw="WALLETCONNECT_CLIENT_ID",kr={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},nw="subscription",sw="0.3",aw=de.FIVE_SECONDS*1e3,ow="pairing",cw="0.3",$n={wc_pairingDelete:{req:{ttl:de.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:de.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:de.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:de.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:de.ONE_DAY,prompt:!1,tag:0},res:{ttl:de.ONE_DAY,prompt:!1,tag:0}}},Hr={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},uw="history",hw="0.3",lw="expirer",Or={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},fw="0.3",Mo="verify-api",Wh="https://verify.walletconnect.com";class pw{constructor(i,r){this.core=i,this.logger=r,this.keychain=new Map,this.name=Km,this.version=Vm,this.initialized=!1,this.storagePrefix=vi,this.init=async()=>{if(!this.initialized){const s=await this.getKeyChain();typeof s<"u"&&(this.keychain=s),this.initialized=!0}},this.has=s=>(this.isInitialized(),this.keychain.has(s)),this.set=async(s,a)=>{this.isInitialized(),this.keychain.set(s,a),await this.persist()},this.get=s=>{this.isInitialized();const a=this.keychain.get(s);if(typeof a>"u"){const{message:f}=se("NO_MATCHING_KEY",`${this.name}: ${s}`);throw new Error(f)}return a},this.del=async s=>{this.isInitialized(),this.keychain.delete(s),await this.persist()},this.core=i,this.logger=De.generateChildLogger(r,this.name)}get context(){return De.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setKeyChain(i){await this.core.storage.setItem(this.storageKey,El(i))}async getKeyChain(){const i=await this.core.storage.getItem(this.storageKey);return typeof i<"u"?Il(i):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:i}=se("NOT_INITIALIZED",this.name);throw new Error(i)}}}class dw{constructor(i,r,s){this.core=i,this.logger=r,this.name=Hm,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=a=>(this.isInitialized(),this.keychain.has(a)),this.getClientId=async()=>{this.isInitialized();const a=await this.getClientSeed(),f=Lh(a);return Dl(f.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const a=Lv();return this.setPrivateKey(a.publicKey,a.privateKey)},this.signJWT=async a=>{this.isInitialized();const f=await this.getClientSeed(),w=Lh(f),E=Go();return await u_(E,a,km,w)},this.generateSharedKey=(a,f,w)=>{this.isInitialized();const E=this.getPrivateKey(a),x=Mv(E,f);return this.setSymKey(x,w)},this.setSymKey=async(a,f)=>{this.isInitialized();const w=f||zv(a);return await this.keychain.set(w,a),w},this.deleteKeyPair=async a=>{this.isInitialized(),await this.keychain.del(a)},this.deleteSymKey=async a=>{this.isInitialized(),await this.keychain.del(a)},this.encode=async(a,f,w)=>{this.isInitialized();const E=qv(w),x=nc(f);if(vh(E)){const Q=E.senderPublicKey,ee=E.receiverPublicKey;a=await this.generateSharedKey(Q,ee)}const N=this.getSymKey(a),{type:U,senderPublicKey:X}=E;return Uv({type:U,symKey:N,message:x,senderPublicKey:X})},this.decode=async(a,f,w)=>{this.isInitialized();const E=Hv(f,w);if(vh(E)){const U=E.receiverPublicKey,X=E.senderPublicKey;a=await this.generateSharedKey(U,X)}const x=this.getSymKey(a),N=kv({symKey:x,encoded:f});return xl(N)},this.getPayloadType=a=>{const f=_h(a);return Kv(f.type)},this.getPayloadSenderPublicKey=a=>{const f=_h(a);return f.senderPublicKey?ta(f.senderPublicKey,Vv):void 0},this.core=i,this.logger=De.generateChildLogger(r,this.name),this.keychain=s||new pw(this.core,this.logger)}get context(){return De.getLoggerContext(this.logger)}async setPrivateKey(i,r){return await this.keychain.set(i,r),i}getPrivateKey(i){return this.keychain.get(i)}async getClientSeed(){let i="";try{i=this.keychain.get(Bh)}catch{i=Go(),await this.keychain.set(Bh,i)}return Mm(i,"base16")}getSymKey(i){return this.keychain.get(i)}isInitialized(){if(!this.initialized){const{message:i}=se("NOT_INITIALIZED",this.name);throw new Error(i)}}}class gw extends U1{constructor(i,r){super(i,r),this.logger=i,this.core=r,this.messages=new Map,this.name=Bm,this.version=Gm,this.initialized=!1,this.storagePrefix=vi,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const s=await this.getRelayerMessages();typeof s<"u"&&(this.messages=s),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(s){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(s)}finally{this.initialized=!0}}},this.set=async(s,a)=>{this.isInitialized();const f=cn(a);let w=this.messages.get(s);return typeof w>"u"&&(w={}),typeof w[f]<"u"||(w[f]=a,this.messages.set(s,w),await this.persist()),f},this.get=s=>{this.isInitialized();let a=this.messages.get(s);return typeof a>"u"&&(a={}),a},this.has=(s,a)=>{this.isInitialized();const f=this.get(s),w=cn(a);return typeof f[w]<"u"},this.del=async s=>{this.isInitialized(),this.messages.delete(s),await this.persist()},this.logger=De.generateChildLogger(i,this.name),this.core=r}get context(){return De.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setRelayerMessages(i){await this.core.storage.setItem(this.storageKey,El(i))}async getRelayerMessages(){const i=await this.core.storage.getItem(this.storageKey);return typeof i<"u"?Il(i):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:i}=se("NOT_INITIALIZED",this.name);throw new Error(i)}}}class yw extends H1{constructor(i,r){super(i,r),this.relayer=i,this.logger=r,this.events=new yr.exports.EventEmitter,this.name=Jm,this.queue=new Map,this.publishTimeout=de.toMiliseconds(de.TEN_SECONDS),this.queueTimeout=de.toMiliseconds(de.FIVE_SECONDS),this.needsTransportRestart=!1,this.publish=async(s,a,f)=>{this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:s,message:a,opts:f}});try{const w=f?.ttl||Wm,E=Wo(f),x=f?.prompt||!1,N=f?.tag||0,U=f?.id||Sl().toString(),X={topic:s,message:a,opts:{ttl:w,relay:E,prompt:x,tag:N,id:U}},Q=setTimeout(()=>this.queue.set(U,X),this.queueTimeout);try{await await Qs(this.rpcPublish(s,a,w,E,x,N,U),this.publishTimeout),clearTimeout(Q),this.relayer.events.emit(_t.publish,X)}catch{this.logger.debug("Publishing Payload stalled"),this.needsTransportRestart=!0;return}this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:s,message:a,opts:f}})}catch(w){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(w),w}},this.on=(s,a)=>{this.events.on(s,a)},this.once=(s,a)=>{this.events.once(s,a)},this.off=(s,a)=>{this.events.off(s,a)},this.removeListener=(s,a)=>{this.events.removeListener(s,a)},this.relayer=i,this.logger=De.generateChildLogger(r,this.name),this.registerEventListeners()}get context(){return De.getLoggerContext(this.logger)}rpcPublish(i,r,s,a,f,w,E){var x,N,U,X;const Q={method:Ys(a.protocol).publish,params:{topic:i,message:r,ttl:s,prompt:f,tag:w},id:E};return yi((x=Q.params)==null?void 0:x.prompt)&&((N=Q.params)==null||delete N.prompt),yi((U=Q.params)==null?void 0:U.tag)&&((X=Q.params)==null||delete X.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:Q}),this.relayer.request(Q)}onPublish(i){this.queue.delete(i)}checkQueue(){this.queue.forEach(async i=>{const{topic:r,message:s,opts:a}=i;await this.publish(r,s,a)})}registerEventListeners(){this.relayer.core.heartbeat.on(hn.HEARTBEAT_EVENTS.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(_t.connection_stalled);return}this.checkQueue()}),this.relayer.on(_t.message_ack,i=>{this.onPublish(i.id.toString())})}}class vw{constructor(){this.map=new Map,this.set=(i,r)=>{const s=this.get(i);this.exists(i,r)||this.map.set(i,[...s,r])},this.get=i=>this.map.get(i)||[],this.exists=(i,r)=>this.get(i).includes(r),this.delete=(i,r)=>{if(typeof r>"u"){this.map.delete(i);return}if(!this.map.has(i))return;const s=this.get(i);if(!this.exists(i,r))return;const a=s.filter(f=>f!==r);if(!a.length){this.map.delete(i);return}this.map.set(i,a)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var _w=Object.defineProperty,mw=Object.defineProperties,ww=Object.getOwnPropertyDescriptors,Jh=Object.getOwnPropertySymbols,bw=Object.prototype.hasOwnProperty,Ew=Object.prototype.propertyIsEnumerable,Yh=(h,i,r)=>i in h?_w(h,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):h[i]=r,Ln=(h,i)=>{for(var r in i||(i={}))bw.call(i,r)&&Yh(h,r,i[r]);if(Jh)for(var r of Jh(i))Ew.call(i,r)&&Yh(h,r,i[r]);return h},zo=(h,i)=>mw(h,ww(i));class Iw extends V1{constructor(i,r){super(i,r),this.relayer=i,this.logger=r,this.subscriptions=new Map,this.topicMap=new vw,this.events=new yr.exports.EventEmitter,this.name=nw,this.version=sw,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=vi,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restart(),this.registerEventListeners(),this.onEnable(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(s,a)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:s,opts:a}});try{const f=Wo(a),w={topic:s,relay:f};this.pending.set(s,w);const E=await this.rpcSubscribe(s,f);return this.onSubscribe(E,w),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:s,opts:a}}),E}catch(f){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(f),f}},this.unsubscribe=async(s,a)=>{await this.restartToComplete(),this.isInitialized(),typeof a?.id<"u"?await this.unsubscribeById(s,a.id,a):await this.unsubscribeByTopic(s,a)},this.isSubscribed=async s=>this.topics.includes(s)?!0:await new Promise((a,f)=>{const w=new de.Watch;w.start(this.pendingSubscriptionWatchLabel);const E=setInterval(()=>{!this.pending.has(s)&&this.topics.includes(s)&&(clearInterval(E),w.stop(this.pendingSubscriptionWatchLabel),a(!0)),w.elapsed(this.pendingSubscriptionWatchLabel)>=aw&&(clearInterval(E),w.stop(this.pendingSubscriptionWatchLabel),f(new Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1),this.on=(s,a)=>{this.events.on(s,a)},this.once=(s,a)=>{this.events.once(s,a)},this.off=(s,a)=>{this.events.off(s,a)},this.removeListener=(s,a)=>{this.events.removeListener(s,a)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=i,this.logger=De.generateChildLogger(r,this.name),this.clientId=""}get context(){return De.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(i,r){let s=!1;try{s=this.getSubscription(i).topic===r}catch{}return s}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(i,r){const s=this.topicMap.get(i);await Promise.all(s.map(async a=>await this.unsubscribeById(i,a,r)))}async unsubscribeById(i,r,s){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:i,id:r,opts:s}});try{const a=Wo(s);await this.rpcUnsubscribe(i,r,a);const f=tr("USER_DISCONNECTED",`${this.name}, ${i}`);await this.onUnsubscribe(i,r,f),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:i,id:r,opts:s}})}catch(a){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(a),a}}async rpcSubscribe(i,r){const s={method:Ys(r.protocol).subscribe,params:{topic:i}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{await await Qs(this.relayer.request(s),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(_t.connection_stalled)}return cn(i+this.clientId)}async rpcBatchSubscribe(i){if(!i.length)return;const r=i[0].relay,s={method:Ys(r.protocol).batchSubscribe,params:{topics:i.map(a=>a.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{return await await Qs(this.relayer.request(s),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(_t.connection_stalled)}}rpcUnsubscribe(i,r,s){const a={method:Ys(s.protocol).unsubscribe,params:{topic:i,id:r}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:a}),this.relayer.request(a)}onSubscribe(i,r){this.setSubscription(i,zo(Ln({},r),{id:i})),this.pending.delete(r.topic)}onBatchSubscribe(i){i.length&&i.forEach(r=>{this.setSubscription(r.id,Ln({},r)),this.pending.delete(r.topic)})}async onUnsubscribe(i,r,s){this.events.removeAllListeners(r),this.hasSubscription(r,i)&&this.deleteSubscription(r,s),await this.relayer.messages.del(i)}async setRelayerSubscriptions(i){await this.relayer.core.storage.setItem(this.storageKey,i)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(i,r){this.subscriptions.has(i)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:i,subscription:r}),this.addSubscription(i,r))}addSubscription(i,r){this.subscriptions.set(i,Ln({},r)),this.topicMap.set(r.topic,i),this.events.emit(kr.created,r)}getSubscription(i){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:i});const r=this.subscriptions.get(i);if(!r){const{message:s}=se("NO_MATCHING_KEY",`${this.name}: ${i}`);throw new Error(s)}return r}deleteSubscription(i,r){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:i,reason:r});const s=this.getSubscription(i);this.subscriptions.delete(i),this.topicMap.delete(s.topic,i),this.events.emit(kr.deleted,zo(Ln({},s),{reason:r}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(kr.sync)}async reset(){if(this.cached.length){const i=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let r=0;r<i;r++){const s=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(s)}}this.events.emit(kr.resubscribed)}async restore(){try{const i=await this.getRelayerSubscriptions();if(typeof i>"u"||!i.length)return;if(this.subscriptions.size){const{message:r}=se("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(r)}this.cached=i,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(i){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(i)}}async batchSubscribe(i){if(!i.length)return;const r=await this.rpcBatchSubscribe(i);un(r)&&this.onBatchSubscribe(r.map((s,a)=>zo(Ln({},i[a]),{id:s})))}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}async checkPending(){if(this.relayer.transportExplicitlyClosed)return;const i=[];this.pending.forEach(r=>{i.push(r)}),await this.batchSubscribe(i)}registerEventListeners(){this.relayer.core.heartbeat.on(hn.HEARTBEAT_EVENTS.pulse,async()=>{await this.checkPending()}),this.relayer.on(_t.connect,async()=>{await this.onConnect()}),this.relayer.on(_t.disconnect,()=>{this.onDisconnect()}),this.events.on(kr.created,async i=>{const r=kr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:i}),await this.persist()}),this.events.on(kr.deleted,async i=>{const r=kr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:i}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:i}=se("NOT_INITIALIZED",this.name);throw new Error(i)}}async restartToComplete(){this.restartInProgress&&await new Promise(i=>{const r=setInterval(()=>{this.restartInProgress||(clearInterval(r),i())},this.pollingInterval)})}}var xw=Object.defineProperty,Zh=Object.getOwnPropertySymbols,Sw=Object.prototype.hasOwnProperty,Pw=Object.prototype.propertyIsEnumerable,Xh=(h,i,r)=>i in h?xw(h,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):h[i]=r,Ow=(h,i)=>{for(var r in i||(i={}))Sw.call(i,r)&&Xh(h,r,i[r]);if(Zh)for(var r of Zh(i))Pw.call(i,r)&&Xh(h,r,i[r]);return h};class Cw extends k1{constructor(i){super(i),this.protocol="wc",this.version=2,this.events=new yr.exports.EventEmitter,this.name=Zm,this.transportExplicitlyClosed=!1,this.initialized=!1,this.reconnecting=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","socket stalled"],this.request=async r=>{this.logger.debug("Publishing Request Payload");try{return await this.toEstablishConnection(),await this.provider.request(r)}catch(s){throw this.logger.debug("Failed to Publish Request"),this.logger.error(s),s}},this.core=i.core,this.logger=typeof i.logger<"u"&&typeof i.logger!="string"?De.generateChildLogger(i.logger,this.name):De.pino(De.getDefaultLoggerOptions({level:i.logger||Ym})),this.messages=new gw(this.logger,i.core),this.subscriber=new Iw(this,this.logger),this.publisher=new yw(this,this.logger),this.relayUrl=i?.relayUrl||Wl,this.projectId=i.projectId,this.provider={}}async init(){this.logger.trace("Initialized"),await this.createProvider(),await Promise.all([this.messages.init(),this.subscriber.init()]);try{await this.transportOpen()}catch{this.logger.warn(`Connection via ${this.relayUrl} failed, attempting to connect via failover domain ${Gh}...`),await this.restartTransport(Gh)}this.registerEventListeners(),this.initialized=!0,setTimeout(async()=>{this.subscriber.topics.length===0&&(this.logger.info("No topics subscribed to after init, closing transport"),await this.transportClose(),this.transportExplicitlyClosed=!1)},tw)}get context(){return De.getLoggerContext(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(i,r,s){this.isInitialized(),await this.publisher.publish(i,r,s),await this.recordMessageEvent({topic:i,message:r,publishedAt:Date.now()})}async subscribe(i,r){var s;this.isInitialized();let a=((s=this.subscriber.topicMap.get(i))==null?void 0:s[0])||"";return a||(await Promise.all([new Promise(f=>{this.subscriber.once(kr.created,w=>{w.topic===i&&f()})}),new Promise(async f=>{a=await this.subscriber.subscribe(i,r),f()})]),a)}async unsubscribe(i,r){this.isInitialized(),await this.subscriber.unsubscribe(i,r)}on(i,r){this.events.on(i,r)}once(i,r){this.events.once(i,r)}off(i,r){this.events.off(i,r)}removeListener(i,r){this.events.removeListener(i,r)}async transportClose(){this.transportExplicitlyClosed=!0,this.connected&&(await this.provider.disconnect(),this.events.emit(_t.transport_closed))}async transportOpen(i){if(this.transportExplicitlyClosed=!1,!this.reconnecting){this.relayUrl=i||this.relayUrl,this.reconnecting=!0;try{await Promise.all([new Promise(r=>{this.initialized||r(),this.subscriber.once(kr.resubscribed,()=>{r()})}),await Promise.race([new Promise(async(r,s)=>{await Qs(this.provider.connect(),5e3,`Socket stalled when trying to connect to ${this.relayUrl}`).catch(a=>s(a)).then(()=>r()).finally(()=>this.removeListener(_t.transport_closed,this.rejectTransportOpen))}),new Promise(r=>this.once(_t.transport_closed,this.rejectTransportOpen))])])}catch(r){this.logger.error(r);const s=r;if(!this.isConnectionStalled(s.message))throw r;this.events.emit(_t.transport_closed)}finally{this.reconnecting=!1}}}async restartTransport(i){this.transportExplicitlyClosed||this.reconnecting||(this.relayUrl=i||this.relayUrl,this.connected&&await Promise.all([new Promise(r=>{this.provider.once(jn.disconnect,()=>{r()})}),this.transportClose()]),await this.createProvider(),await this.transportOpen())}isConnectionStalled(i){return this.staleConnectionErrors.some(r=>i.includes(r))}rejectTransportOpen(){throw new Error("Attempt to connect to relay via `transportOpen` has stalled. Retrying...")}async createProvider(){const i=await this.core.crypto.signJWT(this.relayUrl);this.provider=new _i(new p_(Bv({sdkVersion:ew,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:i,useOnCloseEvent:!0}))),this.registerProviderListeners()}async recordMessageEvent(i){const{topic:r,message:s}=i;await this.messages.set(r,s)}async shouldIgnoreMessageEvent(i){const{topic:r,message:s}=i;return await this.subscriber.isSubscribed(r)?this.messages.has(r,s):!0}async onProviderPayload(i){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:i}),ac(i)){if(!i.method.endsWith(Xm))return;const r=i.params,{topic:s,message:a,publishedAt:f}=r.data,w={topic:s,message:a,publishedAt:f};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(Ow({type:"event",event:r.id},w)),this.events.emit(r.id,w),await this.acknowledgePayload(i),await this.onMessageEvent(w)}else oc(i)&&this.events.emit(_t.message_ack,i)}async onMessageEvent(i){await this.shouldIgnoreMessageEvent(i)||(this.events.emit(_t.message,i),await this.recordMessageEvent(i))}async acknowledgePayload(i){const r=cc(i.id,!0);await this.provider.connection.send(r)}registerProviderListeners(){this.provider.on(jn.payload,i=>this.onProviderPayload(i)),this.provider.on(jn.connect,()=>{this.events.emit(_t.connect)}),this.provider.on(jn.disconnect,()=>{this.onProviderDisconnect()}),this.provider.on(jn.error,i=>{this.logger.error(i),this.events.emit(_t.error,i)})}registerEventListeners(){this.events.on(_t.connection_stalled,async()=>{await this.restartTransport()})}onProviderDisconnect(){this.events.emit(_t.disconnect),this.attemptToReconnect()}attemptToReconnect(){this.transportExplicitlyClosed||setTimeout(async()=>{await this.restartTransport()},de.toMiliseconds(Qm))}isInitialized(){if(!this.initialized){const{message:i}=se("NOT_INITIALIZED",this.name);throw new Error(i)}}async toEstablishConnection(){if(!this.connected){if(this.connecting)return await new Promise(i=>{const r=setInterval(()=>{this.connected&&(clearInterval(r),i())},this.connectionStatusPollingInterval)});await this.restartTransport()}}}var Aw=Object.defineProperty,Qh=Object.getOwnPropertySymbols,Tw=Object.prototype.hasOwnProperty,Rw=Object.prototype.propertyIsEnumerable,el=(h,i,r)=>i in h?Aw(h,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):h[i]=r,tl=(h,i)=>{for(var r in i||(i={}))Tw.call(i,r)&&el(h,r,i[r]);if(Qh)for(var r of Qh(i))Rw.call(i,r)&&el(h,r,i[r]);return h};class na extends K1{constructor(i,r,s,a=vi,f=void 0){super(i,r,s,a),this.core=i,this.logger=r,this.name=s,this.map=new Map,this.version=rw,this.cached=[],this.initialized=!1,this.storagePrefix=vi,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(w=>{this.getKey&&w!==null&&!yi(w)?this.map.set(this.getKey(w),w):jv(w)?this.map.set(w.id,w):$v(w)&&this.map.set(w.topic,w)}),this.cached=[],this.initialized=!0)},this.set=async(w,E)=>{this.isInitialized(),this.map.has(w)?await this.update(w,E):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:w,value:E}),this.map.set(w,E),await this.persist())},this.get=w=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:w}),this.getData(w)),this.getAll=w=>(this.isInitialized(),w?this.values.filter(E=>Object.keys(w).every(x=>d_(E[x],w[x]))):this.values),this.update=async(w,E)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:w,update:E});const x=tl(tl({},this.getData(w)),E);this.map.set(w,x),await this.persist()},this.delete=async(w,E)=>{this.isInitialized(),this.map.has(w)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:w,reason:E}),this.map.delete(w),await this.persist())},this.logger=De.generateChildLogger(r,this.name),this.storagePrefix=a,this.getKey=f}get context(){return De.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(i){await this.core.storage.setItem(this.storageKey,i)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(i){const r=this.map.get(i);if(!r){const{message:s}=se("NO_MATCHING_KEY",`${this.name}: ${i}`);throw this.logger.error(s),new Error(s)}return r}async persist(){await this.setDataStore(this.values)}async restore(){try{const i=await this.getDataStore();if(typeof i>"u"||!i.length)return;if(this.map.size){const{message:r}=se("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=i,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(i){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(i)}}isInitialized(){if(!this.initialized){const{message:i}=se("NOT_INITIALIZED",this.name);throw new Error(i)}}}class Nw{constructor(i,r){this.core=i,this.logger=r,this.name=ow,this.version=cw,this.events=new yr.exports,this.initialized=!1,this.storagePrefix=vi,this.ignoredPayloadTypes=[ml],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:s})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...s])]},this.create=async()=>{this.isInitialized();const s=Go(),a=await this.core.crypto.setSymKey(s),f=jr(de.FIVE_MINUTES),w={protocol:Gl},E={topic:a,expiry:f,relay:w,active:!1},x=Gv({protocol:this.core.protocol,version:this.core.version,topic:a,symKey:s,relay:w});return await this.pairings.set(a,E),await this.core.relayer.subscribe(a),this.core.expirer.set(a,f),{topic:a,uri:x}},this.pair=async s=>{this.isInitialized(),this.isValidPair(s);const{topic:a,symKey:f,relay:w}=Wv(s.uri);if(this.pairings.keys.includes(a))throw new Error(`Pairing already exists: ${a}`);if(this.core.crypto.hasKeys(a))throw new Error(`Keychain already exists: ${a}`);const E=jr(de.FIVE_MINUTES),x={topic:a,relay:w,expiry:E,active:!1};return await this.pairings.set(a,x),await this.core.crypto.setSymKey(f,a),await this.core.relayer.subscribe(a,{relay:w}),this.core.expirer.set(a,E),s.activatePairing&&await this.activate({topic:a}),x},this.activate=async({topic:s})=>{this.isInitialized();const a=jr(de.THIRTY_DAYS);await this.pairings.update(s,{active:!0,expiry:a}),this.core.expirer.set(s,a)},this.ping=async s=>{this.isInitialized(),await this.isValidPing(s);const{topic:a}=s;if(this.pairings.keys.includes(a)){const f=await this.sendRequest(a,"wc_pairingPing",{}),{done:w,resolve:E,reject:x}=sn();this.events.once(jt("pairing_ping",f),({error:N})=>{N?x(N):E()}),await w()}},this.updateExpiry=async({topic:s,expiry:a})=>{this.isInitialized(),await this.pairings.update(s,{expiry:a})},this.updateMetadata=async({topic:s,metadata:a})=>{this.isInitialized(),await this.pairings.update(s,{peerMetadata:a})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async s=>{this.isInitialized(),await this.isValidDisconnect(s);const{topic:a}=s;this.pairings.keys.includes(a)&&(await this.sendRequest(a,"wc_pairingDelete",tr("USER_DISCONNECTED")),await this.deletePairing(a))},this.sendRequest=async(s,a,f)=>{const w=uc(a,f),E=await this.core.crypto.encode(s,w),x=$n[a].req;return this.core.history.set(s,w),this.core.relayer.publish(s,E,x),w.id},this.sendResult=async(s,a,f)=>{const w=cc(s,f),E=await this.core.crypto.encode(a,w),x=await this.core.history.get(a,s),N=$n[x.request.method].res;await this.core.relayer.publish(a,E,N),await this.core.history.resolve(w)},this.sendError=async(s,a,f)=>{const w=sc(s,f),E=await this.core.crypto.encode(a,w),x=await this.core.history.get(a,s),N=$n[x.request.method]?$n[x.request.method].res:$n.unregistered_method.res;await this.core.relayer.publish(a,E,N),await this.core.history.resolve(w)},this.deletePairing=async(s,a)=>{await this.core.relayer.unsubscribe(s),await Promise.all([this.pairings.delete(s,tr("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(s),a?Promise.resolve():this.core.expirer.del(s)])},this.cleanup=async()=>{const s=this.pairings.getAll().filter(a=>gi(a.expiry));await Promise.all(s.map(a=>this.deletePairing(a.topic)))},this.onRelayEventRequest=s=>{const{topic:a,payload:f}=s,w=f.method;if(this.pairings.keys.includes(a))switch(w){case"wc_pairingPing":return this.onPairingPingRequest(a,f);case"wc_pairingDelete":return this.onPairingDeleteRequest(a,f);default:return this.onUnknownRpcMethodRequest(a,f)}},this.onRelayEventResponse=async s=>{const{topic:a,payload:f}=s,w=(await this.core.history.get(a,f.id)).request.method;if(this.pairings.keys.includes(a))switch(w){case"wc_pairingPing":return this.onPairingPingResponse(a,f);default:return this.onUnknownRpcMethodResponse(w)}},this.onPairingPingRequest=async(s,a)=>{const{id:f}=a;try{this.isValidPing({topic:s}),await this.sendResult(f,s,!0),this.events.emit("pairing_ping",{id:f,topic:s})}catch(w){await this.sendError(f,s,w),this.logger.error(w)}},this.onPairingPingResponse=(s,a)=>{const{id:f}=a;setTimeout(()=>{di(a)?this.events.emit(jt("pairing_ping",f),{}):ri(a)&&this.events.emit(jt("pairing_ping",f),{error:a.error})},500)},this.onPairingDeleteRequest=async(s,a)=>{const{id:f}=a;try{this.isValidDisconnect({topic:s}),await this.deletePairing(s),this.events.emit("pairing_delete",{id:f,topic:s})}catch(w){await this.sendError(f,s,w),this.logger.error(w)}},this.onUnknownRpcMethodRequest=async(s,a)=>{const{id:f,method:w}=a;try{if(this.registeredMethods.includes(w))return;const E=tr("WC_METHOD_UNSUPPORTED",w);await this.sendError(f,s,E),this.logger.error(E)}catch(E){await this.sendError(f,s,E),this.logger.error(E)}},this.onUnknownRpcMethodResponse=s=>{this.registeredMethods.includes(s)||this.logger.error(tr("WC_METHOD_UNSUPPORTED",s))},this.isValidPair=s=>{if(!cr(s)){const{message:a}=se("MISSING_OR_INVALID",`pair() params: ${s}`);throw new Error(a)}if(!Jv(s.uri)){const{message:a}=se("MISSING_OR_INVALID",`pair() uri: ${s.uri}`);throw new Error(a)}},this.isValidPing=async s=>{if(!cr(s)){const{message:f}=se("MISSING_OR_INVALID",`ping() params: ${s}`);throw new Error(f)}const{topic:a}=s;await this.isValidPairingTopic(a)},this.isValidDisconnect=async s=>{if(!cr(s)){const{message:f}=se("MISSING_OR_INVALID",`disconnect() params: ${s}`);throw new Error(f)}const{topic:a}=s;await this.isValidPairingTopic(a)},this.isValidPairingTopic=async s=>{if(!an(s,!1)){const{message:a}=se("MISSING_OR_INVALID",`pairing topic should be a string: ${s}`);throw new Error(a)}if(!this.pairings.keys.includes(s)){const{message:a}=se("NO_MATCHING_KEY",`pairing topic doesn't exist: ${s}`);throw new Error(a)}if(gi(this.pairings.get(s).expiry)){await this.deletePairing(s);const{message:a}=se("EXPIRED",`pairing topic: ${s}`);throw new Error(a)}},this.core=i,this.logger=De.generateChildLogger(r,this.name),this.pairings=new na(this.core,this.logger,this.name,this.storagePrefix)}get context(){return De.getLoggerContext(this.logger)}isInitialized(){if(!this.initialized){const{message:i}=se("NOT_INITIALIZED",this.name);throw new Error(i)}}registerRelayerEvents(){this.core.relayer.on(_t.message,async i=>{const{topic:r,message:s}=i;if(this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(s)))return;const a=await this.core.crypto.decode(r,s);ac(a)?(this.core.history.set(r,a),this.onRelayEventRequest({topic:r,payload:a})):oc(a)&&(await this.core.history.resolve(a),await this.onRelayEventResponse({topic:r,payload:a}),this.core.history.delete(r,a.id))})}registerExpirerEvents(){this.core.expirer.on(Or.expired,async i=>{const{topic:r}=wl(i.target);r&&this.pairings.keys.includes(r)&&(await this.deletePairing(r,!0),this.events.emit("pairing_expire",{topic:r}))})}}class Fw extends q1{constructor(i,r){super(i,r),this.core=i,this.logger=r,this.records=new Map,this.events=new yr.exports.EventEmitter,this.name=uw,this.version=hw,this.cached=[],this.initialized=!1,this.storagePrefix=vi,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(s=>this.records.set(s.id,s)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(s,a,f)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:s,request:a,chainId:f}),this.records.has(a.id))return;const w={id:a.id,topic:s,request:{method:a.method,params:a.params||null},chainId:f,expiry:jr(de.THIRTY_DAYS)};this.records.set(w.id,w),this.events.emit(Hr.created,w)},this.resolve=async s=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:s}),!this.records.has(s.id))return;const a=await this.getRecord(s.id);typeof a.response>"u"&&(a.response=ri(s)?{error:s.error}:{result:s.result},this.records.set(a.id,a),this.events.emit(Hr.updated,a))},this.get=async(s,a)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:s,id:a}),await this.getRecord(a)),this.delete=(s,a)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:a}),this.values.forEach(f=>{if(f.topic===s){if(typeof a<"u"&&f.id!==a)return;this.records.delete(f.id),this.events.emit(Hr.deleted,f)}})},this.exists=async(s,a)=>(this.isInitialized(),this.records.has(a)?(await this.getRecord(a)).topic===s:!1),this.on=(s,a)=>{this.events.on(s,a)},this.once=(s,a)=>{this.events.once(s,a)},this.off=(s,a)=>{this.events.off(s,a)},this.removeListener=(s,a)=>{this.events.removeListener(s,a)},this.logger=De.generateChildLogger(r,this.name)}get context(){return De.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const i=[];return this.values.forEach(r=>{if(typeof r.response<"u")return;const s={topic:r.topic,request:uc(r.request.method,r.request.params,r.id),chainId:r.chainId};return i.push(s)}),i}async setJsonRpcRecords(i){await this.core.storage.setItem(this.storageKey,i)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(i){this.isInitialized();const r=this.records.get(i);if(!r){const{message:s}=se("NO_MATCHING_KEY",`${this.name}: ${i}`);throw new Error(s)}return r}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(Hr.sync)}async restore(){try{const i=await this.getJsonRpcRecords();if(typeof i>"u"||!i.length)return;if(this.records.size){const{message:r}=se("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=i,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(i){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(i)}}registerEventListeners(){this.events.on(Hr.created,i=>{const r=Hr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:i}),this.persist()}),this.events.on(Hr.updated,i=>{const r=Hr.updated;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:i}),this.persist()}),this.events.on(Hr.deleted,i=>{const r=Hr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:i}),this.persist()}),this.core.heartbeat.on(hn.HEARTBEAT_EVENTS.pulse,()=>{this.cleanup()})}cleanup(){try{this.records.forEach(i=>{de.toMiliseconds(i.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${i.id}`),this.delete(i.topic,i.id))})}catch(i){this.logger.warn(i)}}isInitialized(){if(!this.initialized){const{message:i}=se("NOT_INITIALIZED",this.name);throw new Error(i)}}}class Dw extends B1{constructor(i,r){super(i,r),this.core=i,this.logger=r,this.expirations=new Map,this.events=new yr.exports.EventEmitter,this.name=lw,this.version=fw,this.cached=[],this.initialized=!1,this.storagePrefix=vi,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(s=>this.expirations.set(s.target,s)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=s=>{try{const a=this.formatTarget(s);return typeof this.getExpiration(a)<"u"}catch{return!1}},this.set=(s,a)=>{this.isInitialized();const f=this.formatTarget(s),w={target:f,expiry:a};this.expirations.set(f,w),this.checkExpiry(f,w),this.events.emit(Or.created,{target:f,expiration:w})},this.get=s=>{this.isInitialized();const a=this.formatTarget(s);return this.getExpiration(a)},this.del=s=>{if(this.isInitialized(),this.has(s)){const a=this.formatTarget(s),f=this.getExpiration(a);this.expirations.delete(a),this.events.emit(Or.deleted,{target:a,expiration:f})}},this.on=(s,a)=>{this.events.on(s,a)},this.once=(s,a)=>{this.events.once(s,a)},this.off=(s,a)=>{this.events.off(s,a)},this.removeListener=(s,a)=>{this.events.removeListener(s,a)},this.logger=De.generateChildLogger(r,this.name)}get context(){return De.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(i){if(typeof i=="string")return Yv(i);if(typeof i=="number")return Zv(i);const{message:r}=se("UNKNOWN_TYPE",`Target type: ${typeof i}`);throw new Error(r)}async setExpirations(i){await this.core.storage.setItem(this.storageKey,i)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(Or.sync)}async restore(){try{const i=await this.getExpirations();if(typeof i>"u"||!i.length)return;if(this.expirations.size){const{message:r}=se("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=i,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(i){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(i)}}getExpiration(i){const r=this.expirations.get(i);if(!r){const{message:s}=se("NO_MATCHING_KEY",`${this.name}: ${i}`);throw this.logger.error(s),new Error(s)}return r}checkExpiry(i,r){const{expiry:s}=r;de.toMiliseconds(s)-Date.now()<=0&&this.expire(i,r)}expire(i,r){this.expirations.delete(i),this.events.emit(Or.expired,{target:i,expiration:r})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((i,r)=>this.checkExpiry(r,i))}registerEventListeners(){this.core.heartbeat.on(hn.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(Or.created,i=>{const r=Or.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:i}),this.persist()}),this.events.on(Or.expired,i=>{const r=Or.expired;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:i}),this.persist()}),this.events.on(Or.deleted,i=>{const r=Or.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:i}),this.persist()})}isInitialized(){if(!this.initialized){const{message:i}=se("NOT_INITIALIZED",this.name);throw new Error(i)}}}class jw extends G1{constructor(i,r){super(i,r),this.projectId=i,this.logger=r,this.name=Mo,this.initialized=!1,this.init=async s=>{Xv()||!bl()||(this.verifyUrl=s?.verifyUrl||Wh,await this.createIframe())},this.register=async s=>{var a;if(this.initialized||await this.init(),!!this.iframe)try{(a=this.iframe.contentWindow)==null||a.postMessage(s.attestationId,this.verifyUrl),this.logger.info(`postMessage sent: ${s.attestationId} ${this.verifyUrl}`)}catch{}},this.resolve=async s=>{var a;if(this.isDevEnv)return"";this.logger.info(`resolving attestation: ${s.attestationId}`);const f=this.startAbortTimer(de.FIVE_SECONDS),w=await fetch(`${this.verifyUrl}/attestation/${s.attestationId}`,{signal:this.abortController.signal});return clearTimeout(f),w.status===200?(a=await w.json())==null?void 0:a.origin:""},this.createIframe=async()=>{try{await Promise.race([new Promise((s,a)=>{if(document.getElementById(Mo))return s();const f=document.createElement("iframe");f.setAttribute("id",Mo),f.setAttribute("src",`${this.verifyUrl}/${this.projectId}`),f.style.display="none",f.addEventListener("load",()=>{this.initialized=!0,s()}),f.addEventListener("error",w=>{a(w)}),document.body.append(f),this.iframe=f}),new Promise(s=>{setTimeout(()=>s("iframe load timeout"),de.toMiliseconds(de.ONE_SECOND/2))})])}catch(s){this.logger.error(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.error(s)}},this.logger=De.generateChildLogger(r,this.name),this.verifyUrl=Wh,this.abortController=new AbortController,this.isDevEnv=Qv()&&{}.IS_VITEST}get context(){return De.getLoggerContext(this.logger)}startAbortTimer(i){return setTimeout(()=>this.abortController.abort(),de.toMiliseconds(i))}}var $w=Object.defineProperty,rl=Object.getOwnPropertySymbols,Lw=Object.prototype.hasOwnProperty,Mw=Object.prototype.propertyIsEnumerable,il=(h,i,r)=>i in h?$w(h,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):h[i]=r,nl=(h,i)=>{for(var r in i||(i={}))Lw.call(i,r)&&il(h,r,i[r]);if(rl)for(var r of rl(i))Mw.call(i,r)&&il(h,r,i[r]);return h};class pc extends z1{constructor(i){super(i),this.protocol=Bl,this.version=zm,this.name=fc,this.events=new yr.exports.EventEmitter,this.initialized=!1,this.on=(s,a)=>this.events.on(s,a),this.once=(s,a)=>this.events.once(s,a),this.off=(s,a)=>this.events.off(s,a),this.removeListener=(s,a)=>this.events.removeListener(s,a),this.projectId=i?.projectId,this.relayUrl=i?.relayUrl||Wl;const r=typeof i?.logger<"u"&&typeof i?.logger!="string"?i.logger:De.pino(De.getDefaultLoggerOptions({level:i?.logger||qm.logger}));this.logger=De.generateChildLogger(r,this.name),this.heartbeat=new hn.HeartBeat,this.crypto=new dw(this,this.logger,i?.keychain),this.history=new Fw(this,this.logger),this.expirer=new Dw(this,this.logger),this.storage=i!=null&&i.storage?i.storage:new T1(nl(nl({},Um),i?.storageOptions)),this.relayer=new Cw({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new Nw(this,this.logger),this.verify=new jw(this.projectId||"",this.logger)}static async init(i){const r=new pc(i);await r.initialize();const s=await r.crypto.getClientId();return await r.storage.setItem(iw,s),r}get context(){return De.getLoggerContext(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(i){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,i),this.logger.error(i.message),i}}}const zw=pc,Jl="wc",Yl=2,Zl="client",dc=`${Jl}@${Yl}:${Zl}:`,qo={name:Zl,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},qw="WALLETCONNECT_DEEPLINK_CHOICE",Uw="proposal",Xl="Proposal expired",Hw="session",Gs=de.SEVEN_DAYS,kw="engine",Mn={wc_sessionPropose:{req:{ttl:de.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:de.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:de.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:de.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:de.ONE_DAY,prompt:!1,tag:1104},res:{ttl:de.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:de.ONE_DAY,prompt:!1,tag:1106},res:{ttl:de.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:de.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:de.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:de.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:de.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:de.ONE_DAY,prompt:!1,tag:1112},res:{ttl:de.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:de.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:de.THIRTY_SECONDS,prompt:!1,tag:1115}}},Uo={min:de.FIVE_MINUTES,max:de.SEVEN_DAYS},Kw="request",Vw=["wc_sessionPropose","wc_sessionRequest","wc_authRequest"];var Bw=Object.defineProperty,Gw=Object.defineProperties,Ww=Object.getOwnPropertyDescriptors,sl=Object.getOwnPropertySymbols,Jw=Object.prototype.hasOwnProperty,Yw=Object.prototype.propertyIsEnumerable,al=(h,i,r)=>i in h?Bw(h,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):h[i]=r,Pr=(h,i)=>{for(var r in i||(i={}))Jw.call(i,r)&&al(h,r,i[r]);if(sl)for(var r of sl(i))Yw.call(i,r)&&al(h,r,i[r]);return h},Ho=(h,i)=>Gw(h,Ww(i));class Zw extends J1{constructor(i){super(i),this.name=kw,this.events=new yr.exports,this.initialized=!1,this.ignoredPayloadTypes=[ml],this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.client.core.pairing.register({methods:Object.keys(Mn)}),this.initialized=!0)},this.connect=async r=>{this.isInitialized();const s=Ho(Pr({},r),{requiredNamespaces:r.requiredNamespaces||{},optionalNamespaces:r.optionalNamespaces||{}});await this.isValidConnect(s);const{pairingTopic:a,requiredNamespaces:f,optionalNamespaces:w,sessionProperties:E,relays:x}=s;let N=a,U,X=!1;if(N&&(X=this.client.core.pairing.pairings.get(N).active),!N||!X){const{topic:fe,uri:he}=await this.client.core.pairing.create();N=fe,U=he}const Q=await this.client.core.crypto.generateKeyPair(),ee=Pr({requiredNamespaces:f,optionalNamespaces:w,relays:x??[{protocol:Gl}],proposer:{publicKey:Q,metadata:this.client.metadata}},E&&{sessionProperties:E}),{reject:V,resolve:Z,done:oe}=sn(de.FIVE_MINUTES,Xl);if(this.events.once(jt("session_connect"),async({error:fe,session:he})=>{if(fe)V(fe);else if(he){he.self.publicKey=Q;const le=Ho(Pr({},he),{requiredNamespaces:he.requiredNamespaces,optionalNamespaces:he.optionalNamespaces});await this.client.session.set(he.topic,le),await this.setExpiry(he.topic,he.expiry),N&&await this.client.core.pairing.updateMetadata({topic:N,metadata:he.peer.metadata}),Z(le)}}),!N){const{message:fe}=se("NO_MATCHING_KEY",`connect() pairing topic: ${N}`);throw new Error(fe)}const ge=await this.sendRequest(N,"wc_sessionPropose",ee),ye=jr(de.FIVE_MINUTES);return await this.setProposal(ge,Pr({id:ge,expiry:ye},ee)),{uri:U,approval:oe}},this.pair=async r=>(this.isInitialized(),await this.client.core.pairing.pair(r)),this.approve=async r=>{this.isInitialized(),await this.isValidApprove(r);const{id:s,relayProtocol:a,namespaces:f,sessionProperties:w}=r,E=this.client.proposal.get(s);let{pairingTopic:x,proposer:N,requiredNamespaces:U,optionalNamespaces:X}=E;x=x||"",Zs(U)||(U=t1(f,"approve()"));const Q=await this.client.core.crypto.generateKeyPair(),ee=N.publicKey,V=await this.client.core.crypto.generateSharedKey(Q,ee);x&&s&&(await this.client.core.pairing.updateMetadata({topic:x,metadata:N.metadata}),await this.sendResult(s,x,{relay:{protocol:a??"irn"},responderPublicKey:Q}),await this.client.proposal.delete(s,tr("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:x}));const Z=Pr({relay:{protocol:a??"irn"},namespaces:f,requiredNamespaces:U,optionalNamespaces:X,pairingTopic:x,controller:{publicKey:Q,metadata:this.client.metadata},expiry:jr(Gs)},w&&{sessionProperties:w});await this.client.core.relayer.subscribe(V),await this.sendRequest(V,"wc_sessionSettle",Z);const oe=Ho(Pr({},Z),{topic:V,pairingTopic:x,acknowledged:!1,self:Z.controller,peer:{publicKey:N.publicKey,metadata:N.metadata},controller:Q});return await this.client.session.set(V,oe),await this.setExpiry(V,jr(Gs)),{topic:V,acknowledged:()=>new Promise(ge=>setTimeout(()=>ge(this.client.session.get(V)),500))}},this.reject=async r=>{this.isInitialized(),await this.isValidReject(r);const{id:s,reason:a}=r,{pairingTopic:f}=this.client.proposal.get(s);f&&(await this.sendError(s,f,a),await this.client.proposal.delete(s,tr("USER_DISCONNECTED")))},this.update=async r=>{this.isInitialized(),await this.isValidUpdate(r);const{topic:s,namespaces:a}=r,f=await this.sendRequest(s,"wc_sessionUpdate",{namespaces:a}),{done:w,resolve:E,reject:x}=sn();return this.events.once(jt("session_update",f),({error:N})=>{N?x(N):E()}),await this.client.session.update(s,{namespaces:a}),{acknowledged:w}},this.extend=async r=>{this.isInitialized(),await this.isValidExtend(r);const{topic:s}=r,a=await this.sendRequest(s,"wc_sessionExtend",{}),{done:f,resolve:w,reject:E}=sn();return this.events.once(jt("session_extend",a),({error:x})=>{x?E(x):w()}),await this.setExpiry(s,jr(Gs)),{acknowledged:f}},this.request=async r=>{this.isInitialized(),await this.isValidRequest(r);const{chainId:s,request:a,topic:f,expiry:w}=r,E=await this.sendRequest(f,"wc_sessionRequest",{request:a,chainId:s},w),{done:x,resolve:N,reject:U}=sn(w);this.events.once(jt("session_request",E),({error:Q,result:ee})=>{Q?U(Q):N(ee)}),this.client.events.emit("session_request_sent",{topic:f,request:a,chainId:s,id:E});const X=await this.client.core.storage.getItem(qw);return r1({id:E,topic:f,wcDeepLink:X}),await x()},this.respond=async r=>{this.isInitialized(),await this.isValidRespond(r);const{topic:s,response:a}=r,{id:f}=a;di(a)?await this.sendResult(f,s,a.result):ri(a)&&await this.sendError(f,s,a.error),this.deletePendingSessionRequest(r.response.id,{message:"fulfilled",code:0})},this.ping=async r=>{this.isInitialized(),await this.isValidPing(r);const{topic:s}=r;if(this.client.session.keys.includes(s)){const a=await this.sendRequest(s,"wc_sessionPing",{}),{done:f,resolve:w,reject:E}=sn();this.events.once(jt("session_ping",a),({error:x})=>{x?E(x):w()}),await f()}else this.client.core.pairing.pairings.keys.includes(s)&&await this.client.core.pairing.ping({topic:s})},this.emit=async r=>{this.isInitialized(),await this.isValidEmit(r);const{topic:s,event:a,chainId:f}=r;await this.sendRequest(s,"wc_sessionEvent",{event:a,chainId:f})},this.disconnect=async r=>{this.isInitialized(),await this.isValidDisconnect(r);const{topic:s}=r;if(this.client.session.keys.includes(s)){const a=Sl().toString();let f;const w=E=>{E?.id.toString()===a&&(this.client.core.relayer.events.removeListener(_t.message_ack,w),f())};await Promise.all([new Promise(E=>{f=E,this.client.core.relayer.on(_t.message_ack,w)}),this.sendRequest(s,"wc_sessionDelete",tr("USER_DISCONNECTED"),void 0,a)]),await this.deleteSession(s)}else await this.client.core.pairing.disconnect({topic:s})},this.find=r=>(this.isInitialized(),this.client.session.getAll().filter(s=>i1(s,r))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.cleanupDuplicatePairings=async r=>{if(r.pairingTopic)try{const s=this.client.core.pairing.pairings.get(r.pairingTopic),a=this.client.core.pairing.pairings.getAll().filter(f=>{var w,E;return((w=f.peerMetadata)==null?void 0:w.url)&&((E=f.peerMetadata)==null?void 0:E.url)===r.peer.metadata.url&&f.topic&&f.topic!==s.topic});if(a.length===0)return;this.client.logger.info(`Cleaning up ${a.length} duplicate pairing(s)`),await Promise.all(a.map(f=>this.client.core.pairing.disconnect({topic:f.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(s){this.client.logger.error(s)}},this.deleteSession=async(r,s)=>{const{self:a}=this.client.session.get(r);await this.client.core.relayer.unsubscribe(r),this.client.session.delete(r,tr("USER_DISCONNECTED")),this.client.core.crypto.keychain.has(a.publicKey)&&await this.client.core.crypto.deleteKeyPair(a.publicKey),this.client.core.crypto.keychain.has(r)&&await this.client.core.crypto.deleteSymKey(r),s||this.client.core.expirer.del(r)},this.deleteProposal=async(r,s)=>{await Promise.all([this.client.proposal.delete(r,tr("USER_DISCONNECTED")),s?Promise.resolve():this.client.core.expirer.del(r)])},this.deletePendingSessionRequest=async(r,s,a=!1)=>{await Promise.all([this.client.pendingRequest.delete(r,s),a?Promise.resolve():this.client.core.expirer.del(r)])},this.setExpiry=async(r,s)=>{this.client.session.keys.includes(r)&&await this.client.session.update(r,{expiry:s}),this.client.core.expirer.set(r,s)},this.setProposal=async(r,s)=>{await this.client.proposal.set(r,s),this.client.core.expirer.set(r,s.expiry)},this.setPendingSessionRequest=async r=>{const s=Mn.wc_sessionRequest.req.ttl,{id:a,topic:f,params:w}=r;await this.client.pendingRequest.set(a,{id:a,topic:f,params:w}),s&&this.client.core.expirer.set(a,jr(s))},this.sendRequest=async(r,s,a,f,w)=>{const E=uc(s,a);if(bl()&&Vw.includes(s)){const U=cn(JSON.stringify(E));await this.client.core.verify.register({attestationId:U})}const x=await this.client.core.crypto.encode(r,E),N=Mn[s].req;return f&&(N.ttl=f),w&&(N.id=w),this.client.core.history.set(r,E),this.client.core.relayer.publish(r,x,N),E.id},this.sendResult=async(r,s,a)=>{const f=cc(r,a),w=await this.client.core.crypto.encode(s,f),E=await this.client.core.history.get(s,r),x=Mn[E.request.method].res;this.client.core.relayer.publish(s,w,x),await this.client.core.history.resolve(f)},this.sendError=async(r,s,a)=>{const f=sc(r,a),w=await this.client.core.crypto.encode(s,f),E=await this.client.core.history.get(s,r),x=Mn[E.request.method].res;this.client.core.relayer.publish(s,w,x),await this.client.core.history.resolve(f)},this.cleanup=async()=>{const r=[],s=[];this.client.session.getAll().forEach(a=>{gi(a.expiry)&&r.push(a.topic)}),this.client.proposal.getAll().forEach(a=>{gi(a.expiry)&&s.push(a.id)}),await Promise.all([...r.map(a=>this.deleteSession(a)),...s.map(a=>this.deleteProposal(a))])},this.onRelayEventRequest=r=>{const{topic:s,payload:a}=r,f=a.method;switch(f){case"wc_sessionPropose":return this.onSessionProposeRequest(s,a);case"wc_sessionSettle":return this.onSessionSettleRequest(s,a);case"wc_sessionUpdate":return this.onSessionUpdateRequest(s,a);case"wc_sessionExtend":return this.onSessionExtendRequest(s,a);case"wc_sessionPing":return this.onSessionPingRequest(s,a);case"wc_sessionDelete":return this.onSessionDeleteRequest(s,a);case"wc_sessionRequest":return this.onSessionRequest(s,a);case"wc_sessionEvent":return this.onSessionEventRequest(s,a);default:return this.client.logger.info(`Unsupported request method ${f}`)}},this.onRelayEventResponse=async r=>{const{topic:s,payload:a}=r,f=(await this.client.core.history.get(s,a.id)).request.method;switch(f){case"wc_sessionPropose":return this.onSessionProposeResponse(s,a);case"wc_sessionSettle":return this.onSessionSettleResponse(s,a);case"wc_sessionUpdate":return this.onSessionUpdateResponse(s,a);case"wc_sessionExtend":return this.onSessionExtendResponse(s,a);case"wc_sessionPing":return this.onSessionPingResponse(s,a);case"wc_sessionRequest":return this.onSessionRequestResponse(s,a);default:return this.client.logger.info(`Unsupported response method ${f}`)}},this.onRelayEventUnknownPayload=r=>{const{topic:s}=r,{message:a}=se("MISSING_OR_INVALID",`Decoded payload on topic ${s} is not identifiable as a JSON-RPC request or a response.`);throw new Error(a)},this.onSessionProposeRequest=async(r,s)=>{const{params:a,id:f}=s;try{this.isValidConnect(Pr({},s.params));const w=jr(de.FIVE_MINUTES),E=Pr({id:f,pairingTopic:r,expiry:w},a);await this.setProposal(f,E);const x=cn(JSON.stringify(s)),N=await this.getVerifyContext(x,E.proposer.metadata);this.client.events.emit("session_proposal",{id:f,params:E,verifyContext:N})}catch(w){await this.sendError(f,r,w),this.client.logger.error(w)}},this.onSessionProposeResponse=async(r,s)=>{const{id:a}=s;if(di(s)){const{result:f}=s;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:f});const w=this.client.proposal.get(a);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:w});const E=w.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:E});const x=f.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:x});const N=await this.client.core.crypto.generateSharedKey(E,x);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:N});const U=await this.client.core.relayer.subscribe(N);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:U}),await this.client.core.pairing.activate({topic:r})}else ri(s)&&(await this.client.proposal.delete(a,tr("USER_DISCONNECTED")),this.events.emit(jt("session_connect"),{error:s.error}))},this.onSessionSettleRequest=async(r,s)=>{const{id:a,params:f}=s;try{this.isValidSessionSettleRequest(f);const{relay:w,controller:E,expiry:x,namespaces:N,requiredNamespaces:U,optionalNamespaces:X,sessionProperties:Q,pairingTopic:ee}=s.params,V=Pr({topic:r,relay:w,expiry:x,namespaces:N,acknowledged:!0,pairingTopic:ee,requiredNamespaces:U,optionalNamespaces:X,controller:E.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:E.publicKey,metadata:E.metadata}},Q&&{sessionProperties:Q});await this.sendResult(s.id,r,!0),this.events.emit(jt("session_connect"),{session:V}),this.cleanupDuplicatePairings(V)}catch(w){await this.sendError(a,r,w),this.client.logger.error(w)}},this.onSessionSettleResponse=async(r,s)=>{const{id:a}=s;di(s)?(await this.client.session.update(r,{acknowledged:!0}),this.events.emit(jt("session_approve",a),{})):ri(s)&&(await this.client.session.delete(r,tr("USER_DISCONNECTED")),this.events.emit(jt("session_approve",a),{error:s.error}))},this.onSessionUpdateRequest=async(r,s)=>{const{params:a,id:f}=s;try{this.isValidUpdate(Pr({topic:r},a)),await this.client.session.update(r,{namespaces:a.namespaces}),await this.sendResult(f,r,!0),this.client.events.emit("session_update",{id:f,topic:r,params:a})}catch(w){await this.sendError(f,r,w),this.client.logger.error(w)}},this.onSessionUpdateResponse=(r,s)=>{const{id:a}=s;di(s)?this.events.emit(jt("session_update",a),{}):ri(s)&&this.events.emit(jt("session_update",a),{error:s.error})},this.onSessionExtendRequest=async(r,s)=>{const{id:a}=s;try{this.isValidExtend({topic:r}),await this.setExpiry(r,jr(Gs)),await this.sendResult(a,r,!0),this.client.events.emit("session_extend",{id:a,topic:r})}catch(f){await this.sendError(a,r,f),this.client.logger.error(f)}},this.onSessionExtendResponse=(r,s)=>{const{id:a}=s;di(s)?this.events.emit(jt("session_extend",a),{}):ri(s)&&this.events.emit(jt("session_extend",a),{error:s.error})},this.onSessionPingRequest=async(r,s)=>{const{id:a}=s;try{this.isValidPing({topic:r}),await this.sendResult(a,r,!0),this.client.events.emit("session_ping",{id:a,topic:r})}catch(f){await this.sendError(a,r,f),this.client.logger.error(f)}},this.onSessionPingResponse=(r,s)=>{const{id:a}=s;setTimeout(()=>{di(s)?this.events.emit(jt("session_ping",a),{}):ri(s)&&this.events.emit(jt("session_ping",a),{error:s.error})},500)},this.onSessionDeleteRequest=async(r,s)=>{const{id:a}=s;try{this.isValidDisconnect({topic:r,reason:s.params}),await Promise.all([new Promise(f=>{this.client.core.relayer.once(_t.publish,async()=>{f(await this.deleteSession(r))})}),this.sendResult(a,r,!0)]),this.client.events.emit("session_delete",{id:a,topic:r})}catch(f){this.client.logger.error(f)}},this.onSessionRequest=async(r,s)=>{const{id:a,params:f}=s;try{this.isValidRequest(Pr({topic:r},f)),await this.setPendingSessionRequest({id:a,topic:r,params:f});const w=cn(JSON.stringify(s)),E=this.client.session.get(r),x=await this.getVerifyContext(w,E.peer.metadata);this.client.events.emit("session_request",{id:a,topic:r,params:f,verifyContext:x})}catch(w){await this.sendError(a,r,w),this.client.logger.error(w)}},this.onSessionRequestResponse=(r,s)=>{const{id:a}=s;di(s)?this.events.emit(jt("session_request",a),{result:s.result}):ri(s)&&this.events.emit(jt("session_request",a),{error:s.error})},this.onSessionEventRequest=async(r,s)=>{const{id:a,params:f}=s;try{this.isValidEmit(Pr({topic:r},f)),this.client.events.emit("session_event",{id:a,topic:r,params:f})}catch(w){await this.sendError(a,r,w),this.client.logger.error(w)}},this.isValidConnect=async r=>{if(!cr(r)){const{message:x}=se("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(r)}`);throw new Error(x)}const{pairingTopic:s,requiredNamespaces:a,optionalNamespaces:f,sessionProperties:w,relays:E}=r;if(yi(s)||await this.isValidPairingTopic(s),!n1(E,!0)){const{message:x}=se("MISSING_OR_INVALID",`connect() relays: ${E}`);throw new Error(x)}!yi(a)&&Zs(a)!==0&&this.validateNamespaces(a,"requiredNamespaces"),!yi(f)&&Zs(f)!==0&&this.validateNamespaces(f,"optionalNamespaces"),yi(w)||this.validateSessionProps(w,"sessionProperties")},this.validateNamespaces=(r,s)=>{const a=s1(r,"connect()",s);if(a)throw new Error(a.message)},this.isValidApprove=async r=>{if(!cr(r))throw new Error(se("MISSING_OR_INVALID",`approve() params: ${r}`).message);const{id:s,namespaces:a,relayProtocol:f,sessionProperties:w}=r;await this.isValidProposalId(s);const E=this.client.proposal.get(s),x=To(a,"approve()");if(x)throw new Error(x.message);const N=mh(E.requiredNamespaces,a,"approve()");if(N)throw new Error(N.message);if(!an(f,!0)){const{message:U}=se("MISSING_OR_INVALID",`approve() relayProtocol: ${f}`);throw new Error(U)}yi(w)||this.validateSessionProps(w,"sessionProperties")},this.isValidReject=async r=>{if(!cr(r)){const{message:f}=se("MISSING_OR_INVALID",`reject() params: ${r}`);throw new Error(f)}const{id:s,reason:a}=r;if(await this.isValidProposalId(s),!a1(a)){const{message:f}=se("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(a)}`);throw new Error(f)}},this.isValidSessionSettleRequest=r=>{if(!cr(r)){const{message:N}=se("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${r}`);throw new Error(N)}const{relay:s,controller:a,namespaces:f,expiry:w}=r;if(!o1(s)){const{message:N}=se("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(N)}const E=c1(a,"onSessionSettleRequest()");if(E)throw new Error(E.message);const x=To(f,"onSessionSettleRequest()");if(x)throw new Error(x.message);if(gi(w)){const{message:N}=se("EXPIRED","onSessionSettleRequest()");throw new Error(N)}},this.isValidUpdate=async r=>{if(!cr(r)){const{message:x}=se("MISSING_OR_INVALID",`update() params: ${r}`);throw new Error(x)}const{topic:s,namespaces:a}=r;await this.isValidSessionTopic(s);const f=this.client.session.get(s),w=To(a,"update()");if(w)throw new Error(w.message);const E=mh(f.requiredNamespaces,a,"update()");if(E)throw new Error(E.message)},this.isValidExtend=async r=>{if(!cr(r)){const{message:a}=se("MISSING_OR_INVALID",`extend() params: ${r}`);throw new Error(a)}const{topic:s}=r;await this.isValidSessionTopic(s)},this.isValidRequest=async r=>{if(!cr(r)){const{message:x}=se("MISSING_OR_INVALID",`request() params: ${r}`);throw new Error(x)}const{topic:s,request:a,chainId:f,expiry:w}=r;await this.isValidSessionTopic(s);const{namespaces:E}=this.client.session.get(s);if(!wh(E,f)){const{message:x}=se("MISSING_OR_INVALID",`request() chainId: ${f}`);throw new Error(x)}if(!u1(a)){const{message:x}=se("MISSING_OR_INVALID",`request() ${JSON.stringify(a)}`);throw new Error(x)}if(!h1(E,f,a.method)){const{message:x}=se("MISSING_OR_INVALID",`request() method: ${a.method}`);throw new Error(x)}if(w&&!l1(w,Uo)){const{message:x}=se("MISSING_OR_INVALID",`request() expiry: ${w}. Expiry must be a number (in seconds) between ${Uo.min} and ${Uo.max}`);throw new Error(x)}},this.isValidRespond=async r=>{if(!cr(r)){const{message:f}=se("MISSING_OR_INVALID",`respond() params: ${r}`);throw new Error(f)}const{topic:s,response:a}=r;if(await this.isValidSessionTopic(s),!f1(a)){const{message:f}=se("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(a)}`);throw new Error(f)}},this.isValidPing=async r=>{if(!cr(r)){const{message:a}=se("MISSING_OR_INVALID",`ping() params: ${r}`);throw new Error(a)}const{topic:s}=r;await this.isValidSessionOrPairingTopic(s)},this.isValidEmit=async r=>{if(!cr(r)){const{message:E}=se("MISSING_OR_INVALID",`emit() params: ${r}`);throw new Error(E)}const{topic:s,event:a,chainId:f}=r;await this.isValidSessionTopic(s);const{namespaces:w}=this.client.session.get(s);if(!wh(w,f)){const{message:E}=se("MISSING_OR_INVALID",`emit() chainId: ${f}`);throw new Error(E)}if(!p1(a)){const{message:E}=se("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(a)}`);throw new Error(E)}if(!d1(w,f,a.name)){const{message:E}=se("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(a)}`);throw new Error(E)}},this.isValidDisconnect=async r=>{if(!cr(r)){const{message:a}=se("MISSING_OR_INVALID",`disconnect() params: ${r}`);throw new Error(a)}const{topic:s}=r;await this.isValidSessionOrPairingTopic(s)},this.getVerifyContext=async(r,s)=>{const a={verified:{verifyUrl:s.verifyUrl||"",validation:"UNKNOWN",origin:s.url||""}};try{const f=await this.client.core.verify.resolve({attestationId:r,verifyUrl:s.verifyUrl});f&&(a.verified.origin=f,a.verified.validation=f===s.url?"VALID":"INVALID")}catch(f){this.client.logger.error(f)}return this.client.logger.info(`Verify context: ${JSON.stringify(a)}`),a},this.validateSessionProps=(r,s)=>{Object.values(r).forEach(a=>{if(!an(a,!1)){const{message:f}=se("MISSING_OR_INVALID",`${s} must be in Record<string, string> format. Received: ${JSON.stringify(a)}`);throw new Error(f)}})}}isInitialized(){if(!this.initialized){const{message:i}=se("NOT_INITIALIZED",this.name);throw new Error(i)}}registerRelayerEvents(){this.client.core.relayer.on(_t.message,async i=>{const{topic:r,message:s}=i;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(s)))return;const a=await this.client.core.crypto.decode(r,s);ac(a)?(this.client.core.history.set(r,a),this.onRelayEventRequest({topic:r,payload:a})):oc(a)?(await this.client.core.history.resolve(a),await this.onRelayEventResponse({topic:r,payload:a}),this.client.core.history.delete(r,a.id)):this.onRelayEventUnknownPayload({topic:r,payload:a})})}registerExpirerEvents(){this.client.core.expirer.on(Or.expired,async i=>{const{topic:r,id:s}=wl(i.target);if(s&&this.client.pendingRequest.keys.includes(s))return await this.deletePendingSessionRequest(s,se("EXPIRED"),!0);r?this.client.session.keys.includes(r)&&(await this.deleteSession(r,!0),this.client.events.emit("session_expire",{topic:r})):s&&(await this.deleteProposal(s,!0),this.client.events.emit("proposal_expire",{id:s}))})}isValidPairingTopic(i){if(!an(i,!1)){const{message:r}=se("MISSING_OR_INVALID",`pairing topic should be a string: ${i}`);throw new Error(r)}if(!this.client.core.pairing.pairings.keys.includes(i)){const{message:r}=se("NO_MATCHING_KEY",`pairing topic doesn't exist: ${i}`);throw new Error(r)}if(gi(this.client.core.pairing.pairings.get(i).expiry)){const{message:r}=se("EXPIRED",`pairing topic: ${i}`);throw new Error(r)}}async isValidSessionTopic(i){if(!an(i,!1)){const{message:r}=se("MISSING_OR_INVALID",`session topic should be a string: ${i}`);throw new Error(r)}if(!this.client.session.keys.includes(i)){const{message:r}=se("NO_MATCHING_KEY",`session topic doesn't exist: ${i}`);throw new Error(r)}if(gi(this.client.session.get(i).expiry)){await this.deleteSession(i);const{message:r}=se("EXPIRED",`session topic: ${i}`);throw new Error(r)}}async isValidSessionOrPairingTopic(i){if(this.client.session.keys.includes(i))await this.isValidSessionTopic(i);else if(this.client.core.pairing.pairings.keys.includes(i))this.isValidPairingTopic(i);else if(an(i,!1)){const{message:r}=se("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${i}`);throw new Error(r)}else{const{message:r}=se("MISSING_OR_INVALID",`session or pairing topic should be a string: ${i}`);throw new Error(r)}}async isValidProposalId(i){if(!g1(i)){const{message:r}=se("MISSING_OR_INVALID",`proposal id should be a number: ${i}`);throw new Error(r)}if(!this.client.proposal.keys.includes(i)){const{message:r}=se("NO_MATCHING_KEY",`proposal id doesn't exist: ${i}`);throw new Error(r)}if(gi(this.client.proposal.get(i).expiry)){await this.deleteProposal(i);const{message:r}=se("EXPIRED",`proposal id: ${i}`);throw new Error(r)}}}class Xw extends na{constructor(i,r){super(i,r,Uw,dc),this.core=i,this.logger=r}}class Qw extends na{constructor(i,r){super(i,r,Hw,dc),this.core=i,this.logger=r}}class eb extends na{constructor(i,r){super(i,r,Kw,dc,s=>s.id),this.core=i,this.logger=r}}class gc extends W1{constructor(i){super(i),this.protocol=Jl,this.version=Yl,this.name=qo.name,this.events=new yr.exports.EventEmitter,this.on=(s,a)=>this.events.on(s,a),this.once=(s,a)=>this.events.once(s,a),this.off=(s,a)=>this.events.off(s,a),this.removeListener=(s,a)=>this.events.removeListener(s,a),this.removeAllListeners=s=>this.events.removeAllListeners(s),this.connect=async s=>{try{return await this.engine.connect(s)}catch(a){throw this.logger.error(a.message),a}},this.pair=async s=>{try{return await this.engine.pair(s)}catch(a){throw this.logger.error(a.message),a}},this.approve=async s=>{try{return await this.engine.approve(s)}catch(a){throw this.logger.error(a.message),a}},this.reject=async s=>{try{return await this.engine.reject(s)}catch(a){throw this.logger.error(a.message),a}},this.update=async s=>{try{return await this.engine.update(s)}catch(a){throw this.logger.error(a.message),a}},this.extend=async s=>{try{return await this.engine.extend(s)}catch(a){throw this.logger.error(a.message),a}},this.request=async s=>{try{return await this.engine.request(s)}catch(a){throw this.logger.error(a.message),a}},this.respond=async s=>{try{return await this.engine.respond(s)}catch(a){throw this.logger.error(a.message),a}},this.ping=async s=>{try{return await this.engine.ping(s)}catch(a){throw this.logger.error(a.message),a}},this.emit=async s=>{try{return await this.engine.emit(s)}catch(a){throw this.logger.error(a.message),a}},this.disconnect=async s=>{try{return await this.engine.disconnect(s)}catch(a){throw this.logger.error(a.message),a}},this.find=s=>{try{return this.engine.find(s)}catch(a){throw this.logger.error(a.message),a}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(s){throw this.logger.error(s.message),s}},this.name=i?.name||qo.name,this.metadata=i?.metadata||e1();const r=typeof i?.logger<"u"&&typeof i?.logger!="string"?i.logger:De.pino(De.getDefaultLoggerOptions({level:i?.logger||qo.logger}));this.core=i?.core||new zw(i),this.logger=De.generateChildLogger(r,this.name),this.session=new Qw(this.core,this.logger),this.proposal=new Xw(this.core,this.logger),this.pendingRequest=new eb(this.core,this.logger),this.engine=new Zw(this)}static async init(i){const r=new gc(i);return await r.initialize(),r}get context(){return De.getLoggerContext(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.core.verify.init({verifyUrl:this.metadata.verifyUrl}),this.logger.info("SignClient Initialization Success")}catch(i){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(i.message),i}}}const ol="error",tb="wss://relay.walletconnect.com",rb="wc",ib="universal_provider",cl=`${rb}@2:${ib}:`,nb="https://rpc.walletconnect.com/v1",mi={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};var zn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Xo={exports:{}};/**
* @license
* Lodash <https://lodash.com/>
* Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
* Released under MIT license <https://lodash.com/license>
* Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
* Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
*/(function(h,i){(function(){var r,s="4.17.21",a=200,f="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",w="Expected a function",E="Invalid `variable` option passed into `_.template`",x="__lodash_hash_undefined__",N=500,U="__lodash_placeholder__",X=1,Q=2,ee=4,V=1,Z=2,oe=1,ge=2,ye=4,fe=8,he=16,le=32,L=64,K=128,F=256,ue=512,l=30,v="...",_=800,S=16,y=1,g=2,j=3,W=1/0,J=9007199254740991,O=17976931348623157e292,$=0/0,Y=4294967295,re=Y-1,me=Y>>>1,ut=[["ary",K],["bind",oe],["bindKey",ge],["curry",fe],["curryRight",he],["flip",ue],["partial",le],["partialRight",L],["rearg",F]],be="[object Arguments]",St="[object Array]",z="[object AsyncFunction]",M="[object Boolean]",R="[object Date]",c="[object DOMException]",P="[object Error]",ae="[object Function]",we="[object GeneratorFunction]",Pe="[object Map]",je="[object Number]",Le="[object Null]",Te="[object Object]",Pt="[object Promise]",mt="[object Proxy]",st="[object RegExp]",ze="[object Set]",Ze="[object String]",Xe="[object Symbol]",at="[object Undefined]",ke="[object WeakMap]",Qe="[object WeakSet]",$e="[object ArrayBuffer]",Ve="[object DataView]",ht="[object Float32Array]",Ue="[object Float64Array]",Ot="[object Int8Array]",$t="[object Int16Array]",Ht="[object Int32Array]",kt="[object Uint8Array]",zt="[object Uint8ClampedArray]",Wt="[object Uint16Array]",rr="[object Uint32Array]",$r=/\b__p \+= '';/g,Jt=/\b(__p \+=) '' \+/g,Kr=/(__e\(.*?\)|\b__t\)) \+\n'';/g,ii=/&(?:amp|lt|gt|quot|#39);/g,wi=/[&<>"']/g,lt=RegExp(ii.source),rt=RegExp(wi.source),ft=/<%-([\s\S]+?)%>/g,pt=/<%([\s\S]+?)%>/g,ot=/<%=([\s\S]+?)%>/g,it=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Ct=/^\w*$/,At=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,dt=/[\\^$.*+?()[\]{}|]/g,Tt=RegExp(dt.source),gt=/^\s+/,wt=/\s/,yt=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Ye=/\{\n\/\* \[wrapped with (.+)\] \*/,Rt=/,? & /,Nt=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,sa=/[()=,{}\[\]\/\s]/,aa=/\\(\\)?/g,oa=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,vr=/\w*$/,ca=/^[-+]0x[0-9a-f]+$/i,ua=/^0b[01]+$/i,ha=/^\[object .+?Constructor\]$/,la=/^0o[0-7]+$/i,fa=/^(?:0|[1-9]\d*)$/,Vr=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Mi=/($^)/,pa=/['\n\r\u2028\u2029\\]/g,zi="\\ud800-\\udfff",da="\\u0300-\\u036f",ga="\\ufe20-\\ufe2f",qi="\\u20d0-\\u20ff",kn=da+ga+qi,Kn="\\u2700-\\u27bf",Ar="a-z\\xdf-\\xf6\\xf8-\\xff",ya="\\xac\\xb1\\xd7\\xf7",va="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",_a="\\u2000-\\u206f",ma=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Vn="A-Z\\xc0-\\xd6\\xd8-\\xde",Bn="\\ufe0e\\ufe0f",bi=ya+va+_a+ma,ln="['\u2019]",Ei="["+zi+"]",fn="["+bi+"]",Ii="["+kn+"]",Gn="\\d+",wa="["+Kn+"]",Wn="["+Ar+"]",Jn="[^"+zi+bi+Gn+Kn+Ar+Vn+"]",Ui="\\ud83c[\\udffb-\\udfff]",ba="(?:"+Ii+"|"+Ui+")",Yn="[^"+zi+"]",Hi="(?:\\ud83c[\\udde6-\\uddff]){2}",ni="[\\ud800-\\udbff][\\udc00-\\udfff]",ur="["+Vn+"]",Zn="\\u200d",Xn="(?:"+Wn+"|"+Jn+")",Lr="(?:"+ur+"|"+Jn+")",Qn="(?:"+ln+"(?:d|ll|m|re|s|t|ve))?",es="(?:"+ln+"(?:D|LL|M|RE|S|T|VE))?",ts=ba+"?",rs="["+Bn+"]?",Ea="(?:"+Zn+"(?:"+[Yn,Hi,ni].join("|")+")"+rs+ts+")*",Br="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",is="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",ns=rs+ts+Ea,ki="(?:"+[wa,Hi,ni].join("|")+")"+ns,Ia="(?:"+[Yn+Ii+"?",Ii,Hi,ni,Ei].join("|")+")",pn=RegExp(ln,"g"),xa=RegExp(Ii,"g"),Ki=RegExp(Ui+"(?="+Ui+")|"+Ia+ns,"g"),ss=RegExp([ur+"?"+Wn+"+"+Qn+"(?="+[fn,ur,"$"].join("|")+")",Lr+"+"+es+"(?="+[fn,ur+Xn,"$"].join("|")+")",ur+"?"+Xn+"+"+Qn,ur+"+"+es,is,Br,Gn,ki].join("|"),"g"),as=RegExp("["+Zn+zi+kn+Bn+"]"),xi=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,os=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Sa=-1,Be={};Be[ht]=Be[Ue]=Be[Ot]=Be[$t]=Be[Ht]=Be[kt]=Be[zt]=Be[Wt]=Be[rr]=!0,Be[be]=Be[St]=Be[$e]=Be[M]=Be[Ve]=Be[R]=Be[P]=Be[ae]=Be[Pe]=Be[je]=Be[Te]=Be[st]=Be[ze]=Be[Ze]=Be[ke]=!1;var Ke={};Ke[be]=Ke[St]=Ke[$e]=Ke[Ve]=Ke[M]=Ke[R]=Ke[ht]=Ke[Ue]=Ke[Ot]=Ke[$t]=Ke[Ht]=Ke[Pe]=Ke[je]=Ke[Te]=Ke[st]=Ke[ze]=Ke[Ze]=Ke[Xe]=Ke[kt]=Ke[zt]=Ke[Wt]=Ke[rr]=!0,Ke[P]=Ke[ae]=Ke[ke]=!1;var m={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"},C={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},B={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},ie={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Ge=parseFloat,Ie=parseInt,et=typeof zn=="object"&&zn&&zn.Object===Object&&zn,Ft=typeof self=="object"&&self&&self.Object===Object&&self,Ne=et||Ft||Function("return this")(),We=i&&!i.nodeType&&i,bt=We&&!0&&h&&!h.nodeType&&h,ir=bt&&bt.exports===We,Dt=ir&&et.process,tt=function(){try{var A=bt&&bt.require&&bt.require("util").types;return A||Dt&&Dt.binding&&Dt.binding("util")}catch{}}(),Yt=tt&&tt.isArrayBuffer,Tr=tt&&tt.isDate,_r=tt&&tt.isMap,Mr=tt&&tt.isRegExp,dn=tt&&tt.isSet,Si=tt&&tt.isTypedArray;function qt(A,q,D){switch(D.length){case 0:return A.call(q);case 1:return A.call(q,D[0]);case 2:return A.call(q,D[0],D[1]);case 3:return A.call(q,D[0],D[1],D[2])}return A.apply(q,D)}function ef(A,q,D,ne){for(var Ee=-1,Me=A==null?0:A.length;++Ee<Me;){var Lt=A[Ee];q(ne,Lt,D(Lt),A)}return ne}function mr(A,q){for(var D=-1,ne=A==null?0:A.length;++D<ne&&q(A[D],D,A)!==!1;);return A}function tf(A,q){for(var D=A==null?0:A.length;D--&&q(A[D],D,A)!==!1;);return A}function _c(A,q){for(var D=-1,ne=A==null?0:A.length;++D<ne;)if(!q(A[D],D,A))return!1;return!0}function si(A,q){for(var D=-1,ne=A==null?0:A.length,Ee=0,Me=[];++D<ne;){var Lt=A[D];q(Lt,D,A)&&(Me[Ee++]=Lt)}return Me}function cs(A,q){var D=A==null?0:A.length;return!!D&&Vi(A,q,0)>-1}function Pa(A,q,D){for(var ne=-1,Ee=A==null?0:A.length;++ne<Ee;)if(D(q,A[ne]))return!0;return!1}function nt(A,q){for(var D=-1,ne=A==null?0:A.length,Ee=Array(ne);++D<ne;)Ee[D]=q(A[D],D,A);return Ee}function ai(A,q){for(var D=-1,ne=q.length,Ee=A.length;++D<ne;)A[Ee+D]=q[D];return A}function Oa(A,q,D,ne){var Ee=-1,Me=A==null?0:A.length;for(ne&&Me&&(D=A[++Ee]);++Ee<Me;)D=q(D,A[Ee],Ee,A);return D}function rf(A,q,D,ne){var Ee=A==null?0:A.length;for(ne&&Ee&&(D=A[--Ee]);Ee--;)D=q(D,A[Ee],Ee,A);return D}function Ca(A,q){for(var D=-1,ne=A==null?0:A.length;++D<ne;)if(q(A[D],D,A))return!0;return!1}var nf=Aa("length");function sf(A){return A.split("")}function af(A){return A.match(Nt)||[]}function mc(A,q,D){var ne;return D(A,function(Ee,Me,Lt){if(q(Ee,Me,Lt))return ne=Me,!1}),ne}function us(A,q,D,ne){for(var Ee=A.length,Me=D+(ne?1:-1);ne?Me--:++Me<Ee;)if(q(A[Me],Me,A))return Me;return-1}function Vi(A,q,D){return q===q?_f(A,q,D):us(A,wc,D)}function of(A,q,D,ne){for(var Ee=D-1,Me=A.length;++Ee<Me;)if(ne(A[Ee],q))return Ee;return-1}function wc(A){return A!==A}function bc(A,q){var D=A==null?0:A.length;return D?Ra(A,q)/D:$}function Aa(A){return function(q){return q==null?r:q[A]}}function Ta(A){return function(q){return A==null?r:A[q]}}function Ec(A,q,D,ne,Ee){return Ee(A,function(Me,Lt,Je){D=ne?(ne=!1,Me):q(D,Me,Lt,Je)}),D}function cf(A,q){var D=A.length;for(A.sort(q);D--;)A[D]=A[D].value;return A}function Ra(A,q){for(var D,ne=-1,Ee=A.length;++ne<Ee;){var Me=q(A[ne]);Me!==r&&(D=D===r?Me:D+Me)}return D}function Na(A,q){for(var D=-1,ne=Array(A);++D<A;)ne[D]=q(D);return ne}function uf(A,q){return nt(q,function(D){return[D,A[D]]})}function Ic(A){return A&&A.slice(0,Oc(A)+1).replace(gt,"")}function hr(A){return function(q){return A(q)}}function Fa(A,q){return nt(q,function(D){return A[D]})}function gn(A,q){return A.has(q)}function xc(A,q){for(var D=-1,ne=A.length;++D<ne&&Vi(q,A[D],0)>-1;);return D}function Sc(A,q){for(var D=A.length;D--&&Vi(q,A[D],0)>-1;);return D}function hf(A,q){for(var D=A.length,ne=0;D--;)A[D]===q&&++ne;return ne}var lf=Ta(m),ff=Ta(C);function pf(A){return"\\"+ie[A]}function df(A,q){return A==null?r:A[q]}function Bi(A){return as.test(A)}function gf(A){return xi.test(A)}function yf(A){for(var q,D=[];!(q=A.next()).done;)D.push(q.value);return D}function Da(A){var q=-1,D=Array(A.size);return A.forEach(function(ne,Ee){D[++q]=[Ee,ne]}),D}function Pc(A,q){return function(D){return A(q(D))}}function oi(A,q){for(var D=-1,ne=A.length,Ee=0,Me=[];++D<ne;){var Lt=A[D];(Lt===q||Lt===U)&&(A[D]=U,Me[Ee++]=D)}return Me}function hs(A){var q=-1,D=Array(A.size);return A.forEach(function(ne){D[++q]=ne}),D}function vf(A){var q=-1,D=Array(A.size);return A.forEach(function(ne){D[++q]=[ne,ne]}),D}function _f(A,q,D){for(var ne=D-1,Ee=A.length;++ne<Ee;)if(A[ne]===q)return ne;return-1}function mf(A,q,D){for(var ne=D+1;ne--;)if(A[ne]===q)return ne;return ne}function Gi(A){return Bi(A)?bf(A):nf(A)}function Rr(A){return Bi(A)?Ef(A):sf(A)}function Oc(A){for(var q=A.length;q--&&wt.test(A.charAt(q)););return q}var wf=Ta(B);function bf(A){for(var q=Ki.lastIndex=0;Ki.test(A);)++q;return q}function Ef(A){return A.match(Ki)||[]}function If(A){return A.match(ss)||[]}var xf=function A(q){q=q==null?Ne:Wi.defaults(Ne.Object(),q,Wi.pick(Ne,os));var D=q.Array,ne=q.Date,Ee=q.Error,Me=q.Function,Lt=q.Math,Je=q.Object,ja=q.RegExp,Sf=q.String,wr=q.TypeError,ls=D.prototype,Pf=Me.prototype,Ji=Je.prototype,fs=q["__core-js_shared__"],ps=Pf.toString,He=Ji.hasOwnProperty,Of=0,Cc=function(){var e=/[^.]+$/.exec(fs&&fs.keys&&fs.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),ds=Ji.toString,Cf=ps.call(Je),Af=Ne._,Tf=ja("^"+ps.call(He).replace(dt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),gs=ir?q.Buffer:r,ci=q.Symbol,ys=q.Uint8Array,Ac=gs?gs.allocUnsafe:r,vs=Pc(Je.getPrototypeOf,Je),Tc=Je.create,Rc=Ji.propertyIsEnumerable,_s=ls.splice,Nc=ci?ci.isConcatSpreadable:r,yn=ci?ci.iterator:r,Pi=ci?ci.toStringTag:r,ms=function(){try{var e=Ri(Je,"defineProperty");return e({},"",{}),e}catch{}}(),Rf=q.clearTimeout!==Ne.clearTimeout&&q.clearTimeout,Nf=ne&&ne.now!==Ne.Date.now&&ne.now,Ff=q.setTimeout!==Ne.setTimeout&&q.setTimeout,ws=Lt.ceil,bs=Lt.floor,$a=Je.getOwnPropertySymbols,Df=gs?gs.isBuffer:r,Fc=q.isFinite,jf=ls.join,$f=Pc(Je.keys,Je),Mt=Lt.max,Bt=Lt.min,Lf=ne.now,Mf=q.parseInt,Dc=Lt.random,zf=ls.reverse,La=Ri(q,"DataView"),vn=Ri(q,"Map"),Ma=Ri(q,"Promise"),Yi=Ri(q,"Set"),_n=Ri(q,"WeakMap"),mn=Ri(Je,"create"),Es=_n&&new _n,Zi={},qf=Ni(La),Uf=Ni(vn),Hf=Ni(Ma),kf=Ni(Yi),Kf=Ni(_n),Is=ci?ci.prototype:r,wn=Is?Is.valueOf:r,jc=Is?Is.toString:r;function p(e){if(vt(e)&&!xe(e)&&!(e instanceof Re)){if(e instanceof br)return e;if(He.call(e,"__wrapped__"))return $u(e)}return new br(e)}var Xi=function(){function e(){}return function(t){if(!ct(t))return{};if(Tc)return Tc(t);e.prototype=t;var n=new e;return e.prototype=r,n}}();function xs(){}function br(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=r}p.templateSettings={escape:ft,evaluate:pt,interpolate:ot,variable:"",imports:{_:p}},p.prototype=xs.prototype,p.prototype.constructor=p,br.prototype=Xi(xs.prototype),br.prototype.constructor=br;function Re(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=Y,this.__views__=[]}function Vf(){var e=new Re(this.__wrapped__);return e.__actions__=nr(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=nr(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=nr(this.__views__),e}function Bf(){if(this.__filtered__){var e=new Re(this);e.__dir__=-1,e.__filtered__=!0}else e=this.clone(),e.__dir__*=-1;return e}function Gf(){var e=this.__wrapped__.value(),t=this.__dir__,n=xe(e),o=t<0,u=n?e.length:0,d=sd(0,u,this.__views__),b=d.start,I=d.end,T=I-b,H=o?I:b-1,k=this.__iteratees__,G=k.length,te=0,ce=Bt(T,this.__takeCount__);if(!n||!o&&u==T&&ce==T)return su(e,this.__actions__);var ve=[];e:for(;T--&&te<ce;){H+=t;for(var Oe=-1,_e=e[H];++Oe<G;){var Ae=k[Oe],Fe=Ae.iteratee,pr=Ae.type,Qt=Fe(_e);if(pr==g)_e=Qt;else if(!Qt){if(pr==y)continue e;break e}}ve[te++]=_e}return ve}Re.prototype=Xi(xs.prototype),Re.prototype.constructor=Re;function Oi(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var o=e[t];this.set(o[0],o[1])}}function Wf(){this.__data__=mn?mn(null):{},this.size=0}function Jf(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}function Yf(e){var t=this.__data__;if(mn){var n=t[e];return n===x?r:n}return He.call(t,e)?t[e]:r}function Zf(e){var t=this.__data__;return mn?t[e]!==r:He.call(t,e)}function Xf(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=mn&&t===r?x:t,this}Oi.prototype.clear=Wf,Oi.prototype.delete=Jf,Oi.prototype.get=Yf,Oi.prototype.has=Zf,Oi.prototype.set=Xf;function Gr(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var o=e[t];this.set(o[0],o[1])}}function Qf(){this.__data__=[],this.size=0}function ep(e){var t=this.__data__,n=Ss(t,e);if(n<0)return!1;var o=t.length-1;return n==o?t.pop():_s.call(t,n,1),--this.size,!0}function tp(e){var t=this.__data__,n=Ss(t,e);return n<0?r:t[n][1]}function rp(e){return Ss(this.__data__,e)>-1}function ip(e,t){var n=this.__data__,o=Ss(n,e);return o<0?(++this.size,n.push([e,t])):n[o][1]=t,this}Gr.prototype.clear=Qf,Gr.prototype.delete=ep,Gr.prototype.get=tp,Gr.prototype.has=rp,Gr.prototype.set=ip;function Wr(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var o=e[t];this.set(o[0],o[1])}}function np(){this.size=0,this.__data__={hash:new Oi,map:new(vn||Gr),string:new Oi}}function sp(e){var t=Ls(this,e).delete(e);return this.size-=t?1:0,t}function ap(e){return Ls(this,e).get(e)}function op(e){return Ls(this,e).has(e)}function cp(e,t){var n=Ls(this,e),o=n.size;return n.set(e,t),this.size+=n.size==o?0:1,this}Wr.prototype.clear=np,Wr.prototype.delete=sp,Wr.prototype.get=ap,Wr.prototype.has=op,Wr.prototype.set=cp;function Ci(e){var t=-1,n=e==null?0:e.length;for(this.__data__=new Wr;++t<n;)this.add(e[t])}function up(e){return this.__data__.set(e,x),this}function hp(e){return this.__data__.has(e)}Ci.prototype.add=Ci.prototype.push=up,Ci.prototype.has=hp;function Nr(e){var t=this.__data__=new Gr(e);this.size=t.size}function lp(){this.__data__=new Gr,this.size=0}function fp(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}function pp(e){return this.__data__.get(e)}function dp(e){return this.__data__.has(e)}function gp(e,t){var n=this.__data__;if(n instanceof Gr){var o=n.__data__;if(!vn||o.length<a-1)return o.push([e,t]),this.size=++n.size,this;n=this.__data__=new Wr(o)}return n.set(e,t),this.size=n.size,this}Nr.prototype.clear=lp,Nr.prototype.delete=fp,Nr.prototype.get=pp,Nr.prototype.has=dp,Nr.prototype.set=gp;function $c(e,t){var n=xe(e),o=!n&&Fi(e),u=!n&&!o&&pi(e),d=!n&&!o&&!u&&rn(e),b=n||o||u||d,I=b?Na(e.length,Sf):[],T=I.length;for(var H in e)(t||He.call(e,H))&&!(b&&(H=="length"||u&&(H=="offset"||H=="parent")||d&&(H=="buffer"||H=="byteLength"||H=="byteOffset")||Xr(H,T)))&&I.push(H);return I}function Lc(e){var t=e.length;return t?e[Ja(0,t-1)]:r}function yp(e,t){return Ms(nr(e),Ai(t,0,e.length))}function vp(e){return Ms(nr(e))}function za(e,t,n){(n!==r&&!Fr(e[t],n)||n===r&&!(t in e))&&Jr(e,t,n)}function bn(e,t,n){var o=e[t];(!(He.call(e,t)&&Fr(o,n))||n===r&&!(t in e))&&Jr(e,t,n)}function Ss(e,t){for(var n=e.length;n--;)if(Fr(e[n][0],t))return n;return-1}function _p(e,t,n,o){return ui(e,function(u,d,b){t(o,u,n(u),b)}),o}function Mc(e,t){return e&&qr(t,Ut(t),e)}function mp(e,t){return e&&qr(t,ar(t),e)}function Jr(e,t,n){t=="__proto__"&&ms?ms(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function qa(e,t){for(var n=-1,o=t.length,u=D(o),d=e==null;++n<o;)u[n]=d?r:bo(e,t[n]);return u}function Ai(e,t,n){return e===e&&(n!==r&&(e=e<=n?e:n),t!==r&&(e=e>=t?e:t)),e}function Er(e,t,n,o,u,d){var b,I=t&X,T=t&Q,H=t&ee;if(n&&(b=u?n(e,o,u,d):n(e)),b!==r)return b;if(!ct(e))return e;var k=xe(e);if(k){if(b=od(e),!I)return nr(e,b)}else{var G=Gt(e),te=G==ae||G==we;if(pi(e))return cu(e,I);if(G==Te||G==be||te&&!u){if(b=T||te?{}:Ou(e),!I)return T?Yp(e,mp(b,e)):Jp(e,Mc(b,e))}else{if(!Ke[G])return u?e:{};b=cd(e,G,I)}}d||(d=new Nr);var ce=d.get(e);if(ce)return ce;d.set(e,b),rh(e)?e.forEach(function(_e){b.add(Er(_e,t,n,_e,e,d))}):eh(e)&&e.forEach(function(_e,Ae){b.set(Ae,Er(_e,t,n,Ae,e,d))});var ve=H?T?ao:so:T?ar:Ut,Oe=k?r:ve(e);return mr(Oe||e,function(_e,Ae){Oe&&(Ae=_e,_e=e[Ae]),bn(b,Ae,Er(_e,t,n,Ae,e,d))}),b}function wp(e){var t=Ut(e);return function(n){return zc(n,e,t)}}function zc(e,t,n){var o=n.length;if(e==null)return!o;for(e=Je(e);o--;){var u=n[o],d=t[u],b=e[u];if(b===r&&!(u in e)||!d(b))return!1}return!0}function qc(e,t,n){if(typeof e!="function")throw new wr(w);return Cn(function(){e.apply(r,n)},t)}function En(e,t,n,o){var u=-1,d=cs,b=!0,I=e.length,T=[],H=t.length;if(!I)return T;n&&(t=nt(t,hr(n))),o?(d=Pa,b=!1):t.length>=a&&(d=gn,b=!1,t=new Ci(t));e:for(;++u<I;){var k=e[u],G=n==null?k:n(k);if(k=o||k!==0?k:0,b&&G===G){for(var te=H;te--;)if(t[te]===G)continue e;T.push(k)}else d(t,G,o)||T.push(k)}return T}var ui=pu(zr),Uc=pu(Ha,!0);function bp(e,t){var n=!0;return ui(e,function(o,u,d){return n=!!t(o,u,d),n}),n}function Ps(e,t,n){for(var o=-1,u=e.length;++o<u;){var d=e[o],b=t(d);if(b!=null&&(I===r?b===b&&!fr(b):n(b,I)))var I=b,T=d}return T}function Ep(e,t,n,o){var u=e.length;for(n=Se(n),n<0&&(n=-n>u?0:u+n),o=o===r||o>u?u:Se(o),o<0&&(o+=u),o=n>o?0:nh(o);n<o;)e[n++]=t;return e}function Hc(e,t){var n=[];return ui(e,function(o,u,d){t(o,u,d)&&n.push(o)}),n}function Kt(e,t,n,o,u){var d=-1,b=e.length;for(n||(n=hd),u||(u=[]);++d<b;){var I=e[d];t>0&&n(I)?t>1?Kt(I,t-1,n,o,u):ai(u,I):o||(u[u.length]=I)}return u}var Ua=du(),kc=du(!0);function zr(e,t){return e&&Ua(e,t,Ut)}function Ha(e,t){return e&&kc(e,t,Ut)}function Os(e,t){return si(t,function(n){return Qr(e[n])})}function Ti(e,t){t=li(t,e);for(var n=0,o=t.length;e!=null&&n<o;)e=e[Ur(t[n++])];return n&&n==o?e:r}function Kc(e,t,n){var o=t(e);return xe(e)?o:ai(o,n(e))}function Zt(e){return e==null?e===r?at:Le:Pi&&Pi in Je(e)?nd(e):vd(e)}function ka(e,t){return e>t}function Ip(e,t){return e!=null&&He.call(e,t)}function xp(e,t){return e!=null&&t in Je(e)}function Sp(e,t,n){return e>=Bt(t,n)&&e<Mt(t,n)}function Ka(e,t,n){for(var o=n?Pa:cs,u=e[0].length,d=e.length,b=d,I=D(d),T=1/0,H=[];b--;){var k=e[b];b&&t&&(k=nt(k,hr(t))),T=Bt(k.length,T),I[b]=!n&&(t||u>=120&&k.length>=120)?new Ci(b&&k):r}k=e[0];var G=-1,te=I[0];e:for(;++G<u&&H.length<T;){var ce=k[G],ve=t?t(ce):ce;if(ce=n||ce!==0?ce:0,!(te?gn(te,ve):o(H,ve,n))){for(b=d;--b;){var Oe=I[b];if(!(Oe?gn(Oe,ve):o(e[b],ve,n)))continue e}te&&te.push(ve),H.push(ce)}}return H}function Pp(e,t,n,o){return zr(e,function(u,d,b){t(o,n(u),d,b)}),o}function In(e,t,n){t=li(t,e),e=Ru(e,t);var o=e==null?e:e[Ur(xr(t))];return o==null?r:qt(o,e,n)}function Vc(e){return vt(e)&&Zt(e)==be}function Op(e){return vt(e)&&Zt(e)==$e}function Cp(e){return vt(e)&&Zt(e)==R}function xn(e,t,n,o,u){return e===t?!0:e==null||t==null||!vt(e)&&!vt(t)?e!==e&&t!==t:Ap(e,t,n,o,xn,u)}function Ap(e,t,n,o,u,d){var b=xe(e),I=xe(t),T=b?St:Gt(e),H=I?St:Gt(t);T=T==be?Te:T,H=H==be?Te:H;var k=T==Te,G=H==Te,te=T==H;if(te&&pi(e)){if(!pi(t))return!1;b=!0,k=!1}if(te&&!k)return d||(d=new Nr),b||rn(e)?xu(e,t,n,o,u,d):rd(e,t,T,n,o,u,d);if(!(n&V)){var ce=k&&He.call(e,"__wrapped__"),ve=G&&He.call(t,"__wrapped__");if(ce||ve){var Oe=ce?e.value():e,_e=ve?t.value():t;return d||(d=new Nr),u(Oe,_e,n,o,d)}}return te?(d||(d=new Nr),id(e,t,n,o,u,d)):!1}function Tp(e){return vt(e)&&Gt(e)==Pe}function Va(e,t,n,o){var u=n.length,d=u,b=!o;if(e==null)return!d;for(e=Je(e);u--;){var I=n[u];if(b&&I[2]?I[1]!==e[I[0]]:!(I[0]in e))return!1}for(;++u<d;){I=n[u];var T=I[0],H=e[T],k=I[1];if(b&&I[2]){if(H===r&&!(T in e))return!1}else{var G=new Nr;if(o)var te=o(H,k,T,e,t,G);if(!(te===r?xn(k,H,V|Z,o,G):te))return!1}}return!0}function Bc(e){if(!ct(e)||fd(e))return!1;var t=Qr(e)?Tf:ha;return t.test(Ni(e))}function Rp(e){return vt(e)&&Zt(e)==st}function Np(e){return vt(e)&&Gt(e)==ze}function Fp(e){return vt(e)&&Ks(e.length)&&!!Be[Zt(e)]}function Gc(e){return typeof e=="function"?e:e==null?or:typeof e=="object"?xe(e)?Yc(e[0],e[1]):Jc(e):gh(e)}function Ba(e){if(!On(e))return $f(e);var t=[];for(var n in Je(e))He.call(e,n)&&n!="constructor"&&t.push(n);return t}function Dp(e){if(!ct(e))return yd(e);var t=On(e),n=[];for(var o in e)o=="constructor"&&(t||!He.call(e,o))||n.push(o);return n}function Ga(e,t){return e<t}function Wc(e,t){var n=-1,o=sr(e)?D(e.length):[];return ui(e,function(u,d,b){o[++n]=t(u,d,b)}),o}function Jc(e){var t=co(e);return t.length==1&&t[0][2]?Au(t[0][0],t[0][1]):function(n){return n===e||Va(n,e,t)}}function Yc(e,t){return ho(e)&&Cu(t)?Au(Ur(e),t):function(n){var o=bo(n,e);return o===r&&o===t?Eo(n,e):xn(t,o,V|Z)}}function Cs(e,t,n,o,u){e!==t&&Ua(t,function(d,b){if(u||(u=new Nr),ct(d))jp(e,t,b,n,Cs,o,u);else{var I=o?o(fo(e,b),d,b+"",e,t,u):r;I===r&&(I=d),za(e,b,I)}},ar)}function jp(e,t,n,o,u,d,b){var I=fo(e,n),T=fo(t,n),H=b.get(T);if(H){za(e,n,H);return}var k=d?d(I,T,n+"",e,t,b):r,G=k===r;if(G){var te=xe(T),ce=!te&&pi(T),ve=!te&&!ce&&rn(T);k=T,te||ce||ve?xe(I)?k=I:Et(I)?k=nr(I):ce?(G=!1,k=cu(T,!0)):ve?(G=!1,k=uu(T,!0)):k=[]:An(T)||Fi(T)?(k=I,Fi(I)?k=sh(I):(!ct(I)||Qr(I))&&(k=Ou(T))):G=!1}G&&(b.set(T,k),u(k,T,o,d,b),b.delete(T)),za(e,n,k)}function Zc(e,t){var n=e.length;if(n)return t+=t<0?n:0,Xr(t,n)?e[t]:r}function Xc(e,t,n){t.length?t=nt(t,function(d){return xe(d)?function(b){return Ti(b,d.length===1?d[0]:d)}:d}):t=[or];var o=-1;t=nt(t,hr(pe()));var u=Wc(e,function(d,b,I){var T=nt(t,function(H){return H(d)});return{criteria:T,index:++o,value:d}});return cf(u,function(d,b){return Wp(d,b,n)})}function $p(e,t){return Qc(e,t,function(n,o){return Eo(e,o)})}function Qc(e,t,n){for(var o=-1,u=t.length,d={};++o<u;){var b=t[o],I=Ti(e,b);n(I,b)&&Sn(d,li(b,e),I)}return d}function Lp(e){return function(t){return Ti(t,e)}}function Wa(e,t,n,o){var u=o?of:Vi,d=-1,b=t.length,I=e;for(e===t&&(t=nr(t)),n&&(I=nt(e,hr(n)));++d<b;)for(var T=0,H=t[d],k=n?n(H):H;(T=u(I,k,T,o))>-1;)I!==e&&_s.call(I,T,1),_s.call(e,T,1);return e}function eu(e,t){for(var n=e?t.length:0,o=n-1;n--;){var u=t[n];if(n==o||u!==d){var d=u;Xr(u)?_s.call(e,u,1):Xa(e,u)}}return e}function Ja(e,t){return e+bs(Dc()*(t-e+1))}function Mp(e,t,n,o){for(var u=-1,d=Mt(ws((t-e)/(n||1)),0),b=D(d);d--;)b[o?d:++u]=e,e+=n;return b}function Ya(e,t){var n="";if(!e||t<1||t>J)return n;do t%2&&(n+=e),t=bs(t/2),t&&(e+=e);while(t);return n}function Ce(e,t){return po(Tu(e,t,or),e+"")}function zp(e){return Lc(nn(e))}function qp(e,t){var n=nn(e);return Ms(n,Ai(t,0,n.length))}function Sn(e,t,n,o){if(!ct(e))return e;t=li(t,e);for(var u=-1,d=t.length,b=d-1,I=e;I!=null&&++u<d;){var T=Ur(t[u]),H=n;if(T==="__proto__"||T==="constructor"||T==="prototype")return e;if(u!=b){var k=I[T];H=o?o(k,T,I):r,H===r&&(H=ct(k)?k:Xr(t[u+1])?[]:{})}bn(I,T,H),I=I[T]}return e}var tu=Es?function(e,t){return Es.set(e,t),e}:or,Up=ms?function(e,t){return ms(e,"toString",{configurable:!0,enumerable:!1,value:xo(t),writable:!0})}:or;function Hp(e){return Ms(nn(e))}function Ir(e,t,n){var o=-1,u=e.length;t<0&&(t=-t>u?0:u+t),n=n>u?u:n,n<0&&(n+=u),u=t>n?0:n-t>>>0,t>>>=0;for(var d=D(u);++o<u;)d[o]=e[o+t];return d}function kp(e,t){var n;return ui(e,function(o,u,d){return n=t(o,u,d),!n}),!!n}function As(e,t,n){var o=0,u=e==null?o:e.length;if(typeof t=="number"&&t===t&&u<=me){for(;o<u;){var d=o+u>>>1,b=e[d];b!==null&&!fr(b)&&(n?b<=t:b<t)?o=d+1:u=d}return u}return Za(e,t,or,n)}function Za(e,t,n,o){var u=0,d=e==null?0:e.length;if(d===0)return 0;t=n(t);for(var b=t!==t,I=t===null,T=fr(t),H=t===r;u<d;){var k=bs((u+d)/2),G=n(e[k]),te=G!==r,ce=G===null,ve=G===G,Oe=fr(G);if(b)var _e=o||ve;else H?_e=ve&&(o||te):I?_e=ve&&te&&(o||!ce):T?_e=ve&&te&&!ce&&(o||!Oe):ce||Oe?_e=!1:_e=o?G<=t:G<t;_e?u=k+1:d=k}return Bt(d,re)}function ru(e,t){for(var n=-1,o=e.length,u=0,d=[];++n<o;){var b=e[n],I=t?t(b):b;if(!n||!Fr(I,T)){var T=I;d[u++]=b===0?0:b}}return d}function iu(e){return typeof e=="number"?e:fr(e)?$:+e}function lr(e){if(typeof e=="string")return e;if(xe(e))return nt(e,lr)+"";if(fr(e))return jc?jc.call(e):"";var t=e+"";return t=="0"&&1/e==-W?"-0":t}function hi(e,t,n){var o=-1,u=cs,d=e.length,b=!0,I=[],T=I;if(n)b=!1,u=Pa;else if(d>=a){var H=t?null:ed(e);if(H)return hs(H);b=!1,u=gn,T=new Ci}else T=t?[]:I;e:for(;++o<d;){var k=e[o],G=t?t(k):k;if(k=n||k!==0?k:0,b&&G===G){for(var te=T.length;te--;)if(T[te]===G)continue e;t&&T.push(G),I.push(k)}else u(T,G,n)||(T!==I&&T.push(G),I.push(k))}return I}function Xa(e,t){return t=li(t,e),e=Ru(e,t),e==null||delete e[Ur(xr(t))]}function nu(e,t,n,o){return Sn(e,t,n(Ti(e,t)),o)}function Ts(e,t,n,o){for(var u=e.length,d=o?u:-1;(o?d--:++d<u)&&t(e[d],d,e););return n?Ir(e,o?0:d,o?d+1:u):Ir(e,o?d+1:0,o?u:d)}function su(e,t){var n=e;return n instanceof Re&&(n=n.value()),Oa(t,function(o,u){return u.func.apply(u.thisArg,ai([o],u.args))},n)}function Qa(e,t,n){var o=e.length;if(o<2)return o?hi(e[0]):[];for(var u=-1,d=D(o);++u<o;)for(var b=e[u],I=-1;++I<o;)I!=u&&(d[u]=En(d[u]||b,e[I],t,n));return hi(Kt(d,1),t,n)}function au(e,t,n){for(var o=-1,u=e.length,d=t.length,b={};++o<u;){var I=o<d?t[o]:r;n(b,e[o],I)}return b}function eo(e){return Et(e)?e:[]}function to(e){return typeof e=="function"?e:or}function li(e,t){return xe(e)?e:ho(e,t)?[e]:ju(qe(e))}var Kp=Ce;function fi(e,t,n){var o=e.length;return n=n===r?o:n,!t&&n>=o?e:Ir(e,t,n)}var ou=Rf||function(e){return Ne.clearTimeout(e)};function cu(e,t){if(t)return e.slice();var n=e.length,o=Ac?Ac(n):new e.constructor(n);return e.copy(o),o}function ro(e){var t=new e.constructor(e.byteLength);return new ys(t).set(new ys(e)),t}function Vp(e,t){var n=t?ro(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}function Bp(e){var t=new e.constructor(e.source,vr.exec(e));return t.lastIndex=e.lastIndex,t}function Gp(e){return wn?Je(wn.call(e)):{}}function uu(e,t){var n=t?ro(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}function hu(e,t){if(e!==t){var n=e!==r,o=e===null,u=e===e,d=fr(e),b=t!==r,I=t===null,T=t===t,H=fr(t);if(!I&&!H&&!d&&e>t||d&&b&&T&&!I&&!H||o&&b&&T||!n&&T||!u)return 1;if(!o&&!d&&!H&&e<t||H&&n&&u&&!o&&!d||I&&n&&u||!b&&u||!T)return-1}return 0}function Wp(e,t,n){for(var o=-1,u=e.criteria,d=t.criteria,b=u.length,I=n.length;++o<b;){var T=hu(u[o],d[o]);if(T){if(o>=I)return T;var H=n[o];return T*(H=="desc"?-1:1)}}return e.index-t.index}function lu(e,t,n,o){for(var u=-1,d=e.length,b=n.length,I=-1,T=t.length,H=Mt(d-b,0),k=D(T+H),G=!o;++I<T;)k[I]=t[I];for(;++u<b;)(G||u<d)&&(k[n[u]]=e[u]);for(;H--;)k[I++]=e[u++];return k}function fu(e,t,n,o){for(var u=-1,d=e.length,b=-1,I=n.length,T=-1,H=t.length,k=Mt(d-I,0),G=D(k+H),te=!o;++u<k;)G[u]=e[u];for(var ce=u;++T<H;)G[ce+T]=t[T];for(;++b<I;)(te||u<d)&&(G[ce+n[b]]=e[u++]);return G}function nr(e,t){var n=-1,o=e.length;for(t||(t=D(o));++n<o;)t[n]=e[n];return t}function qr(e,t,n,o){var u=!n;n||(n={});for(var d=-1,b=t.length;++d<b;){var I=t[d],T=o?o(n[I],e[I],I,n,e):r;T===r&&(T=e[I]),u?Jr(n,I,T):bn(n,I,T)}return n}function Jp(e,t){return qr(e,uo(e),t)}function Yp(e,t){return qr(e,Su(e),t)}function Rs(e,t){return function(n,o){var u=xe(n)?ef:_p,d=t?t():{};return u(n,e,pe(o,2),d)}}function Qi(e){return Ce(function(t,n){var o=-1,u=n.length,d=u>1?n[u-1]:r,b=u>2?n[2]:r;for(d=e.length>3&&typeof d=="function"?(u--,d):r,b&&Xt(n[0],n[1],b)&&(d=u<3?r:d,u=1),t=Je(t);++o<u;){var I=n[o];I&&e(t,I,o,d)}return t})}function pu(e,t){return function(n,o){if(n==null)return n;if(!sr(n))return e(n,o);for(var u=n.length,d=t?u:-1,b=Je(n);(t?d--:++d<u)&&o(b[d],d,b)!==!1;);return n}}function du(e){return function(t,n,o){for(var u=-1,d=Je(t),b=o(t),I=b.length;I--;){var T=b[e?I:++u];if(n(d[T],T,d)===!1)break}return t}}function Zp(e,t,n){var o=t&oe,u=Pn(e);function d(){var b=this&&this!==Ne&&this instanceof d?u:e;return b.apply(o?n:this,arguments)}return d}function gu(e){return function(t){t=qe(t);var n=Bi(t)?Rr(t):r,o=n?n[0]:t.charAt(0),u=n?fi(n,1).join(""):t.slice(1);return o[e]()+u}}function en(e){return function(t){return Oa(ph(fh(t).replace(pn,"")),e,"")}}function Pn(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var n=Xi(e.prototype),o=e.apply(n,t);return ct(o)?o:n}}function Xp(e,t,n){var o=Pn(e);function u(){for(var d=arguments.length,b=D(d),I=d,T=tn(u);I--;)b[I]=arguments[I];var H=d<3&&b[0]!==T&&b[d-1]!==T?[]:oi(b,T);if(d-=H.length,d<n)return wu(e,t,Ns,u.placeholder,r,b,H,r,r,n-d);var k=this&&this!==Ne&&this instanceof u?o:e;return qt(k,this,b)}return u}function yu(e){return function(t,n,o){var u=Je(t);if(!sr(t)){var d=pe(n,3);t=Ut(t),n=function(I){return d(u[I],I,u)}}var b=e(t,n,o);return b>-1?u[d?t[b]:b]:r}}function vu(e){return Zr(function(t){var n=t.length,o=n,u=br.prototype.thru;for(e&&t.reverse();o--;){var d=t[o];if(typeof d!="function")throw new wr(w);if(u&&!b&&$s(d)=="wrapper")var b=new br([],!0)}for(o=b?o:n;++o<n;){d=t[o];var I=$s(d),T=I=="wrapper"?oo(d):r;T&&lo(T[0])&&T[1]==(K|fe|le|F)&&!T[4].length&&T[9]==1?b=b[$s(T[0])].apply(b,T[3]):b=d.length==1&&lo(d)?b[I]():b.thru(d)}return function(){var H=arguments,k=H[0];if(b&&H.length==1&&xe(k))return b.plant(k).value();for(var G=0,te=n?t[G].apply(this,H):k;++G<n;)te=t[G].call(this,te);return te}})}function Ns(e,t,n,o,u,d,b,I,T,H){var k=t&K,G=t&oe,te=t&ge,ce=t&(fe|he),ve=t&ue,Oe=te?r:Pn(e);function _e(){for(var Ae=arguments.length,Fe=D(Ae),pr=Ae;pr--;)Fe[pr]=arguments[pr];if(ce)var Qt=tn(_e),dr=hf(Fe,Qt);if(o&&(Fe=lu(Fe,o,u,ce)),d&&(Fe=fu(Fe,d,b,ce)),Ae-=dr,ce&&Ae<H){var It=oi(Fe,Qt);return wu(e,t,Ns,_e.placeholder,n,Fe,It,I,T,H-Ae)}var Dr=G?n:this,ti=te?Dr[e]:e;return Ae=Fe.length,I?Fe=_d(Fe,I):ve&&Ae>1&&Fe.reverse(),k&&T<Ae&&(Fe.length=T),this&&this!==Ne&&this instanceof _e&&(ti=Oe||Pn(ti)),ti.apply(Dr,Fe)}return _e}function _u(e,t){return function(n,o){return Pp(n,e,t(o),{})}}function Fs(e,t){return function(n,o){var u;if(n===r&&o===r)return t;if(n!==r&&(u=n),o!==r){if(u===r)return o;typeof n=="string"||typeof o=="string"?(n=lr(n),o=lr(o)):(n=iu(n),o=iu(o)),u=e(n,o)}return u}}function io(e){return Zr(function(t){return t=nt(t,hr(pe())),Ce(function(n){var o=this;return e(t,function(u){return qt(u,o,n)})})})}function Ds(e,t){t=t===r?" ":lr(t);var n=t.length;if(n<2)return n?Ya(t,e):t;var o=Ya(t,ws(e/Gi(t)));return Bi(t)?fi(Rr(o),0,e).join(""):o.slice(0,e)}function Qp(e,t,n,o){var u=t&oe,d=Pn(e);function b(){for(var I=-1,T=arguments.length,H=-1,k=o.length,G=D(k+T),te=this&&this!==Ne&&this instanceof b?d:e;++H<k;)G[H]=o[H];for(;T--;)G[H++]=arguments[++I];return qt(te,u?n:this,G)}return b}function mu(e){return function(t,n,o){return o&&typeof o!="number"&&Xt(t,n,o)&&(n=o=r),t=ei(t),n===r?(n=t,t=0):n=ei(n),o=o===r?t<n?1:-1:ei(o),Mp(t,n,o,e)}}function js(e){return function(t,n){return typeof t=="string"&&typeof n=="string"||(t=Sr(t),n=Sr(n)),e(t,n)}}function wu(e,t,n,o,u,d,b,I,T,H){var k=t&fe,G=k?b:r,te=k?r:b,ce=k?d:r,ve=k?r:d;t|=k?le:L,t&=~(k?L:le),t&ye||(t&=~(oe|ge));var Oe=[e,t,u,ce,G,ve,te,I,T,H],_e=n.apply(r,Oe);return lo(e)&&Nu(_e,Oe),_e.placeholder=o,Fu(_e,e,t)}function no(e){var t=Lt[e];return function(n,o){if(n=Sr(n),o=o==null?0:Bt(Se(o),292),o&&Fc(n)){var u=(qe(n)+"e").split("e"),d=t(u[0]+"e"+(+u[1]+o));return u=(qe(d)+"e").split("e"),+(u[0]+"e"+(+u[1]-o))}return t(n)}}var ed=Yi&&1/hs(new Yi([,-0]))[1]==W?function(e){return new Yi(e)}:Oo;function bu(e){return function(t){var n=Gt(t);return n==Pe?Da(t):n==ze?vf(t):uf(t,e(t))}}function Yr(e,t,n,o,u,d,b,I){var T=t&ge;if(!T&&typeof e!="function")throw new wr(w);var H=o?o.length:0;if(H||(t&=~(le|L),o=u=r),b=b===r?b:Mt(Se(b),0),I=I===r?I:Se(I),H-=u?u.length:0,t&L){var k=o,G=u;o=u=r}var te=T?r:oo(e),ce=[e,t,n,o,u,k,G,d,b,I];if(te&&gd(ce,te),e=ce[0],t=ce[1],n=ce[2],o=ce[3],u=ce[4],I=ce[9]=ce[9]===r?T?0:e.length:Mt(ce[9]-H,0),!I&&t&(fe|he)&&(t&=~(fe|he)),!t||t==oe)var ve=Zp(e,t,n);else t==fe||t==he?ve=Xp(e,t,I):(t==le||t==(oe|le))&&!u.length?ve=Qp(e,t,n,o):ve=Ns.apply(r,ce);var Oe=te?tu:Nu;return Fu(Oe(ve,ce),e,t)}function Eu(e,t,n,o){return e===r||Fr(e,Ji[n])&&!He.call(o,n)?t:e}function Iu(e,t,n,o,u,d){return ct(e)&&ct(t)&&(d.set(t,e),Cs(e,t,r,Iu,d),d.delete(t)),e}function td(e){return An(e)?r:e}function xu(e,t,n,o,u,d){var b=n&V,I=e.length,T=t.length;if(I!=T&&!(b&&T>I))return!1;var H=d.get(e),k=d.get(t);if(H&&k)return H==t&&k==e;var G=-1,te=!0,ce=n&Z?new Ci:r;for(d.set(e,t),d.set(t,e);++G<I;){var ve=e[G],Oe=t[G];if(o)var _e=b?o(Oe,ve,G,t,e,d):o(ve,Oe,G,e,t,d);if(_e!==r){if(_e)continue;te=!1;break}if(ce){if(!Ca(t,function(Ae,Fe){if(!gn(ce,Fe)&&(ve===Ae||u(ve,Ae,n,o,d)))return ce.push(Fe)})){te=!1;break}}else if(!(ve===Oe||u(ve,Oe,n,o,d))){te=!1;break}}return d.delete(e),d.delete(t),te}function rd(e,t,n,o,u,d,b){switch(n){case Ve:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case $e:return!(e.byteLength!=t.byteLength||!d(new ys(e),new ys(t)));case M:case R:case je:return Fr(+e,+t);case P:return e.name==t.name&&e.message==t.message;case st:case Ze:return e==t+"";case Pe:var I=Da;case ze:var T=o&V;if(I||(I=hs),e.size!=t.size&&!T)return!1;var H=b.get(e);if(H)return H==t;o|=Z,b.set(e,t);var k=xu(I(e),I(t),o,u,d,b);return b.delete(e),k;case Xe:if(wn)return wn.call(e)==wn.call(t)}return!1}function id(e,t,n,o,u,d){var b=n&V,I=so(e),T=I.length,H=so(t),k=H.length;if(T!=k&&!b)return!1;for(var G=T;G--;){var te=I[G];if(!(b?te in t:He.call(t,te)))return!1}var ce=d.get(e),ve=d.get(t);if(ce&&ve)return ce==t&&ve==e;var Oe=!0;d.set(e,t),d.set(t,e);for(var _e=b;++G<T;){te=I[G];var Ae=e[te],Fe=t[te];if(o)var pr=b?o(Fe,Ae,te,t,e,d):o(Ae,Fe,te,e,t,d);if(!(pr===r?Ae===Fe||u(Ae,Fe,n,o,d):pr)){Oe=!1;break}_e||(_e=te=="constructor")}if(Oe&&!_e){var Qt=e.constructor,dr=t.constructor;Qt!=dr&&"constructor"in e&&"constructor"in t&&!(typeof Qt=="function"&&Qt instanceof Qt&&typeof dr=="function"&&dr instanceof dr)&&(Oe=!1)}return d.delete(e),d.delete(t),Oe}function Zr(e){return po(Tu(e,r,zu),e+"")}function so(e){return Kc(e,Ut,uo)}function ao(e){return Kc(e,ar,Su)}var oo=Es?function(e){return Es.get(e)}:Oo;function $s(e){for(var t=e.name+"",n=Zi[t],o=He.call(Zi,t)?n.length:0;o--;){var u=n[o],d=u.func;if(d==null||d==e)return u.name}return t}function tn(e){var t=He.call(p,"placeholder")?p:e;return t.placeholder}function pe(){var e=p.iteratee||So;return e=e===So?Gc:e,arguments.length?e(arguments[0],arguments[1]):e}function Ls(e,t){var n=e.__data__;return ld(t)?n[typeof t=="string"?"string":"hash"]:n.map}function co(e){for(var t=Ut(e),n=t.length;n--;){var o=t[n],u=e[o];t[n]=[o,u,Cu(u)]}return t}function Ri(e,t){var n=df(e,t);return Bc(n)?n:r}function nd(e){var t=He.call(e,Pi),n=e[Pi];try{e[Pi]=r;var o=!0}catch{}var u=ds.call(e);return o&&(t?e[Pi]=n:delete e[Pi]),u}var uo=$a?function(e){return e==null?[]:(e=Je(e),si($a(e),function(t){return Rc.call(e,t)}))}:Co,Su=$a?function(e){for(var t=[];e;)ai(t,uo(e)),e=vs(e);return t}:Co,Gt=Zt;(La&&Gt(new La(new ArrayBuffer(1)))!=Ve||vn&&Gt(new vn)!=Pe||Ma&&Gt(Ma.resolve())!=Pt||Yi&&Gt(new Yi)!=ze||_n&&Gt(new _n)!=ke)&&(Gt=function(e){var t=Zt(e),n=t==Te?e.constructor:r,o=n?Ni(n):"";if(o)switch(o){case qf:return Ve;case Uf:return Pe;case Hf:return Pt;case kf:return ze;case Kf:return ke}return t});function sd(e,t,n){for(var o=-1,u=n.length;++o<u;){var d=n[o],b=d.size;switch(d.type){case"drop":e+=b;break;case"dropRight":t-=b;break;case"take":t=Bt(t,e+b);break;case"takeRight":e=Mt(e,t-b);break}}return{start:e,end:t}}function ad(e){var t=e.match(Ye);return t?t[1].split(Rt):[]}function Pu(e,t,n){t=li(t,e);for(var o=-1,u=t.length,d=!1;++o<u;){var b=Ur(t[o]);if(!(d=e!=null&&n(e,b)))break;e=e[b]}return d||++o!=u?d:(u=e==null?0:e.length,!!u&&Ks(u)&&Xr(b,u)&&(xe(e)||Fi(e)))}function od(e){var t=e.length,n=new e.constructor(t);return t&&typeof e[0]=="string"&&He.call(e,"index")&&(n.index=e.index,n.input=e.input),n}function Ou(e){return typeof e.constructor=="function"&&!On(e)?Xi(vs(e)):{}}function cd(e,t,n){var o=e.constructor;switch(t){case $e:return ro(e);case M:case R:return new o(+e);case Ve:return Vp(e,n);case ht:case Ue:case Ot:case $t:case Ht:case kt:case zt:case Wt:case rr:return uu(e,n);case Pe:return new o;case je:case Ze:return new o(e);case st:return Bp(e);case ze:return new o;case Xe:return Gp(e)}}function ud(e,t){var n=t.length;if(!n)return e;var o=n-1;return t[o]=(n>1?"& ":"")+t[o],t=t.join(n>2?", ":" "),e.replace(yt,`{
/* [wrapped with `+t+`] */
`)}function hd(e){return xe(e)||Fi(e)||!!(Nc&&e&&e[Nc])}function Xr(e,t){var n=typeof e;return t=t??J,!!t&&(n=="number"||n!="symbol"&&fa.test(e))&&e>-1&&e%1==0&&e<t}function Xt(e,t,n){if(!ct(n))return!1;var o=typeof t;return(o=="number"?sr(n)&&Xr(t,n.length):o=="string"&&t in n)?Fr(n[t],e):!1}function ho(e,t){if(xe(e))return!1;var n=typeof e;return n=="number"||n=="symbol"||n=="boolean"||e==null||fr(e)?!0:Ct.test(e)||!it.test(e)||t!=null&&e in Je(t)}function ld(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function lo(e){var t=$s(e),n=p[t];if(typeof n!="function"||!(t in Re.prototype))return!1;if(e===n)return!0;var o=oo(n);return!!o&&e===o[0]}function fd(e){return!!Cc&&Cc in e}var pd=fs?Qr:Ao;function On(e){var t=e&&e.constructor,n=typeof t=="function"&&t.prototype||Ji;return e===n}function Cu(e){return e===e&&!ct(e)}function Au(e,t){return function(n){return n==null?!1:n[e]===t&&(t!==r||e in Je(n))}}function dd(e){var t=Hs(e,function(o){return n.size===N&&n.clear(),o}),n=t.cache;return t}function gd(e,t){var n=e[1],o=t[1],u=n|o,d=u<(oe|ge|K),b=o==K&&n==fe||o==K&&n==F&&e[7].length<=t[8]||o==(K|F)&&t[7].length<=t[8]&&n==fe;if(!(d||b))return e;o&oe&&(e[2]=t[2],u|=n&oe?0:ye);var I=t[3];if(I){var T=e[3];e[3]=T?lu(T,I,t[4]):I,e[4]=T?oi(e[3],U):t[4]}return I=t[5],I&&(T=e[5],e[5]=T?fu(T,I,t[6]):I,e[6]=T?oi(e[5],U):t[6]),I=t[7],I&&(e[7]=I),o&K&&(e[8]=e[8]==null?t[8]:Bt(e[8],t[8])),e[9]==null&&(e[9]=t[9]),e[0]=t[0],e[1]=u,e}function yd(e){var t=[];if(e!=null)for(var n in Je(e))t.push(n);return t}function vd(e){return ds.call(e)}function Tu(e,t,n){return t=Mt(t===r?e.length-1:t,0),function(){for(var o=arguments,u=-1,d=Mt(o.length-t,0),b=D(d);++u<d;)b[u]=o[t+u];u=-1;for(var I=D(t+1);++u<t;)I[u]=o[u];return I[t]=n(b),qt(e,this,I)}}function Ru(e,t){return t.length<2?e:Ti(e,Ir(t,0,-1))}function _d(e,t){for(var n=e.length,o=Bt(t.length,n),u=nr(e);o--;){var d=t[o];e[o]=Xr(d,n)?u[d]:r}return e}function fo(e,t){if(!(t==="constructor"&&typeof e[t]=="function")&&t!="__proto__")return e[t]}var Nu=Du(tu),Cn=Ff||function(e,t){return Ne.setTimeout(e,t)},po=Du(Up);function Fu(e,t,n){var o=t+"";return po(e,ud(o,md(ad(o),n)))}function Du(e){var t=0,n=0;return function(){var o=Lf(),u=S-(o-n);if(n=o,u>0){if(++t>=_)return arguments[0]}else t=0;return e.apply(r,arguments)}}function Ms(e,t){var n=-1,o=e.length,u=o-1;for(t=t===r?o:t;++n<t;){var d=Ja(n,u),b=e[d];e[d]=e[n],e[n]=b}return e.length=t,e}var ju=dd(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(At,function(n,o,u,d){t.push(u?d.replace(aa,"$1"):o||n)}),t});function Ur(e){if(typeof e=="string"||fr(e))return e;var t=e+"";return t=="0"&&1/e==-W?"-0":t}function Ni(e){if(e!=null){try{return ps.call(e)}catch{}try{return e+""}catch{}}return""}function md(e,t){return mr(ut,function(n){var o="_."+n[0];t&n[1]&&!cs(e,o)&&e.push(o)}),e.sort()}function $u(e){if(e instanceof Re)return e.clone();var t=new br(e.__wrapped__,e.__chain__);return t.__actions__=nr(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}function wd(e,t,n){(n?Xt(e,t,n):t===r)?t=1:t=Mt(Se(t),0);var o=e==null?0:e.length;if(!o||t<1)return[];for(var u=0,d=0,b=D(ws(o/t));u<o;)b[d++]=Ir(e,u,u+=t);return b}function bd(e){for(var t=-1,n=e==null?0:e.length,o=0,u=[];++t<n;){var d=e[t];d&&(u[o++]=d)}return u}function Ed(){var e=arguments.length;if(!e)return[];for(var t=D(e-1),n=arguments[0],o=e;o--;)t[o-1]=arguments[o];return ai(xe(n)?nr(n):[n],Kt(t,1))}var Id=Ce(function(e,t){return Et(e)?En(e,Kt(t,1,Et,!0)):[]}),xd=Ce(function(e,t){var n=xr(t);return Et(n)&&(n=r),Et(e)?En(e,Kt(t,1,Et,!0),pe(n,2)):[]}),Sd=Ce(function(e,t){var n=xr(t);return Et(n)&&(n=r),Et(e)?En(e,Kt(t,1,Et,!0),r,n):[]});function Pd(e,t,n){var o=e==null?0:e.length;return o?(t=n||t===r?1:Se(t),Ir(e,t<0?0:t,o)):[]}function Od(e,t,n){var o=e==null?0:e.length;return o?(t=n||t===r?1:Se(t),t=o-t,Ir(e,0,t<0?0:t)):[]}function Cd(e,t){return e&&e.length?Ts(e,pe(t,3),!0,!0):[]}function Ad(e,t){return e&&e.length?Ts(e,pe(t,3),!0):[]}function Td(e,t,n,o){var u=e==null?0:e.length;return u?(n&&typeof n!="number"&&Xt(e,t,n)&&(n=0,o=u),Ep(e,t,n,o)):[]}function Lu(e,t,n){var o=e==null?0:e.length;if(!o)return-1;var u=n==null?0:Se(n);return u<0&&(u=Mt(o+u,0)),us(e,pe(t,3),u)}function Mu(e,t,n){var o=e==null?0:e.length;if(!o)return-1;var u=o-1;return n!==r&&(u=Se(n),u=n<0?Mt(o+u,0):Bt(u,o-1)),us(e,pe(t,3),u,!0)}function zu(e){var t=e==null?0:e.length;return t?Kt(e,1):[]}function Rd(e){var t=e==null?0:e.length;return t?Kt(e,W):[]}function Nd(e,t){var n=e==null?0:e.length;return n?(t=t===r?1:Se(t),Kt(e,t)):[]}function Fd(e){for(var t=-1,n=e==null?0:e.length,o={};++t<n;){var u=e[t];o[u[0]]=u[1]}return o}function qu(e){return e&&e.length?e[0]:r}function Dd(e,t,n){var o=e==null?0:e.length;if(!o)return-1;var u=n==null?0:Se(n);return u<0&&(u=Mt(o+u,0)),Vi(e,t,u)}function jd(e){var t=e==null?0:e.length;return t?Ir(e,0,-1):[]}var $d=Ce(function(e){var t=nt(e,eo);return t.length&&t[0]===e[0]?Ka(t):[]}),Ld=Ce(function(e){var t=xr(e),n=nt(e,eo);return t===xr(n)?t=r:n.pop(),n.length&&n[0]===e[0]?Ka(n,pe(t,2)):[]}),Md=Ce(function(e){var t=xr(e),n=nt(e,eo);return t=typeof t=="function"?t:r,t&&n.pop(),n.length&&n[0]===e[0]?Ka(n,r,t):[]});function zd(e,t){return e==null?"":jf.call(e,t)}function xr(e){var t=e==null?0:e.length;return t?e[t-1]:r}function qd(e,t,n){var o=e==null?0:e.length;if(!o)return-1;var u=o;return n!==r&&(u=Se(n),u=u<0?Mt(o+u,0):Bt(u,o-1)),t===t?mf(e,t,u):us(e,wc,u,!0)}function Ud(e,t){return e&&e.length?Zc(e,Se(t)):r}var Hd=Ce(Uu);function Uu(e,t){return e&&e.length&&t&&t.length?Wa(e,t):e}function kd(e,t,n){return e&&e.length&&t&&t.length?Wa(e,t,pe(n,2)):e}function Kd(e,t,n){return e&&e.length&&t&&t.length?Wa(e,t,r,n):e}var Vd=Zr(function(e,t){var n=e==null?0:e.length,o=qa(e,t);return eu(e,nt(t,function(u){return Xr(u,n)?+u:u}).sort(hu)),o});function Bd(e,t){var n=[];if(!(e&&e.length))return n;var o=-1,u=[],d=e.length;for(t=pe(t,3);++o<d;){var b=e[o];t(b,o,e)&&(n.push(b),u.push(o))}return eu(e,u),n}function go(e){return e==null?e:zf.call(e)}function Gd(e,t,n){var o=e==null?0:e.length;return o?(n&&typeof n!="number"&&Xt(e,t,n)?(t=0,n=o):(t=t==null?0:Se(t),n=n===r?o:Se(n)),Ir(e,t,n)):[]}function Wd(e,t){return As(e,t)}function Jd(e,t,n){return Za(e,t,pe(n,2))}function Yd(e,t){var n=e==null?0:e.length;if(n){var o=As(e,t);if(o<n&&Fr(e[o],t))return o}return-1}function Zd(e,t){return As(e,t,!0)}function Xd(e,t,n){return Za(e,t,pe(n,2),!0)}function Qd(e,t){var n=e==null?0:e.length;if(n){var o=As(e,t,!0)-1;if(Fr(e[o],t))return o}return-1}function eg(e){return e&&e.length?ru(e):[]}function tg(e,t){return e&&e.length?ru(e,pe(t,2)):[]}function rg(e){var t=e==null?0:e.length;return t?Ir(e,1,t):[]}function ig(e,t,n){return e&&e.length?(t=n||t===r?1:Se(t),Ir(e,0,t<0?0:t)):[]}function ng(e,t,n){var o=e==null?0:e.length;return o?(t=n||t===r?1:Se(t),t=o-t,Ir(e,t<0?0:t,o)):[]}function sg(e,t){return e&&e.length?Ts(e,pe(t,3),!1,!0):[]}function ag(e,t){return e&&e.length?Ts(e,pe(t,3)):[]}var og=Ce(function(e){return hi(Kt(e,1,Et,!0))}),cg=Ce(function(e){var t=xr(e);return Et(t)&&(t=r),hi(Kt(e,1,Et,!0),pe(t,2))}),ug=Ce(function(e){var t=xr(e);return t=typeof t=="function"?t:r,hi(Kt(e,1,Et,!0),r,t)});function hg(e){return e&&e.length?hi(e):[]}function lg(e,t){return e&&e.length?hi(e,pe(t,2)):[]}function fg(e,t){return t=typeof t=="function"?t:r,e&&e.length?hi(e,r,t):[]}function yo(e){if(!(e&&e.length))return[];var t=0;return e=si(e,function(n){if(Et(n))return t=Mt(n.length,t),!0}),Na(t,function(n){return nt(e,Aa(n))})}function Hu(e,t){if(!(e&&e.length))return[];var n=yo(e);return t==null?n:nt(n,function(o){return qt(t,r,o)})}var pg=Ce(function(e,t){return Et(e)?En(e,t):[]}),dg=Ce(function(e){return Qa(si(e,Et))}),gg=Ce(function(e){var t=xr(e);return Et(t)&&(t=r),Qa(si(e,Et),pe(t,2))}),yg=Ce(function(e){var t=xr(e);return t=typeof t=="function"?t:r,Qa(si(e,Et),r,t)}),vg=Ce(yo);function _g(e,t){return au(e||[],t||[],bn)}function mg(e,t){return au(e||[],t||[],Sn)}var wg=Ce(function(e){var t=e.length,n=t>1?e[t-1]:r;return n=typeof n=="function"?(e.pop(),n):r,Hu(e,n)});function ku(e){var t=p(e);return t.__chain__=!0,t}function bg(e,t){return t(e),e}function zs(e,t){return t(e)}var Eg=Zr(function(e){var t=e.length,n=t?e[0]:0,o=this.__wrapped__,u=function(d){return qa(d,e)};return t>1||this.__actions__.length||!(o instanceof Re)||!Xr(n)?this.thru(u):(o=o.slice(n,+n+(t?1:0)),o.__actions__.push({func:zs,args:[u],thisArg:r}),new br(o,this.__chain__).thru(function(d){return t&&!d.length&&d.push(r),d}))});function Ig(){return ku(this)}function xg(){return new br(this.value(),this.__chain__)}function Sg(){this.__values__===r&&(this.__values__=ih(this.value()));var e=this.__index__>=this.__values__.length,t=e?r:this.__values__[this.__index__++];return{done:e,value:t}}function Pg(){return this}function Og(e){for(var t,n=this;n instanceof xs;){var o=$u(n);o.__index__=0,o.__values__=r,t?u.__wrapped__=o:t=o;var u=o;n=n.__wrapped__}return u.__wrapped__=e,t}function Cg(){var e=this.__wrapped__;if(e instanceof Re){var t=e;return this.__actions__.length&&(t=new Re(this)),t=t.reverse(),t.__actions__.push({func:zs,args:[go],thisArg:r}),new br(t,this.__chain__)}return this.thru(go)}function Ag(){return su(this.__wrapped__,this.__actions__)}var Tg=Rs(function(e,t,n){He.call(e,n)?++e[n]:Jr(e,n,1)});function Rg(e,t,n){var o=xe(e)?_c:bp;return n&&Xt(e,t,n)&&(t=r),o(e,pe(t,3))}function Ng(e,t){var n=xe(e)?si:Hc;return n(e,pe(t,3))}var Fg=yu(Lu),Dg=yu(Mu);function jg(e,t){return Kt(qs(e,t),1)}function $g(e,t){return Kt(qs(e,t),W)}function Lg(e,t,n){return n=n===r?1:Se(n),Kt(qs(e,t),n)}function Ku(e,t){var n=xe(e)?mr:ui;return n(e,pe(t,3))}function Vu(e,t){var n=xe(e)?tf:Uc;return n(e,pe(t,3))}var Mg=Rs(function(e,t,n){He.call(e,n)?e[n].push(t):Jr(e,n,[t])});function zg(e,t,n,o){e=sr(e)?e:nn(e),n=n&&!o?Se(n):0;var u=e.length;return n<0&&(n=Mt(u+n,0)),Vs(e)?n<=u&&e.indexOf(t,n)>-1:!!u&&Vi(e,t,n)>-1}var qg=Ce(function(e,t,n){var o=-1,u=typeof t=="function",d=sr(e)?D(e.length):[];return ui(e,function(b){d[++o]=u?qt(t,b,n):In(b,t,n)}),d}),Ug=Rs(function(e,t,n){Jr(e,n,t)});function qs(e,t){var n=xe(e)?nt:Wc;return n(e,pe(t,3))}function Hg(e,t,n,o){return e==null?[]:(xe(t)||(t=t==null?[]:[t]),n=o?r:n,xe(n)||(n=n==null?[]:[n]),Xc(e,t,n))}var kg=Rs(function(e,t,n){e[n?0:1].push(t)},function(){return[[],[]]});function Kg(e,t,n){var o=xe(e)?Oa:Ec,u=arguments.length<3;return o(e,pe(t,4),n,u,ui)}function Vg(e,t,n){var o=xe(e)?rf:Ec,u=arguments.length<3;return o(e,pe(t,4),n,u,Uc)}function Bg(e,t){var n=xe(e)?si:Hc;return n(e,ks(pe(t,3)))}function Gg(e){var t=xe(e)?Lc:zp;return t(e)}function Wg(e,t,n){(n?Xt(e,t,n):t===r)?t=1:t=Se(t);var o=xe(e)?yp:qp;return o(e,t)}function Jg(e){var t=xe(e)?vp:Hp;return t(e)}function Yg(e){if(e==null)return 0;if(sr(e))return Vs(e)?Gi(e):e.length;var t=Gt(e);return t==Pe||t==ze?e.size:Ba(e).length}function Zg(e,t,n){var o=xe(e)?Ca:kp;return n&&Xt(e,t,n)&&(t=r),o(e,pe(t,3))}var Xg=Ce(function(e,t){if(e==null)return[];var n=t.length;return n>1&&Xt(e,t[0],t[1])?t=[]:n>2&&Xt(t[0],t[1],t[2])&&(t=[t[0]]),Xc(e,Kt(t,1),[])}),Us=Nf||function(){return Ne.Date.now()};function Qg(e,t){if(typeof t!="function")throw new wr(w);return e=Se(e),function(){if(--e<1)return t.apply(this,arguments)}}function Bu(e,t,n){return t=n?r:t,t=e&&t==null?e.length:t,Yr(e,K,r,r,r,r,t)}function Gu(e,t){var n;if(typeof t!="function")throw new wr(w);return e=Se(e),function(){return--e>0&&(n=t.apply(this,arguments)),e<=1&&(t=r),n}}var vo=Ce(function(e,t,n){var o=oe;if(n.length){var u=oi(n,tn(vo));o|=le}return Yr(e,o,t,n,u)}),Wu=Ce(function(e,t,n){var o=oe|ge;if(n.length){var u=oi(n,tn(Wu));o|=le}return Yr(t,o,e,n,u)});function Ju(e,t,n){t=n?r:t;var o=Yr(e,fe,r,r,r,r,r,t);return o.placeholder=Ju.placeholder,o}function Yu(e,t,n){t=n?r:t;var o=Yr(e,he,r,r,r,r,r,t);return o.placeholder=Yu.placeholder,o}function Zu(e,t,n){var o,u,d,b,I,T,H=0,k=!1,G=!1,te=!0;if(typeof e!="function")throw new wr(w);t=Sr(t)||0,ct(n)&&(k=!!n.leading,G="maxWait"in n,d=G?Mt(Sr(n.maxWait)||0,t):d,te="trailing"in n?!!n.trailing:te);function ce(It){var Dr=o,ti=u;return o=u=r,H=It,b=e.apply(ti,Dr),b}function ve(It){return H=It,I=Cn(Ae,t),k?ce(It):b}function Oe(It){var Dr=It-T,ti=It-H,yh=t-Dr;return G?Bt(yh,d-ti):yh}function _e(It){var Dr=It-T,ti=It-H;return T===r||Dr>=t||Dr<0||G&&ti>=d}function Ae(){var It=Us();if(_e(It))return Fe(It);I=Cn(Ae,Oe(It))}function Fe(It){return I=r,te&&o?ce(It):(o=u=r,b)}function pr(){I!==r&&ou(I),H=0,o=T=u=I=r}function Qt(){return I===r?b:Fe(Us())}function dr(){var It=Us(),Dr=_e(It);if(o=arguments,u=this,T=It,Dr){if(I===r)return ve(T);if(G)return ou(I),I=Cn(Ae,t),ce(T)}return I===r&&(I=Cn(Ae,t)),b}return dr.cancel=pr,dr.flush=Qt,dr}var ey=Ce(function(e,t){return qc(e,1,t)}),ty=Ce(function(e,t,n){return qc(e,Sr(t)||0,n)});function ry(e){return Yr(e,ue)}function Hs(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new wr(w);var n=function(){var o=arguments,u=t?t.apply(this,o):o[0],d=n.cache;if(d.has(u))return d.get(u);var b=e.apply(this,o);return n.cache=d.set(u,b)||d,b};return n.cache=new(Hs.Cache||Wr),n}Hs.Cache=Wr;function ks(e){if(typeof e!="function")throw new wr(w);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}function iy(e){return Gu(2,e)}var ny=Kp(function(e,t){t=t.length==1&&xe(t[0])?nt(t[0],hr(pe())):nt(Kt(t,1),hr(pe()));var n=t.length;return Ce(function(o){for(var u=-1,d=Bt(o.length,n);++u<d;)o[u]=t[u].call(this,o[u]);return qt(e,this,o)})}),_o=Ce(function(e,t){var n=oi(t,tn(_o));return Yr(e,le,r,t,n)}),Xu=Ce(function(e,t){var n=oi(t,tn(Xu));return Yr(e,L,r,t,n)}),sy=Zr(function(e,t){return Yr(e,F,r,r,r,t)});function ay(e,t){if(typeof e!="function")throw new wr(w);return t=t===r?t:Se(t),Ce(e,t)}function oy(e,t){if(typeof e!="function")throw new wr(w);return t=t==null?0:Mt(Se(t),0),Ce(function(n){var o=n[t],u=fi(n,0,t);return o&&ai(u,o),qt(e,this,u)})}function cy(e,t,n){var o=!0,u=!0;if(typeof e!="function")throw new wr(w);return ct(n)&&(o="leading"in n?!!n.leading:o,u="trailing"in n?!!n.trailing:u),Zu(e,t,{leading:o,maxWait:t,trailing:u})}function uy(e){return Bu(e,1)}function hy(e,t){return _o(to(t),e)}function ly(){if(!arguments.length)return[];var e=arguments[0];return xe(e)?e:[e]}function fy(e){return Er(e,ee)}function py(e,t){return t=typeof t=="function"?t:r,Er(e,ee,t)}function dy(e){return Er(e,X|ee)}function gy(e,t){return t=typeof t=="function"?t:r,Er(e,X|ee,t)}function yy(e,t){return t==null||zc(e,t,Ut(t))}function Fr(e,t){return e===t||e!==e&&t!==t}var vy=js(ka),_y=js(function(e,t){return e>=t}),Fi=Vc(function(){return arguments}())?Vc:function(e){return vt(e)&&He.call(e,"callee")&&!Rc.call(e,"callee")},xe=D.isArray,my=Yt?hr(Yt):Op;function sr(e){return e!=null&&Ks(e.length)&&!Qr(e)}function Et(e){return vt(e)&&sr(e)}function wy(e){return e===!0||e===!1||vt(e)&&Zt(e)==M}var pi=Df||Ao,by=Tr?hr(Tr):Cp;function Ey(e){return vt(e)&&e.nodeType===1&&!An(e)}function Iy(e){if(e==null)return!0;if(sr(e)&&(xe(e)||typeof e=="string"||typeof e.splice=="function"||pi(e)||rn(e)||Fi(e)))return!e.length;var t=Gt(e);if(t==Pe||t==ze)return!e.size;if(On(e))return!Ba(e).length;for(var n in e)if(He.call(e,n))return!1;return!0}function xy(e,t){return xn(e,t)}function Sy(e,t,n){n=typeof n=="function"?n:r;var o=n?n(e,t):r;return o===r?xn(e,t,r,n):!!o}function mo(e){if(!vt(e))return!1;var t=Zt(e);return t==P||t==c||typeof e.message=="string"&&typeof e.name=="string"&&!An(e)}function Py(e){return typeof e=="number"&&Fc(e)}function Qr(e){if(!ct(e))return!1;var t=Zt(e);return t==ae||t==we||t==z||t==mt}function Qu(e){return typeof e=="number"&&e==Se(e)}function Ks(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=J}function ct(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}function vt(e){return e!=null&&typeof e=="object"}var eh=_r?hr(_r):Tp;function Oy(e,t){return e===t||Va(e,t,co(t))}function Cy(e,t,n){return n=typeof n=="function"?n:r,Va(e,t,co(t),n)}function Ay(e){return th(e)&&e!=+e}function Ty(e){if(pd(e))throw new Ee(f);return Bc(e)}function Ry(e){return e===null}function Ny(e){return e==null}function th(e){return typeof e=="number"||vt(e)&&Zt(e)==je}function An(e){if(!vt(e)||Zt(e)!=Te)return!1;var t=vs(e);if(t===null)return!0;var n=He.call(t,"constructor")&&t.constructor;return typeof n=="function"&&n instanceof n&&ps.call(n)==Cf}var wo=Mr?hr(Mr):Rp;function Fy(e){return Qu(e)&&e>=-J&&e<=J}var rh=dn?hr(dn):Np;function Vs(e){return typeof e=="string"||!xe(e)&&vt(e)&&Zt(e)==Ze}function fr(e){return typeof e=="symbol"||vt(e)&&Zt(e)==Xe}var rn=Si?hr(Si):Fp;function Dy(e){return e===r}function jy(e){return vt(e)&&Gt(e)==ke}function $y(e){return vt(e)&&Zt(e)==Qe}var Ly=js(Ga),My=js(function(e,t){return e<=t});function ih(e){if(!e)return[];if(sr(e))return Vs(e)?Rr(e):nr(e);if(yn&&e[yn])return yf(e[yn]());var t=Gt(e),n=t==Pe?Da:t==ze?hs:nn;return n(e)}function ei(e){if(!e)return e===0?e:0;if(e=Sr(e),e===W||e===-W){var t=e<0?-1:1;return t*O}return e===e?e:0}function Se(e){var t=ei(e),n=t%1;return t===t?n?t-n:t:0}function nh(e){return e?Ai(Se(e),0,Y):0}function Sr(e){if(typeof e=="number")return e;if(fr(e))return $;if(ct(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=ct(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=Ic(e);var n=ua.test(e);return n||la.test(e)?Ie(e.slice(2),n?2:8):ca.test(e)?$:+e}function sh(e){return qr(e,ar(e))}function zy(e){return e?Ai(Se(e),-J,J):e===0?e:0}function qe(e){return e==null?"":lr(e)}var qy=Qi(function(e,t){if(On(t)||sr(t)){qr(t,Ut(t),e);return}for(var n in t)He.call(t,n)&&bn(e,n,t[n])}),ah=Qi(function(e,t){qr(t,ar(t),e)}),Bs=Qi(function(e,t,n,o){qr(t,ar(t),e,o)}),Uy=Qi(function(e,t,n,o){qr(t,Ut(t),e,o)}),Hy=Zr(qa);function ky(e,t){var n=Xi(e);return t==null?n:Mc(n,t)}var Ky=Ce(function(e,t){e=Je(e);var n=-1,o=t.length,u=o>2?t[2]:r;for(u&&Xt(t[0],t[1],u)&&(o=1);++n<o;)for(var d=t[n],b=ar(d),I=-1,T=b.length;++I<T;){var H=b[I],k=e[H];(k===r||Fr(k,Ji[H])&&!He.call(e,H))&&(e[H]=d[H])}return e}),Vy=Ce(function(e){return e.push(r,Iu),qt(oh,r,e)});function By(e,t){return mc(e,pe(t,3),zr)}function Gy(e,t){return mc(e,pe(t,3),Ha)}function Wy(e,t){return e==null?e:Ua(e,pe(t,3),ar)}function Jy(e,t){return e==null?e:kc(e,pe(t,3),ar)}function Yy(e,t){return e&&zr(e,pe(t,3))}function Zy(e,t){return e&&Ha(e,pe(t,3))}function Xy(e){return e==null?[]:Os(e,Ut(e))}function Qy(e){return e==null?[]:Os(e,ar(e))}function bo(e,t,n){var o=e==null?r:Ti(e,t);return o===r?n:o}function e0(e,t){return e!=null&&Pu(e,t,Ip)}function Eo(e,t){return e!=null&&Pu(e,t,xp)}var t0=_u(function(e,t,n){t!=null&&typeof t.toString!="function"&&(t=ds.call(t)),e[t]=n},xo(or)),r0=_u(function(e,t,n){t!=null&&typeof t.toString!="function"&&(t=ds.call(t)),He.call(e,t)?e[t].push(n):e[t]=[n]},pe),i0=Ce(In);function Ut(e){return sr(e)?$c(e):Ba(e)}function ar(e){return sr(e)?$c(e,!0):Dp(e)}function n0(e,t){var n={};return t=pe(t,3),zr(e,function(o,u,d){Jr(n,t(o,u,d),o)}),n}function s0(e,t){var n={};return t=pe(t,3),zr(e,function(o,u,d){Jr(n,u,t(o,u,d))}),n}var a0=Qi(function(e,t,n){Cs(e,t,n)}),oh=Qi(function(e,t,n,o){Cs(e,t,n,o)}),o0=Zr(function(e,t){var n={};if(e==null)return n;var o=!1;t=nt(t,function(d){return d=li(d,e),o||(o=d.length>1),d}),qr(e,ao(e),n),o&&(n=Er(n,X|Q|ee,td));for(var u=t.length;u--;)Xa(n,t[u]);return n});function c0(e,t){return ch(e,ks(pe(t)))}var u0=Zr(function(e,t){return e==null?{}:$p(e,t)});function ch(e,t){if(e==null)return{};var n=nt(ao(e),function(o){return[o]});return t=pe(t),Qc(e,n,function(o,u){return t(o,u[0])})}function h0(e,t,n){t=li(t,e);var o=-1,u=t.length;for(u||(u=1,e=r);++o<u;){var d=e==null?r:e[Ur(t[o])];d===r&&(o=u,d=n),e=Qr(d)?d.call(e):d}return e}function l0(e,t,n){return e==null?e:Sn(e,t,n)}function f0(e,t,n,o){return o=typeof o=="function"?o:r,e==null?e:Sn(e,t,n,o)}var uh=bu(Ut),hh=bu(ar);function p0(e,t,n){var o=xe(e),u=o||pi(e)||rn(e);if(t=pe(t,4),n==null){var d=e&&e.constructor;u?n=o?new d:[]:ct(e)?n=Qr(d)?Xi(vs(e)):{}:n={}}return(u?mr:zr)(e,function(b,I,T){return t(n,b,I,T)}),n}function d0(e,t){return e==null?!0:Xa(e,t)}function g0(e,t,n){return e==null?e:nu(e,t,to(n))}function y0(e,t,n,o){return o=typeof o=="function"?o:r,e==null?e:nu(e,t,to(n),o)}function nn(e){return e==null?[]:Fa(e,Ut(e))}function v0(e){return e==null?[]:Fa(e,ar(e))}function _0(e,t,n){return n===r&&(n=t,t=r),n!==r&&(n=Sr(n),n=n===n?n:0),t!==r&&(t=Sr(t),t=t===t?t:0),Ai(Sr(e),t,n)}function m0(e,t,n){return t=ei(t),n===r?(n=t,t=0):n=ei(n),e=Sr(e),Sp(e,t,n)}function w0(e,t,n){if(n&&typeof n!="boolean"&&Xt(e,t,n)&&(t=n=r),n===r&&(typeof t=="boolean"?(n=t,t=r):typeof e=="boolean"&&(n=e,e=r)),e===r&&t===r?(e=0,t=1):(e=ei(e),t===r?(t=e,e=0):t=ei(t)),e>t){var o=e;e=t,t=o}if(n||e%1||t%1){var u=Dc();return Bt(e+u*(t-e+Ge("1e-"+((u+"").length-1))),t)}return Ja(e,t)}var b0=en(function(e,t,n){return t=t.toLowerCase(),e+(n?lh(t):t)});function lh(e){return Io(qe(e).toLowerCase())}function fh(e){return e=qe(e),e&&e.replace(Vr,lf).replace(xa,"")}function E0(e,t,n){e=qe(e),t=lr(t);var o=e.length;n=n===r?o:Ai(Se(n),0,o);var u=n;return n-=t.length,n>=0&&e.slice(n,u)==t}function I0(e){return e=qe(e),e&&rt.test(e)?e.replace(wi,ff):e}function x0(e){return e=qe(e),e&&Tt.test(e)?e.replace(dt,"\\$&"):e}var S0=en(function(e,t,n){return e+(n?"-":"")+t.toLowerCase()}),P0=en(function(e,t,n){return e+(n?" ":"")+t.toLowerCase()}),O0=gu("toLowerCase");function C0(e,t,n){e=qe(e),t=Se(t);var o=t?Gi(e):0;if(!t||o>=t)return e;var u=(t-o)/2;return Ds(bs(u),n)+e+Ds(ws(u),n)}function A0(e,t,n){e=qe(e),t=Se(t);var o=t?Gi(e):0;return t&&o<t?e+Ds(t-o,n):e}function T0(e,t,n){e=qe(e),t=Se(t);var o=t?Gi(e):0;return t&&o<t?Ds(t-o,n)+e:e}function R0(e,t,n){return n||t==null?t=0:t&&(t=+t),Mf(qe(e).replace(gt,""),t||0)}function N0(e,t,n){return(n?Xt(e,t,n):t===r)?t=1:t=Se(t),Ya(qe(e),t)}function F0(){var e=arguments,t=qe(e[0]);return e.length<3?t:t.replace(e[1],e[2])}var D0=en(function(e,t,n){return e+(n?"_":"")+t.toLowerCase()});function j0(e,t,n){return n&&typeof n!="number"&&Xt(e,t,n)&&(t=n=r),n=n===r?Y:n>>>0,n?(e=qe(e),e&&(typeof t=="string"||t!=null&&!wo(t))&&(t=lr(t),!t&&Bi(e))?fi(Rr(e),0,n):e.split(t,n)):[]}var $0=en(function(e,t,n){return e+(n?" ":"")+Io(t)});function L0(e,t,n){return e=qe(e),n=n==null?0:Ai(Se(n),0,e.length),t=lr(t),e.slice(n,n+t.length)==t}function M0(e,t,n){var o=p.templateSettings;n&&Xt(e,t,n)&&(t=r),e=qe(e),t=Bs({},t,o,Eu);var u=Bs({},t.imports,o.imports,Eu),d=Ut(u),b=Fa(u,d),I,T,H=0,k=t.interpolate||Mi,G="__p += '",te=ja((t.escape||Mi).source+"|"+k.source+"|"+(k===ot?oa:Mi).source+"|"+(t.evaluate||Mi).source+"|$","g"),ce="//# sourceURL="+(He.call(t,"sourceURL")?(t.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Sa+"]")+`
`;e.replace(te,function(_e,Ae,Fe,pr,Qt,dr){return Fe||(Fe=pr),G+=e.slice(H,dr).replace(pa,pf),Ae&&(I=!0,G+=`' +
__e(`+Ae+`) +
'`),Qt&&(T=!0,G+=`';
`+Qt+`;
__p += '`),Fe&&(G+=`' +
((__t = (`+Fe+`)) == null ? '' : __t) +
'`),H=dr+_e.length,_e}),G+=`';
`;var ve=He.call(t,"variable")&&t.variable;if(!ve)G=`with (obj) {
`+G+`
}
`;else if(sa.test(ve))throw new Ee(E);G=(T?G.replace($r,""):G).replace(Jt,"$1").replace(Kr,"$1;"),G="function("+(ve||"obj")+`) {
`+(ve?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(I?", __e = _.escape":"")+(T?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+G+`return __p
}`;var Oe=dh(function(){return Me(d,ce+"return "+G).apply(r,b)});if(Oe.source=G,mo(Oe))throw Oe;return Oe}function z0(e){return qe(e).toLowerCase()}function q0(e){return qe(e).toUpperCase()}function U0(e,t,n){if(e=qe(e),e&&(n||t===r))return Ic(e);if(!e||!(t=lr(t)))return e;var o=Rr(e),u=Rr(t),d=xc(o,u),b=Sc(o,u)+1;return fi(o,d,b).join("")}function H0(e,t,n){if(e=qe(e),e&&(n||t===r))return e.slice(0,Oc(e)+1);if(!e||!(t=lr(t)))return e;var o=Rr(e),u=Sc(o,Rr(t))+1;return fi(o,0,u).join("")}function k0(e,t,n){if(e=qe(e),e&&(n||t===r))return e.replace(gt,"");if(!e||!(t=lr(t)))return e;var o=Rr(e),u=xc(o,Rr(t));return fi(o,u).join("")}function K0(e,t){var n=l,o=v;if(ct(t)){var u="separator"in t?t.separator:u;n="length"in t?Se(t.length):n,o="omission"in t?lr(t.omission):o}e=qe(e);var d=e.length;if(Bi(e)){var b=Rr(e);d=b.length}if(n>=d)return e;var I=n-Gi(o);if(I<1)return o;var T=b?fi(b,0,I).join(""):e.slice(0,I);if(u===r)return T+o;if(b&&(I+=T.length-I),wo(u)){if(e.slice(I).search(u)){var H,k=T;for(u.global||(u=ja(u.source,qe(vr.exec(u))+"g")),u.lastIndex=0;H=u.exec(k);)var G=H.index;T=T.slice(0,G===r?I:G)}}else if(e.indexOf(lr(u),I)!=I){var te=T.lastIndexOf(u);te>-1&&(T=T.slice(0,te))}return T+o}function V0(e){return e=qe(e),e&&lt.test(e)?e.replace(ii,wf):e}var B0=en(function(e,t,n){return e+(n?" ":"")+t.toUpperCase()}),Io=gu("toUpperCase");function ph(e,t,n){return e=qe(e),t=n?r:t,t===r?gf(e)?If(e):af(e):e.match(t)||[]}var dh=Ce(function(e,t){try{return qt(e,r,t)}catch(n){return mo(n)?n:new Ee(n)}}),G0=Zr(function(e,t){return mr(t,function(n){n=Ur(n),Jr(e,n,vo(e[n],e))}),e});function W0(e){var t=e==null?0:e.length,n=pe();return e=t?nt(e,function(o){if(typeof o[1]!="function")throw new wr(w);return[n(o[0]),o[1]]}):[],Ce(function(o){for(var u=-1;++u<t;){var d=e[u];if(qt(d[0],this,o))return qt(d[1],this,o)}})}function J0(e){return wp(Er(e,X))}function xo(e){return function(){return e}}function Y0(e,t){return e==null||e!==e?t:e}var Z0=vu(),X0=vu(!0);function or(e){return e}function So(e){return Gc(typeof e=="function"?e:Er(e,X))}function Q0(e){return Jc(Er(e,X))}function ev(e,t){return Yc(e,Er(t,X))}var tv=Ce(function(e,t){return function(n){return In(n,e,t)}}),rv=Ce(function(e,t){return function(n){return In(e,n,t)}});function Po(e,t,n){var o=Ut(t),u=Os(t,o);n==null&&!(ct(t)&&(u.length||!o.length))&&(n=t,t=e,e=this,u=Os(t,Ut(t)));var d=!(ct(n)&&"chain"in n)||!!n.chain,b=Qr(e);return mr(u,function(I){var T=t[I];e[I]=T,b&&(e.prototype[I]=function(){var H=this.__chain__;if(d||H){var k=e(this.__wrapped__),G=k.__actions__=nr(this.__actions__);return G.push({func:T,args:arguments,thisArg:e}),k.__chain__=H,k}return T.apply(e,ai([this.value()],arguments))})}),e}function iv(){return Ne._===this&&(Ne._=Af),this}function Oo(){}function nv(e){return e=Se(e),Ce(function(t){return Zc(t,e)})}var sv=io(nt),av=io(_c),ov=io(Ca);function gh(e){return ho(e)?Aa(Ur(e)):Lp(e)}function cv(e){return function(t){return e==null?r:Ti(e,t)}}var uv=mu(),hv=mu(!0);function Co(){return[]}function Ao(){return!1}function lv(){return{}}function fv(){return""}function pv(){return!0}function dv(e,t){if(e=Se(e),e<1||e>J)return[];var n=Y,o=Bt(e,Y);t=pe(t),e-=Y;for(var u=Na(o,t);++n<e;)t(n);return u}function gv(e){return xe(e)?nt(e,Ur):fr(e)?[e]:nr(ju(qe(e)))}function yv(e){var t=++Of;return qe(e)+t}var vv=Fs(function(e,t){return e+t},0),_v=no("ceil"),mv=Fs(function(e,t){return e/t},1),wv=no("floor");function bv(e){return e&&e.length?Ps(e,or,ka):r}function Ev(e,t){return e&&e.length?Ps(e,pe(t,2),ka):r}function Iv(e){return bc(e,or)}function xv(e,t){return bc(e,pe(t,2))}function Sv(e){return e&&e.length?Ps(e,or,Ga):r}function Pv(e,t){return e&&e.length?Ps(e,pe(t,2),Ga):r}var Ov=Fs(function(e,t){return e*t},1),Cv=no("round"),Av=Fs(function(e,t){return e-t},0);function Tv(e){return e&&e.length?Ra(e,or):0}function Rv(e,t){return e&&e.length?Ra(e,pe(t,2)):0}return p.after=Qg,p.ary=Bu,p.assign=qy,p.assignIn=ah,p.assignInWith=Bs,p.assignWith=Uy,p.at=Hy,p.before=Gu,p.bind=vo,p.bindAll=G0,p.bindKey=Wu,p.castArray=ly,p.chain=ku,p.chunk=wd,p.compact=bd,p.concat=Ed,p.cond=W0,p.conforms=J0,p.constant=xo,p.countBy=Tg,p.create=ky,p.curry=Ju,p.curryRight=Yu,p.debounce=Zu,p.defaults=Ky,p.defaultsDeep=Vy,p.defer=ey,p.delay=ty,p.difference=Id,p.differenceBy=xd,p.differenceWith=Sd,p.drop=Pd,p.dropRight=Od,p.dropRightWhile=Cd,p.dropWhile=Ad,p.fill=Td,p.filter=Ng,p.flatMap=jg,p.flatMapDeep=$g,p.flatMapDepth=Lg,p.flatten=zu,p.flattenDeep=Rd,p.flattenDepth=Nd,p.flip=ry,p.flow=Z0,p.flowRight=X0,p.fromPairs=Fd,p.functions=Xy,p.functionsIn=Qy,p.groupBy=Mg,p.initial=jd,p.intersection=$d,p.intersectionBy=Ld,p.intersectionWith=Md,p.invert=t0,p.invertBy=r0,p.invokeMap=qg,p.iteratee=So,p.keyBy=Ug,p.keys=Ut,p.keysIn=ar,p.map=qs,p.mapKeys=n0,p.mapValues=s0,p.matches=Q0,p.matchesProperty=ev,p.memoize=Hs,p.merge=a0,p.mergeWith=oh,p.method=tv,p.methodOf=rv,p.mixin=Po,p.negate=ks,p.nthArg=nv,p.omit=o0,p.omitBy=c0,p.once=iy,p.orderBy=Hg,p.over=sv,p.overArgs=ny,p.overEvery=av,p.overSome=ov,p.partial=_o,p.partialRight=Xu,p.partition=kg,p.pick=u0,p.pickBy=ch,p.property=gh,p.propertyOf=cv,p.pull=Hd,p.pullAll=Uu,p.pullAllBy=kd,p.pullAllWith=Kd,p.pullAt=Vd,p.range=uv,p.rangeRight=hv,p.rearg=sy,p.reject=Bg,p.remove=Bd,p.rest=ay,p.reverse=go,p.sampleSize=Wg,p.set=l0,p.setWith=f0,p.shuffle=Jg,p.slice=Gd,p.sortBy=Xg,p.sortedUniq=eg,p.sortedUniqBy=tg,p.split=j0,p.spread=oy,p.tail=rg,p.take=ig,p.takeRight=ng,p.takeRightWhile=sg,p.takeWhile=ag,p.tap=bg,p.throttle=cy,p.thru=zs,p.toArray=ih,p.toPairs=uh,p.toPairsIn=hh,p.toPath=gv,p.toPlainObject=sh,p.transform=p0,p.unary=uy,p.union=og,p.unionBy=cg,p.unionWith=ug,p.uniq=hg,p.uniqBy=lg,p.uniqWith=fg,p.unset=d0,p.unzip=yo,p.unzipWith=Hu,p.update=g0,p.updateWith=y0,p.values=nn,p.valuesIn=v0,p.without=pg,p.words=ph,p.wrap=hy,p.xor=dg,p.xorBy=gg,p.xorWith=yg,p.zip=vg,p.zipObject=_g,p.zipObjectDeep=mg,p.zipWith=wg,p.entries=uh,p.entriesIn=hh,p.extend=ah,p.extendWith=Bs,Po(p,p),p.add=vv,p.attempt=dh,p.camelCase=b0,p.capitalize=lh,p.ceil=_v,p.clamp=_0,p.clone=fy,p.cloneDeep=dy,p.cloneDeepWith=gy,p.cloneWith=py,p.conformsTo=yy,p.deburr=fh,p.defaultTo=Y0,p.divide=mv,p.endsWith=E0,p.eq=Fr,p.escape=I0,p.escapeRegExp=x0,p.every=Rg,p.find=Fg,p.findIndex=Lu,p.findKey=By,p.findLast=Dg,p.findLastIndex=Mu,p.findLastKey=Gy,p.floor=wv,p.forEach=Ku,p.forEachRight=Vu,p.forIn=Wy,p.forInRight=Jy,p.forOwn=Yy,p.forOwnRight=Zy,p.get=bo,p.gt=vy,p.gte=_y,p.has=e0,p.hasIn=Eo,p.head=qu,p.identity=or,p.includes=zg,p.indexOf=Dd,p.inRange=m0,p.invoke=i0,p.isArguments=Fi,p.isArray=xe,p.isArrayBuffer=my,p.isArrayLike=sr,p.isArrayLikeObject=Et,p.isBoolean=wy,p.isBuffer=pi,p.isDate=by,p.isElement=Ey,p.isEmpty=Iy,p.isEqual=xy,p.isEqualWith=Sy,p.isError=mo,p.isFinite=Py,p.isFunction=Qr,p.isInteger=Qu,p.isLength=Ks,p.isMap=eh,p.isMatch=Oy,p.isMatchWith=Cy,p.isNaN=Ay,p.isNative=Ty,p.isNil=Ny,p.isNull=Ry,p.isNumber=th,p.isObject=ct,p.isObjectLike=vt,p.isPlainObject=An,p.isRegExp=wo,p.isSafeInteger=Fy,p.isSet=rh,p.isString=Vs,p.isSymbol=fr,p.isTypedArray=rn,p.isUndefined=Dy,p.isWeakMap=jy,p.isWeakSet=$y,p.join=zd,p.kebabCase=S0,p.last=xr,p.lastIndexOf=qd,p.lowerCase=P0,p.lowerFirst=O0,p.lt=Ly,p.lte=My,p.max=bv,p.maxBy=Ev,p.mean=Iv,p.meanBy=xv,p.min=Sv,p.minBy=Pv,p.stubArray=Co,p.stubFalse=Ao,p.stubObject=lv,p.stubString=fv,p.stubTrue=pv,p.multiply=Ov,p.nth=Ud,p.noConflict=iv,p.noop=Oo,p.now=Us,p.pad=C0,p.padEnd=A0,p.padStart=T0,p.parseInt=R0,p.random=w0,p.reduce=Kg,p.reduceRight=Vg,p.repeat=N0,p.replace=F0,p.result=h0,p.round=Cv,p.runInContext=A,p.sample=Gg,p.size=Yg,p.snakeCase=D0,p.some=Zg,p.sortedIndex=Wd,p.sortedIndexBy=Jd,p.sortedIndexOf=Yd,p.sortedLastIndex=Zd,p.sortedLastIndexBy=Xd,p.sortedLastIndexOf=Qd,p.startCase=$0,p.startsWith=L0,p.subtract=Av,p.sum=Tv,p.sumBy=Rv,p.template=M0,p.times=dv,p.toFinite=ei,p.toInteger=Se,p.toLength=nh,p.toLower=z0,p.toNumber=Sr,p.toSafeInteger=zy,p.toString=qe,p.toUpper=q0,p.trim=U0,p.trimEnd=H0,p.trimStart=k0,p.truncate=K0,p.unescape=V0,p.uniqueId=yv,p.upperCase=B0,p.upperFirst=Io,p.each=Ku,p.eachRight=Vu,p.first=qu,Po(p,function(){var e={};return zr(p,function(t,n){He.call(p.prototype,n)||(e[n]=t)}),e}(),{chain:!1}),p.VERSION=s,mr(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){p[e].placeholder=p}),mr(["drop","take"],function(e,t){Re.prototype[e]=function(n){n=n===r?1:Mt(Se(n),0);var o=this.__filtered__&&!t?new Re(this):this.clone();return o.__filtered__?o.__takeCount__=Bt(n,o.__takeCount__):o.__views__.push({size:Bt(n,Y),type:e+(o.__dir__<0?"Right":"")}),o},Re.prototype[e+"Right"]=function(n){return this.reverse()[e](n).reverse()}}),mr(["filter","map","takeWhile"],function(e,t){var n=t+1,o=n==y||n==j;Re.prototype[e]=function(u){var d=this.clone();return d.__iteratees__.push({iteratee:pe(u,3),type:n}),d.__filtered__=d.__filtered__||o,d}}),mr(["head","last"],function(e,t){var n="take"+(t?"Right":"");Re.prototype[e]=function(){return this[n](1).value()[0]}}),mr(["initial","tail"],function(e,t){var n="drop"+(t?"":"Right");Re.prototype[e]=function(){return this.__filtered__?new Re(this):this[n](1)}}),Re.prototype.compact=function(){return this.filter(or)},Re.prototype.find=function(e){return this.filter(e).head()},Re.prototype.findLast=function(e){return this.reverse().find(e)},Re.prototype.invokeMap=Ce(function(e,t){return typeof e=="function"?new Re(this):this.map(function(n){return In(n,e,t)})}),Re.prototype.reject=function(e){return this.filter(ks(pe(e)))},Re.prototype.slice=function(e,t){e=Se(e);var n=this;return n.__filtered__&&(e>0||t<0)?new Re(n):(e<0?n=n.takeRight(-e):e&&(n=n.drop(e)),t!==r&&(t=Se(t),n=t<0?n.dropRight(-t):n.take(t-e)),n)},Re.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},Re.prototype.toArray=function(){return this.take(Y)},zr(Re.prototype,function(e,t){var n=/^(?:filter|find|map|reject)|While$/.test(t),o=/^(?:head|last)$/.test(t),u=p[o?"take"+(t=="last"?"Right":""):t],d=o||/^find/.test(t);u&&(p.prototype[t]=function(){var b=this.__wrapped__,I=o?[1]:arguments,T=b instanceof Re,H=I[0],k=T||xe(b),G=function(Ae){var Fe=u.apply(p,ai([Ae],I));return o&&te?Fe[0]:Fe};k&&n&&typeof H=="function"&&H.length!=1&&(T=k=!1);var te=this.__chain__,ce=!!this.__actions__.length,ve=d&&!te,Oe=T&&!ce;if(!d&&k){b=Oe?b:new Re(this);var _e=e.apply(b,I);return _e.__actions__.push({func:zs,args:[G],thisArg:r}),new br(_e,te)}return ve&&Oe?e.apply(this,I):(_e=this.thru(G),ve?o?_e.value()[0]:_e.value():_e)})}),mr(["pop","push","shift","sort","splice","unshift"],function(e){var t=ls[e],n=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",o=/^(?:pop|shift)$/.test(e);p.prototype[e]=function(){var u=arguments;if(o&&!this.__chain__){var d=this.value();return t.apply(xe(d)?d:[],u)}return this[n](function(b){return t.apply(xe(b)?b:[],u)})}}),zr(Re.prototype,function(e,t){var n=p[t];if(n){var o=n.name+"";He.call(Zi,o)||(Zi[o]=[]),Zi[o].push({name:t,func:n})}}),Zi[Ns(r,ge).name]=[{name:"wrapper",func:r}],Re.prototype.clone=Vf,Re.prototype.reverse=Bf,Re.prototype.value=Gf,p.prototype.at=Eg,p.prototype.chain=Ig,p.prototype.commit=xg,p.prototype.next=Sg,p.prototype.plant=Og,p.prototype.reverse=Cg,p.prototype.toJSON=p.prototype.valueOf=p.prototype.value=Ag,p.prototype.first=p.prototype.head,yn&&(p.prototype[yn]=Pg),p},Wi=xf();bt?((bt.exports=Wi)._=Wi,We._=Wi):Ne._=Wi}).call(zn)})(Xo,Xo.exports);var sb=Object.defineProperty,ab=Object.defineProperties,ob=Object.getOwnPropertyDescriptors,ul=Object.getOwnPropertySymbols,cb=Object.prototype.hasOwnProperty,ub=Object.prototype.propertyIsEnumerable,hl=(h,i,r)=>i in h?sb(h,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):h[i]=r,Ws=(h,i)=>{for(var r in i||(i={}))cb.call(i,r)&&hl(h,r,i[r]);if(ul)for(var r of ul(i))ub.call(i,r)&&hl(h,r,i[r]);return h},hb=(h,i)=>ab(h,ob(i));function Cr(h,i,r){let s;const a=Qo(h);return i.rpcMap&&(s=i.rpcMap[a]),s||(s=`${nb}?chainId=eip155:${a}&projectId=${r}`),s}function Qo(h){return h.includes("eip155")?Number(h.split(":")[1]):Number(h)}function lb(h){return h.map(i=>`${i.split(":")[0]}:${i.split(":")[1]}`)}function fb(h,i){const r=Object.keys(i.namespaces).filter(a=>a.includes(h));if(!r.length)return[];const s=[];return r.forEach(a=>{const f=i.namespaces[a].accounts;s.push(...f)}),s}function pb(h,i={}){const r=ll(h),s=ll(i);return Xo.exports.merge(r,s)}function ll(h){var i,r,s,a;const f={};if(!Zs(h))return f;for(const[w,E]of Object.entries(h)){const x=y1(w)?[w]:E.chains,N=E.methods||[],U=E.events||[],X=E.rpcMap||{},Q=Xs(w);f[Q]=hb(Ws(Ws({},f[Q]),E),{chains:Ro(x,(i=f[Q])==null?void 0:i.chains),methods:Ro(N,(r=f[Q])==null?void 0:r.methods),events:Ro(U,(s=f[Q])==null?void 0:s.events),rpcMap:Ws(Ws({},X),(a=f[Q])==null?void 0:a.rpcMap)})}return f}function db(h){return h.includes(":")?h.split(":")[2]:h}const Ql={},xt=h=>Ql[h],ko=(h,i)=>{Ql[h]=i};class gb{constructor(i){this.name="polkadot",this.namespace=i.namespace,this.events=xt("events"),this.client=xt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(i){this.namespace=Object.assign(this.namespace,i)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const i=this.namespace.chains[0];if(!i)throw new Error("ChainId not found");return i.split(":")[1]}request(i){return this.namespace.methods.includes(i.request.method)?this.client.request(i):this.getHttpProvider().request(i.request)}setDefaultChain(i,r){if(this.chainId=i,!this.httpProviders[i]){const s=r||Cr(`${this.name}:${i}`,this.namespace);if(!s)throw new Error(`No RPC url provided for chainId: ${i}`);this.setHttpProvider(i,s)}this.events.emit(mi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const i=this.namespace.accounts;return i?i.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}createHttpProviders(){const i={};return this.namespace.chains.forEach(r=>{var s;i[r]=this.createHttpProvider(r,(s=this.namespace.rpcMap)==null?void 0:s[r])}),i}getHttpProvider(){const i=`${this.name}:${this.chainId}`,r=this.httpProviders[i];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${i} not found`);return r}setHttpProvider(i,r){const s=this.createHttpProvider(i,r);s&&(this.httpProviders[i]=s)}createHttpProvider(i,r){const s=r||Cr(i,this.namespace);return typeof s>"u"?void 0:new _i(new $i(s,xt("disableProviderPing")))}}class yb{constructor(i){this.name="eip155",this.namespace=i.namespace,this.events=xt("events"),this.client=xt("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(i){switch(i.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(i);case"eth_chainId":return parseInt(this.getDefaultChain())}return this.namespace.methods.includes(i.request.method)?await this.client.request(i):this.getHttpProvider().request(i.request)}updateNamespace(i){this.namespace=Object.assign(this.namespace,i)}setDefaultChain(i,r){const s=Qo(i);if(!this.httpProviders[s]){const a=r||Cr(`${this.name}:${s}`,this.namespace,this.client.core.projectId);if(!a)throw new Error(`No RPC url provided for chainId: ${s}`);this.setHttpProvider(s,a)}this.chainId=s,this.events.emit(mi.DEFAULT_CHAIN_CHANGED,`${this.name}:${s}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const i=this.namespace.chains[0];if(!i)throw new Error("ChainId not found");return i.split(":")[1]}createHttpProvider(i,r){const s=r||Cr(`${this.name}:${i}`,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new _i(new $i(s,xt("disableProviderPing")))}setHttpProvider(i,r){const s=this.createHttpProvider(i,r);s&&(this.httpProviders[i]=s)}createHttpProviders(){const i={};return this.namespace.chains.forEach(r=>{var s;const a=Qo(r);i[a]=this.createHttpProvider(a,(s=this.namespace.rpcMap)==null?void 0:s[r])}),i}getAccounts(){const i=this.namespace.accounts;return i?[...new Set(i.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}getHttpProvider(){const i=this.chainId,r=this.httpProviders[i];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${i} not found`);return r}async handleSwitchChain(i){var r;let s=i.request.params?(r=i.request.params[0])==null?void 0:r.chainId:"0x0";s=s.startsWith("0x")?s:`0x${s}`;const a=parseInt(s,16);if(this.isChainApproved(a))this.setDefaultChain(`${a}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:i.topic,request:{method:i.request.method,params:[{chainId:s}]},chainId:i.chainId}),this.setDefaultChain(`${a}`);else throw new Error(`Failed to switch to chain 'eip155:${a}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(i){return this.namespace.chains.includes(`${this.name}:${i}`)}}class vb{constructor(i){this.name="solana",this.namespace=i.namespace,this.events=xt("events"),this.client=xt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(i){this.namespace=Object.assign(this.namespace,i)}requestAccounts(){return this.getAccounts()}request(i){return this.namespace.methods.includes(i.request.method)?this.client.request(i):this.getHttpProvider().request(i.request)}setDefaultChain(i,r){if(!this.httpProviders[i]){const s=r||Cr(`${this.name}:${i}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${i}`);this.setHttpProvider(i,s)}this.chainId=i,this.events.emit(mi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const i=this.namespace.chains[0];if(!i)throw new Error("ChainId not found");return i.split(":")[1]}getAccounts(){const i=this.namespace.accounts;return i?[...new Set(i.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const i={};return this.namespace.chains.forEach(r=>{var s;i[r]=this.createHttpProvider(r,(s=this.namespace.rpcMap)==null?void 0:s[r])}),i}getHttpProvider(){const i=`${this.name}:${this.chainId}`,r=this.httpProviders[i];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${i} not found`);return r}setHttpProvider(i,r){const s=this.createHttpProvider(i,r);s&&(this.httpProviders[i]=s)}createHttpProvider(i,r){const s=r||Cr(i,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new _i(new $i(s,xt("disableProviderPing")))}}class _b{constructor(i){this.name="cosmos",this.namespace=i.namespace,this.events=xt("events"),this.client=xt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(i){this.namespace=Object.assign(this.namespace,i)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const i=this.namespace.chains[0];if(!i)throw new Error("ChainId not found");return i.split(":")[1]}request(i){return this.namespace.methods.includes(i.request.method)?this.client.request(i):this.getHttpProvider().request(i.request)}setDefaultChain(i,r){if(this.chainId=i,!this.httpProviders[i]){const s=r||Cr(`${this.name}:${i}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${i}`);this.setHttpProvider(i,s)}this.events.emit(mi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const i=this.namespace.accounts;return i?[...new Set(i.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const i={};return this.namespace.chains.forEach(r=>{var s;i[r]=this.createHttpProvider(r,(s=this.namespace.rpcMap)==null?void 0:s[r])}),i}getHttpProvider(){const i=`${this.name}:${this.chainId}`,r=this.httpProviders[i];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${i} not found`);return r}setHttpProvider(i,r){const s=this.createHttpProvider(i,r);s&&(this.httpProviders[i]=s)}createHttpProvider(i,r){const s=r||Cr(i,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new _i(new $i(s,xt("disableProviderPing")))}}class mb{constructor(i){this.name="cip34",this.namespace=i.namespace,this.events=xt("events"),this.client=xt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(i){this.namespace=Object.assign(this.namespace,i)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const i=this.namespace.chains[0];if(!i)throw new Error("ChainId not found");return i.split(":")[1]}request(i){return this.namespace.methods.includes(i.request.method)?this.client.request(i):this.getHttpProvider().request(i.request)}setDefaultChain(i,r){if(this.chainId=i,!this.httpProviders[i]){const s=r||this.getCardanoRPCUrl(i);if(!s)throw new Error(`No RPC url provided for chainId: ${i}`);this.setHttpProvider(i,s)}this.events.emit(mi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const i=this.namespace.accounts;return i?[...new Set(i.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const i={};return this.namespace.chains.forEach(r=>{const s=this.getCardanoRPCUrl(r);i[r]=this.createHttpProvider(r,s)}),i}getHttpProvider(){const i=`${this.name}:${this.chainId}`,r=this.httpProviders[i];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${i} not found`);return r}getCardanoRPCUrl(i){const r=this.namespace.rpcMap;if(r)return r[i]}setHttpProvider(i,r){const s=this.createHttpProvider(i,r);s&&(this.httpProviders[i]=s)}createHttpProvider(i,r){const s=r||this.getCardanoRPCUrl(i);return typeof s>"u"?void 0:new _i(new $i(s,xt("disableProviderPing")))}}class wb{constructor(i){this.name="elrond",this.namespace=i.namespace,this.events=xt("events"),this.client=xt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(i){this.namespace=Object.assign(this.namespace,i)}requestAccounts(){return this.getAccounts()}request(i){return this.namespace.methods.includes(i.request.method)?this.client.request(i):this.getHttpProvider().request(i.request)}setDefaultChain(i,r){if(!this.httpProviders[i]){const s=r||Cr(`${this.name}:${i}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${i}`);this.setHttpProvider(i,s)}this.chainId=i,this.events.emit(mi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const i=this.namespace.chains[0];if(!i)throw new Error("ChainId not found");return i.split(":")[1]}getAccounts(){const i=this.namespace.accounts;return i?[...new Set(i.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const i={};return this.namespace.chains.forEach(r=>{var s;i[r]=this.createHttpProvider(r,(s=this.namespace.rpcMap)==null?void 0:s[r])}),i}getHttpProvider(){const i=`${this.name}:${this.chainId}`,r=this.httpProviders[i];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${i} not found`);return r}setHttpProvider(i,r){const s=this.createHttpProvider(i,r);s&&(this.httpProviders[i]=s)}createHttpProvider(i,r){const s=r||Cr(i,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new _i(new $i(s,xt("disableProviderPing")))}}class bb{constructor(i){this.name="multiversx",this.namespace=i.namespace,this.events=xt("events"),this.client=xt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(i){this.namespace=Object.assign(this.namespace,i)}requestAccounts(){return this.getAccounts()}request(i){return this.namespace.methods.includes(i.request.method)?this.client.request(i):this.getHttpProvider().request(i.request)}setDefaultChain(i,r){if(!this.httpProviders[i]){const s=r||Cr(`${this.name}:${i}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${i}`);this.setHttpProvider(i,s)}this.chainId=i,this.events.emit(mi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const i=this.namespace.chains[0];if(!i)throw new Error("ChainId not found");return i.split(":")[1]}getAccounts(){const i=this.namespace.accounts;return i?[...new Set(i.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const i={};return this.namespace.chains.forEach(r=>{var s;i[r]=this.createHttpProvider(r,(s=this.namespace.rpcMap)==null?void 0:s[r])}),i}getHttpProvider(){const i=`${this.name}:${this.chainId}`,r=this.httpProviders[i];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${i} not found`);return r}setHttpProvider(i,r){const s=this.createHttpProvider(i,r);s&&(this.httpProviders[i]=s)}createHttpProvider(i,r){const s=r||Cr(i,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new _i(new $i(s,xt("disableProviderPing")))}}var Eb=Object.defineProperty,Ib=Object.defineProperties,xb=Object.getOwnPropertyDescriptors,fl=Object.getOwnPropertySymbols,Sb=Object.prototype.hasOwnProperty,Pb=Object.prototype.propertyIsEnumerable,pl=(h,i,r)=>i in h?Eb(h,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):h[i]=r,Js=(h,i)=>{for(var r in i||(i={}))Sb.call(i,r)&&pl(h,r,i[r]);if(fl)for(var r of fl(i))Pb.call(i,r)&&pl(h,r,i[r]);return h},Ko=(h,i)=>Ib(h,xb(i));class yc{constructor(i){this.events=new yr.exports,this.rpcProviders={},this.shouldAbortPairingAttempt=!1,this.maxPairingAttempts=10,this.disableProviderPing=!1,this.providerOpts=i,this.logger=typeof i?.logger<"u"&&typeof i?.logger!="string"?i.logger:De.pino(De.getDefaultLoggerOptions({level:i?.logger||ol})),this.disableProviderPing=i?.disableProviderPing||!1}static async init(i){const r=new yc(i);return await r.initialize(),r}async request(i,r){const[s,a]=this.validateChain(r);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(s).request({request:Js({},i),chainId:`${s}:${a}`,topic:this.session.topic})}sendAsync(i,r,s){this.request(i,s).then(a=>r(null,a)).catch(a=>r(a,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var i;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(i=this.session)==null?void 0:i.topic,reason:tr("USER_DISCONNECTED")}),await this.cleanup()}async connect(i){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(i),await this.cleanupPendingPairings(),!i.skipPairing)return await this.pair(i.pairingTopic)}on(i,r){this.events.on(i,r)}once(i,r){this.events.once(i,r)}removeListener(i,r){this.events.removeListener(i,r)}off(i,r){this.events.off(i,r)}get isWalletConnect(){return!0}async pair(i){this.shouldAbortPairingAttempt=!1;let r=0;do{if(this.shouldAbortPairingAttempt)throw new Error("Pairing aborted");if(r>=this.maxPairingAttempts)throw new Error("Max auto pairing attempts reached");const{uri:s,approval:a}=await this.client.connect({pairingTopic:i,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});s&&(this.uri=s,this.events.emit("display_uri",s)),await a().then(f=>{this.session=f}).catch(f=>{if(f.message!==Xl)throw f;r++})}while(!this.session);return this.onConnect(),this.session}setDefaultChain(i,r){try{const[s,a]=this.validateChain(i);this.getProvider(s).setDefaultChain(a,r)}catch(s){if(!/Please call connect/.test(s.message))throw s}}async cleanupPendingPairings(i={}){this.logger.info("Cleaning up inactive pairings...");const r=this.client.pairing.getAll();if(un(r)){for(const s of r)i.deletePairings?this.client.core.expirer.set(s.topic,0):await this.client.core.relayer.subscriber.unsubscribe(s.topic);this.logger.info(`Inactive pairings cleared: ${r.length}`)}}abortPairingAttempt(){this.shouldAbortPairingAttempt=!0}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces")||{},this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){const i=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[i]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await gc.init({logger:this.providerOpts.logger||ol,relayUrl:this.providerOpts.relayUrl||tb,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,name:this.providerOpts.name}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const i=[...new Set(Object.keys(this.session.namespaces).map(r=>Xs(r)))];ko("client",this.client),ko("events",this.events),ko("disableProviderPing",this.disableProviderPing),i.forEach(r=>{if(!this.session)return;const s=fb(r,this.session),a=lb(s),f=pb(this.namespaces,this.optionalNamespaces),w=Ko(Js({},f[r]),{accounts:s,chains:a});switch(r){case"eip155":this.rpcProviders[r]=new yb({namespace:w});break;case"solana":this.rpcProviders[r]=new vb({namespace:w});break;case"cosmos":this.rpcProviders[r]=new _b({namespace:w});break;case"polkadot":this.rpcProviders[r]=new gb({namespace:w});break;case"cip34":this.rpcProviders[r]=new mb({namespace:w});break;case"elrond":this.rpcProviders[r]=new wb({namespace:w});break;case"multiversx":this.rpcProviders[r]=new bb({namespace:w});break}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",i=>{this.events.emit("session_ping",i)}),this.client.on("session_event",i=>{const{params:r}=i,{event:s}=r;if(s.name==="accountsChanged"){const a=s.data;a&&un(a)&&this.events.emit("accountsChanged",a.map(db))}else s.name==="chainChanged"?this.onChainChanged(r.chainId):this.events.emit(s.name,s.data);this.events.emit("session_event",i)}),this.client.on("session_update",({topic:i,params:r})=>{var s;const{namespaces:a}=r,f=(s=this.client)==null?void 0:s.session.get(i);this.session=Ko(Js({},f),{namespaces:a}),this.onSessionUpdate(),this.events.emit("session_update",{topic:i,params:r})}),this.client.on("session_delete",async i=>{await this.cleanup(),this.events.emit("session_delete",i),this.events.emit("disconnect",Ko(Js({},tr("USER_DISCONNECTED")),{data:i.topic}))}),this.on(mi.DEFAULT_CHAIN_CHANGED,i=>{this.onChainChanged(i,!0)})}getProvider(i){if(!this.rpcProviders[i])throw new Error(`Provider not found: ${i}`);return this.rpcProviders[i]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(i=>{var r;this.getProvider(i).updateNamespace((r=this.session)==null?void 0:r.namespaces[i])})}setNamespaces(i){const{namespaces:r,optionalNamespaces:s,sessionProperties:a}=i;if(!r||!Object.keys(r).length)throw new Error("Namespaces must be not empty");this.namespaces=r,this.optionalNamespaces=s,this.sessionProperties=a,this.persist("namespaces",r),this.persist("optionalNamespaces",s)}validateChain(i){const[r,s]=i?.split(":")||["",""];if(r&&!Object.keys(this.namespaces).map(w=>Xs(w)).includes(r))throw new Error(`Namespace '${r}' is not configured. Please call connect() first with namespace config.`);if(r&&s)return[r,s];const a=Xs(Object.keys(this.namespaces)[0]),f=this.rpcProviders[a].getDefaultChain();return[a,f]}async requestAccounts(){const[i]=this.validateChain();return await this.getProvider(i).requestAccounts()}onChainChanged(i,r=!1){var s;const[a,f]=this.validateChain(i);r||this.getProvider(a).setDefaultChain(f),((s=this.namespaces[a])!=null?s:this.namespaces[`${a}:${f}`]).defaultChain=f,this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",f)}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,await this.cleanupPendingPairings({deletePairings:!0})}persist(i,r){this.client.core.storage.setItem(`${cl}/${i}`,r)}async getFromStore(i){return await this.client.core.storage.getItem(`${cl}/${i}`)}}const Ob=yc,Cb="wc",Ab="ethereum_provider",Tb=`${Cb}@2:${Ab}:`,Rb="https://rpc.walletconnect.com/v1/",ec=["eth_sendTransaction","personal_sign"],qb=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode"],tc=["chainChanged","accountsChanged"],Ub=["message","disconnect","connect"];var Nb=Object.defineProperty,Fb=Object.defineProperties,Db=Object.getOwnPropertyDescriptors,dl=Object.getOwnPropertySymbols,jb=Object.prototype.hasOwnProperty,$b=Object.prototype.propertyIsEnumerable,gl=(h,i,r)=>i in h?Nb(h,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):h[i]=r,Vo=(h,i)=>{for(var r in i||(i={}))jb.call(i,r)&&gl(h,r,i[r]);if(dl)for(var r of dl(i))$b.call(i,r)&&gl(h,r,i[r]);return h},yl=(h,i)=>Fb(h,Db(i));function rc(h){return Number(h[0].split(":")[1])}function Bo(h){return`0x${h.toString(16)}`}function Lb(h){const{chains:i,optionalChains:r,methods:s,optionalMethods:a,events:f,optionalEvents:w,rpcMap:E}=h;if(!un(i))throw new Error("Invalid chains");const x=i,N=s||ec,U=f||tc,X={[rc(x)]:E[rc(x)]},Q={chains:x,methods:N,events:U,rpcMap:X},ee=f?.filter(ge=>!tc.includes(ge)),V=s?.filter(ge=>!ec.includes(ge));if(!r&&!w&&!a&&!(ee!=null&&ee.length)&&!(V!=null&&V.length))return{required:Q};const Z=ee?.length&&V?.length||!r,oe={chains:[...new Set(Z?x.concat(r||[]):r)],methods:[...new Set(N.concat(a||[]))],events:[...new Set(U.concat(w||[]))],rpcMap:E};return{required:Q,optional:oe}}class vc{constructor(){this.events=new yr.exports.EventEmitter,this.namespace="eip155",this.accounts=[],this.chainId=1,this.STORAGE_KEY=Tb,this.on=(i,r)=>(this.events.on(i,r),this),this.once=(i,r)=>(this.events.once(i,r),this),this.removeListener=(i,r)=>(this.events.removeListener(i,r),this),this.off=(i,r)=>(this.events.off(i,r),this),this.parseAccount=i=>this.isCompatibleChainId(i)?this.parseAccountId(i).address:i,this.signer={},this.rpc={}}static async init(i){const r=new vc;return await r.initialize(i),r}async request(i){return await this.signer.request(i,this.formatChainId(this.chainId))}sendAsync(i,r){this.signer.sendAsync(i,r,this.formatChainId(this.chainId))}get connected(){return this.signer.client?this.signer.client.core.relayer.connected:!1}get connecting(){return this.signer.client?this.signer.client.core.relayer.connecting:!1}async enable(){return this.session||await this.connect(),await this.request({method:"eth_requestAccounts"})}async connect(i){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts(i);const{required:r,optional:s}=Lb(this.rpc);try{const a=await new Promise(async(w,E)=>{var x;this.rpc.showQrModal&&((x=this.modal)==null||x.subscribeModal(N=>{!N.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),E(new Error("Connection request reset. Please try again.")))})),await this.signer.connect(yl(Vo({namespaces:{[this.namespace]:r}},s&&{optionalNamespaces:{[this.namespace]:s}}),{pairingTopic:i?.pairingTopic})).then(N=>{w(N)}).catch(N=>{E(new Error(N.message))})});if(!a)return;this.setChainIds(this.rpc.chains);const f=v1(a.namespaces,[this.namespace]);this.setAccounts(f),this.events.emit("connect",{chainId:Bo(this.chainId)})}catch(a){throw this.signer.logger.error(a),a}finally{this.modal&&this.modal.closeModal()}}async disconnect(){this.session&&await this.signer.disconnect(),this.reset()}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",i=>{const{params:r}=i,{event:s}=r;s.name==="accountsChanged"?(this.accounts=this.parseAccounts(s.data),this.events.emit("accountsChanged",this.accounts)):s.name==="chainChanged"?this.setChainId(this.formatChainId(s.data)):this.events.emit(s.name,s.data),this.events.emit("session_event",i)}),this.signer.on("chainChanged",i=>{const r=parseInt(i);this.chainId=r,this.events.emit("chainChanged",Bo(this.chainId)),this.persist()}),this.signer.on("session_update",i=>{this.events.emit("session_update",i)}),this.signer.on("session_delete",i=>{this.reset(),this.events.emit("session_delete",i),this.events.emit("disconnect",yl(Vo({},tr("USER_DISCONNECTED")),{data:i.topic,name:"USER_DISCONNECTED"}))}),this.signer.on("display_uri",i=>{var r,s;this.rpc.showQrModal&&((r=this.modal)==null||r.closeModal(),(s=this.modal)==null||s.openModal({uri:i})),this.events.emit("display_uri",i)})}switchEthereumChain(i){this.request({method:"wallet_switchEthereumChain",params:[{chainId:i.toString(16)}]})}isCompatibleChainId(i){return typeof i=="string"?i.startsWith(`${this.namespace}:`):!1}formatChainId(i){return`${this.namespace}:${i}`}parseChainId(i){return Number(i.split(":")[1])}setChainIds(i){const r=i.filter(s=>this.isCompatibleChainId(s)).map(s=>this.parseChainId(s));r.length&&(this.chainId=r[0],this.events.emit("chainChanged",Bo(this.chainId)),this.persist())}setChainId(i){if(this.isCompatibleChainId(i)){const r=this.parseChainId(i);this.chainId=r,this.switchEthereumChain(r)}}parseAccountId(i){const[r,s,a]=i.split(":");return{chainId:`${r}:${s}`,address:a}}setAccounts(i){this.accounts=i.filter(r=>this.parseChainId(this.parseAccountId(r).chainId)===this.chainId).map(r=>this.parseAccountId(r).address),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(i){var r,s;return{chains:((r=i.chains)==null?void 0:r.map(a=>this.formatChainId(a)))||[`${this.namespace}:1`],optionalChains:i.optionalChains?i.optionalChains.map(a=>this.formatChainId(a)):void 0,methods:i?.methods||ec,events:i?.events||tc,optionalMethods:i?.optionalMethods||[],optionalEvents:i?.optionalEvents||[],rpcMap:i?.rpcMap||this.buildRpcMap(i.chains.concat(i.optionalChains||[]),i.projectId),showQrModal:!!(i!=null&&i.showQrModal),qrModalOptions:(s=i?.qrModalOptions)!=null?s:void 0,projectId:i.projectId,metadata:i.metadata}}buildRpcMap(i,r){const s={};return i.forEach(a=>{s[a]=this.getRpcUrl(a,r)}),s}async initialize(i){if(this.rpc=this.getRpcConfig(i),this.chainId=rc(this.rpc.chains),this.signer=await Ob.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:i.disableProviderPing,relayUrl:i.relayUrl,storageOptions:i.storageOptions}),this.registerEventListeners(),await this.loadPersistedSession(),this.rpc.showQrModal){let r;try{const{WalletConnectModal:s}=await _1(()=>import("./index.b52ad05e.js").then(a=>a.a),["assets/index.b52ad05e.js","assets/index.846ecf1a.js","assets/index.3a4bba73.css"]);r=s}catch{throw new Error("To use QR modal, please install @walletconnect/modal package")}if(r)try{this.modal=new r(Vo({walletConnectVersion:2,projectId:this.rpc.projectId,standaloneChains:this.rpc.chains},this.rpc.qrModalOptions))}catch(s){throw this.signer.logger.error(s),new Error("Could not generate WalletConnectModal Instance")}}}loadConnectOpts(i){if(!i)return;const{chains:r,optionalChains:s,rpcMap:a}=i;r&&un(r)&&(this.rpc.chains=r.map(f=>this.formatChainId(f)),r.forEach(f=>{this.rpc.rpcMap[f]=a?.[f]||this.getRpcUrl(f)})),s&&un(s)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=s?.map(f=>this.formatChainId(f)),s.forEach(f=>{this.rpc.rpcMap[f]=a?.[f]||this.getRpcUrl(f)}))}getRpcUrl(i,r){var s;return((s=this.rpc.rpcMap)==null?void 0:s[i])||`${Rb}?chainId=eip155:${i}&projectId=${r||this.rpc.projectId}`}async loadPersistedSession(){if(!this.session)return;const i=await this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`),r=this.session.namespaces[`${this.namespace}:${i}`]?this.session.namespaces[`${this.namespace}:${i}`]:this.session.namespaces[this.namespace];this.setChainIds(i?[this.formatChainId(i)]:r?.accounts),this.setAccounts(r?.accounts)}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(i){return typeof i=="string"||i instanceof String?[this.parseAccount(i)]:i.map(r=>this.parseAccount(r))}}const Hb=vc;export{Hb as EthereumProvider,Ub as OPTIONAL_EVENTS,qb as OPTIONAL_METHODS,tc as REQUIRED_EVENTS,ec as REQUIRED_METHODS,vc as default};
